<apex:component controller="AureusCalendarController" allowDML="true">
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <style>
            a[name="skiplink"] { 
            display:none;
            }
            .dv_load{
            top: 45%;
            margin-left: 40%;
            padding: 15px;
            z-index: 20000;
            position: fixed;
            width: 250px;
            background-color: #ccd8e7;
            border: 5px solid #afc3e0;
            color: #394057;
            }
            .selectBox{
            width: 100%;
            }
            .pointerForClick{
            cursor:pointer;
            }
            
            .button-shadow{
                box-shadow: 2px 2px 5px #888888;
            }
            .fc-state-default, .fc-state-hover{
            padding-left: 1rem !important;
            padding-right: 1rem !important;
            text-align: center !important;
            vertical-align: middle !important;
            border: 1px solid rgb(221, 219, 218) !important;
            transition: border .15s linear !important;
            background-color: rgba(255, 255, 255, 1.0) !important;
            border-color: rgb(177, 166, 166) !important;
            color: rgb(0, 0, 0) !important;
            background-image: none !important;
            text-transform: uppercase !important;
            }
            .fc-widget-header table thead tr{
            background: #F7F7F7;
            font-weight:800;
            }
            .fc-time, .fc-axis {
            text-transform: uppercase !important;
            font-size: 12px;
            font-weight: 800;
            background: whitesmoke;
            }
            .fc-event-container .fc-time , .fc-event-container .fc-title{
            font-size: 12px;
            font-weight: 600;
            background: transparent;
            }
            .fc-title{
            font-size: 12px !important;
            }
            
            .fc-toolbar{
            padding: 5px 1rem !important;
            margin: 0 !important;
            display: flex;      
            flex-wrap: wrap;        
            width: 100%;        
            justify-content: space-between;     
            align-items: center;        
            background:#e9e9e9;     
            }       
            div#statusOnPage {      
            left: 0;        
            top: 0;     
            }  
            .fc-scroller {
            height: auto !important;
            overflow: hidden !important;
            }     
            .fc-toolbar .fc-right {     
            order: 1;       
            }       
            .fc-toolbar .fc-clear {     
            display: none;      
            }       
            th.fc-resource-cell {       
            padding: 1px;      
            }       
            
            
            th.fc-day-header {      
            padding: 1px;  /*10px */    
            }       
             .fc-time-grid .fc-slats td {        
                height: 0.9rem;                   
            }
           
            .fc-widget-content{
             height: 1.3rem !important;
            }
            .fc-slats td.fc-widget-content:nth-child(2){
            border: 1px solid #2123261a;
            border-radius: 3px;
            opacity: 0.5;
            }
            /*.fc-time-grid .fc-slats, .fc-time-grid>hr {
            position: relative;
            z-index: 2;
            top: 43px;
            }*/
            .fc-scroller>.fc-day-grid, .fc-scroller>.fc-time-grid{
            top:42px;
            }
            
            .teacherWorkingHours{
            background: #fff;
            border: 1px solid #fff;
            opacity: 1;
            }
            
            .bookingNotAvailable{               
            background: rgb(215, 162, 162)  !important;
            opacity: 1 !important;
            pointer-events: none;
            bottom: auto !important;
            color: #b95f5f !important;
            border: 1px solid #b95f5f !important;
            left: -2px !important;
            width: 100%;
            }
            .fc-event {
            
            display: block;
            align-items: center;
            justify-content: center;
            padding: 10px;
            /*left: -2px !important;
            width: 100%;*/
            }
            .slds-scope .slds-page-header{
            padding: 5px;
            }
            .slds-page-header {
            border-radius: 0 !important;
            }
            .fc-event-container{
            width: 100%;
            }
            .fc-state-active{
            background: rgb(221, 219, 218) !important;
            }
            .fc-button-group, .fc-toolbar button{
            font-size: 14px !important;
            text-transform: capitalize !important;
            height: 2.4em !important;
            }
            .fc-resource-cell{
            word-wrap: break-word;
            padding: 3px;
            }
            .fc-widget-header thead .fc-resource-cell, .fc-widget-header thead .fc-day-header{
            text-align: center !important;
            }
            .eventHistory{
            border-top: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
            padding: 15px 5px;
            }
            #eventIcons{
            position: absolute;
            top: 3px;
            right: 0px;
            }
            .closeon a{
            color: #5a5959;
            }
            #retweet svg{
            transform: rotate(90deg);
            }
            .historyBy{
            color: #afa5a5;
            font-size: 16px;
            vertical-align: text-top;
            }
            #calendar{
            background: #fff;
            }
            .slds-scope a.slds-tabs--default__link {
            color: rgb(0, 109, 204) !important;
            text-decoration: none !important;
            transition: color .1s linear;
            }
            .slds-tabs--default__item.slds-is-active{
            font-weight: unset !important;
            }
            .headerTitle{
            font-size: .8125rem !important;
            font-weight: unset !important;
            }
            #ToastMessage{
            position: absolute !important;
            }
            .slds-scope .slds-is-relative{
            position: fixed !important;
            }
            .slds-button-group{
            width: 100%;
            }
            .slds-button-group .slds-button{
            width: 40%;
            }
            .btnWidth{
            width: 54% !important;
            }
            .btnBlue{
            background: #00b3f0 !important;
            border-color: #0fa6da !important;
            }
            .customTable th{
            text-align: right;
            font-weight: bold !important;
            }
            .editCustomer{
            position: absolute;
            top: 0px;
            right: 0;
            }
            .recurrence .slds-select, .recurrence .slds-input{
            width: unset !important;
            }
            .editCustomerDetails{
            z-index: 9999;
            position: absolute;
            top: 9%;
            right: 0px;
            }
            .editCustomerDetails section{
            padding: 15px;
            }
            #popoverTitle{
            font-size: 15px;
            font-weight: 600;
            }
            .customInput{
            width: 97% !important;
            margin-left: 4px !important;
            }
            .customPadding{
            padding-left: 0px !important; 
            padding-right: 0px !important;
            }
            .customHeader{
            background: #F8B52F;
            color: white;
            height: 50px;
            padding: 15px;
            }
            .slds-scope .slds-radio_button [type=radio]:checked+.slds-radio_faux, .slds-scope .slds-radio_button [type=radio]:checked+.slds-radio--faux, .slds-scope .slds-radio_button [type=radio]:checked~.slds-radio_faux, .slds-scope .slds-radio_button [type=radio]:checked~.slds-radio--faux, .slds-scope .slds-radio_button [type=radio]:checked+.slds-radio_button__label, .slds-scope .slds-radio_button [type=radio]:checked+.slds-radio--button__label, .slds-scope .slds-radio--button [type=radio]:checked+.slds-radio_faux, .slds-scope .slds-radio--button [type=radio]:checked+.slds-radio--faux, .slds-scope .slds-radio--button [type=radio]:checked~.slds-radio_faux, .slds-scope .slds-radio--button [type=radio]:checked~.slds-radio--faux, .slds-scope .slds-radio--button [type=radio]:checked+.slds-radio_button__label, .slds-scope .slds-radio--button [type=radio]:checked+.slds-radio--button__label{
            background-color: #e6e6e6 !important;
            color: #000 !important;
            }
            #services{
            width: 100px;
            }
            .bookingStatus{
            width: 30% !important;
            }
            .slds-template__container {
            background: #f9b758 !important;
            }
            body{
            background: #f9b758 !important;
            }
            .close-btn {
            position: absolute !important;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            }
            .pop-header {
            position: relative;
            }
            a.editCustomer {
            background: #333;
            color: #fff !important;
            display: inline-block;
            padding: 10px 10px;
            top: 4px;
            text-decoration:none; 
            }
            .popupDetails .pop-header span,.popupDetails .pop-header a,.popupDetails .pop-header svg {
            color: #fff !important;
            }  
            td.fc-widget-content:not(:nth-child(1)) {
            background: #858585;
            opacity: 0.5;
            }
            .custBtn{
            width: 130px;
            background: #f9f3f3 !important;
            color: #000 !important;
            font-weight: bold !important;
            }
            .custmBTN{
            width: 200px;
            background: #f9f3f3 !important;
            color: #000 !important;
            }
            .studentImg{
            width: 200px !important;
            height: 200px !important;
            }
            .fc-ltr .fc-axis{
            font-weight: 500;
            }
            .black{
            border-top: 2px solid #21232645 !important;
            }
            .slds-scope{
            overflow: hidden;
            }
            .fc-header-toolbar{
                position: fixed;
                z-index: 100;
                top: 68px;
            }
            @media only screen and (min-device-width: 720px) and (max-device-width: 1300px) {
                .fc-header-toolbar{
                    position: fixed;
                    z-index: 100;
                    top: 56px;
                }
            }
            .fc-head-container{
            position: -webkit-sticky;
            position: sticky;
            z-index: 999;
            top: 43px;
            }
            #calendar{
            height: calc(100vh - 13vh);
            overflow-y:auto;
            }
            
            td.fc-widget-content:not(:nth-child(1)) {
                background: #fff;
                //opacity: 0.5;
            }
            .fc-nonbusiness {
                    background: #858585 !important;
                    opacity: 0.5;
            }
            .fc-center{
                margin-left: -204px;
                font-size: large;
                font-weight: 600;
            }
            .editBookingDetailBody{
                height: 140px;
                overflow-y: auto;
                overflow-x: hidden;
            }
           .hyphens-none-fix{
                    hyphens:none !important;
           }
            
        </style>
        <apex:form >
            <apex:actionStatus id="status" styleClass="status">
                <apex:facet name="start">
                    <div class="demo-only demo--inverse " style="height:100%;width:100%;z-index:200;position:fixed">
                        <div class="slds-spinner_container" style="height:100%;width:100%;">
                            <div role="status" class="slds-spinner slds-spinner_large slds-spinner_brand">
                                <span class="slds-assistive-text">Loading</span>
                                <div class="slds-spinner__dot-a"></div>
                                <div class="slds-spinner__dot-b"></div>
                            </div>
                        </div>
                    </div>
                </apex:facet>
            </apex:actionStatus>
            <apex:actionFunction name="centerName" reRender="teachersName,resourceName" action="{!getTeacherByCenter}" status="status" oncomplete="initChange();teacherChange();"/>
                
            <div class="slds-scope slds-calender-page">
                <!-- Toast -->
                <div class="demo-only slds-hide" style="height: 4rem;" id='ToastMessage'>
                    <div class="slds-notify_container slds-is-relative">
                        <div class="slds-notify slds-notify_toast slds-theme_success toastclass" role="alert">
                            <span class="slds-assistive-text">success</span>
                            <span class="slds-icon_container slds-icon-utility-success slds-m-right_small slds-no-flex slds-align-top" title="Description of icon when needed">
                                <svg class="slds-icon slds-icon_small" aria-hidden="true">
                                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#success')}" />
                                </svg>
                            </span>
                            <div class="slds-notify__content">
                                <h2 class="slds-text-heading_small" id="toastMsg"></h2>
                            </div>
                            <button class="slds-button slds-button_icon slds-notify__close slds-button_icon-inverse" title="Close" onclick='toastLaunch()'>
                                <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#close')}" />
                                </svg>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Toast -->
                
                <!-- loader start -->
                <div id="statusOnPage" class="demo-only demo--inverse" style="display:none;height:100%;width:100%;z-index:200;position:fixed">
                    <div class="slds-spinner_container" style="height:100%;width:100%;">
                        <div role="status" class="slds-spinner slds-spinner_large slds-spinner_brand">
                            <span class="slds-assistive-text">Loading</span>
                            <div class="slds-spinner__dot-a"></div>
                            <div class="slds-spinner__dot-b"></div>
                        </div>
                    </div>
                </div>
                <!-- loader end -->
                <apex:outputPanel id="op"></apex:outputPanel>
                <div class="slds-page-header">
                    <div class="slds-page-header__row">
                        <div class="slds-page-header__col-title">
                            <div class="slds-media">
                                <div class="slds-media__body">
                                    <div class="slds-grid slds-gutters">
                                        <div class="slds-col slds-size_2-of-12">
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">Center</label>
                                                <div class="slds-form-element__control">
                                                    <apex:selectList value="{!centerName}" id="centers"  size="1" onchange="centerName();getCenter($(this).val());return false;" styleClass="slds-select selectBox centerList">
                                                        <apex:selectOptions value="{!Centers}"/>
                                                    </apex:selectList>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col slds-size_2-of-12">
                                            <div class="slds-form-element">
                                                <apex:outputPanel id="teachersName">
                                                <apex:pageMessages ></apex:pageMessages>
                                                    <label class="slds-form-element__label">Teacher</label>
                                                    <div class="slds-form-element__control">
                                                        <apex:selectList value="{!teacherName}" size="1" id="teachers" styleClass="slds-select selectBox teachers">
                                                            <apex:selectOptions value="{!Teachers}"/>
                                                        </apex:selectList>
                                                    </div>
                                                </apex:outputPanel>
                                            </div>
                                        </div>
                                        <div class="slds-col slds-size_2-of-12">
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">Instrument</label>
                                                <div class="slds-form-element__control">
                                                    <select id="instruments" size="1" class="slds-select selectBox instrument" onchange="getInstrument($(this).val());return false;">
                                                    </select>                              
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col slds-size_2-of-12">
                                            <div class="slds-form-element">
                                                <apex:outputPanel id="resourceName">
                                                    <label class="slds-form-element__label">Resources</label>
                                                    <div class="slds-form-element__control">
                                                        <apex:selectList value="{!resourceId}" id="resources" size="1" styleClass="slds-select selectBox" onchange="getResource($(this).val());return false;">
                                                            <apex:selectOptions value="{!Resources}"/>
                                                        </apex:selectList>
                                                    </div>
                                                </apex:outputPanel>    
                                                
                                            </div> 
                                        </div>
                                        <div class="slds-col slds-size_4-of-12" style="padding-top: 24px;">
                                            <div class="slds-grid slds-gutters">
                                              <div class="slds-col slds-size_1-of-2">
                                                <button class="slds-button slds-button_neutral"  title="Refresh" onclick="refreshCalendar();return false;">
                                                  <svg class="slds-button__icon slds-icon_x-small" aria-hidden="true">
                                                    <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/action-sprite/svg/symbols.svg#refresh')}"></use>
                                                  </svg>
                                                </button> 
                                            </div>
                                              <div class="slds-col slds-size_1-of-2">
                                                <!--<button class="slds-button slds-button_neutral"  title="Show/Hide Menu" onclick="showHideMenu();return false;">
                                                  <svg class="slds-button__icon slds-icon_x-small" aria-hidden="true">
                                                    <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/action-sprite/svg/symbols.svg#refresh')}"></use>
                                                  </svg>
                                                  Show/Hide Menu
                                                </button>-->
                                              </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="calendar"></div>
                
                <!-- booking detail popup end--> 
                <div class="editDetails slds-hide">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                        <div class="slds-modal__container" style="width: 65%;">
                            <div class="slds-modal__content" id="modal-content-id-1" style="min-height: 385px; max-height: 440px;overflow-y: hidden; ">
                                <div class="slds-grid slds-wrap customHeader" style="background: #303a42;">
                                    <div class="slds-col slds-size_10-of-12">
                                        <h1>
                                            <span class="slds-page-header__title slds-truncate" id="detailPopupTitle">
                                                Edit Appointment
                                            </span>
                                        </h1>
                                    </div>
                                    <div class="slds-col slds-size_2-of-12 slds-text-align_right">
                                        <a  class="slds-button slds-button_icon" id="closeRescheduleIconButton" title="Close" style="color: white;" href="javascript:void(0);" onclick="cancelRescheduling();return false;">
                                            <svg class="slds-button__icon slds-icon_x-small" aria-hidden="true">
                                                <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/action-sprite/svg/symbols.svg#close')}"></use>
                                            </svg>
                                            <span class="slds-assistive-text">Close</span>
                                        </a>
                                    </div>
                                    
                                </div>
                                <div class="slds-m-around--large" style="margin-bottom: 0px" role="group">
                                    <div class="slds-tabs--default">
                                        <div style="float:right;">
                                            <label><b>Status: </b></label>
                                            <label id="statusLabelOnEdit"></label>
                                            <span id="statusIconOnEdit"></span>
                                        </div>
                                        
                                        <ul class="slds-tabs--default__nav customTabs" role="tablist">
                                            
                                            <li class="slds-tabs--default__item slds-text-heading--label slds-active" title="Details" role="presentation">
                                                <a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" tabindex="0" aria-selected="true" aria-controls="tab-default-1" id="tab-default-1__item">
                                                    Details
                                                </a>
                                            </li>
                                            <li class="slds-tabs--default__item slds-text-heading--label" title="Notes" role="presentation">
                                                <a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="true" aria-controls="tab-default-2" id="tab-default-2__item">                                                    
                                                    Notes
                                                </a>
                                            </li>
                                            <li class="slds-tabs--default__item slds-text-heading--label" title="History" role="presentation">
                                                <a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="true" aria-controls="tab-default-3" id="tab-default-3__item">
                                                    History
                                                </a>
                                            </li>
                                            <li class="slds-tabs--default__item slds-text-heading--label slds-hide" title="Advance Actions" role="presentation" id="advanceDetailsSection">
                                                <a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="true" aria-controls="tab-default-4" id="tab-defaul-4__item">
                                                    Adv. Actions
                                                </a>
                                            </li>
                                            <!--<li class="slds-tabs--default__item slds-text-heading--label slds-hide" title="Enrolment" role="presentation" id="enrolmentDetailSection">
                                                <a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="true" aria-controls="tab-default-5" id="tab-defaul-5__item">
                                                    Enrolment
                                                </a>
                                            </li> -->
                                        </ul>
                                        <div id="tab-default-1" class="slds-tabs--default__content slds-show" role="tabpanel" aria-labelledby="tab-default-1__item">
                                            <div class="slds-grid slds-wrap slds-p-around_xx-small">
                                                
                                                <div class="slds-col slds-size_1-of-1">
                                                <div class="editBookingDetailBody">
                                                    <div class="slds-grid slds-gutters">
                                                        <div class="slds-col slds-size_5-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Location:</b></span>
                                                            <span id="centerName"></span>
                                                            <!--<span><a id="centerName" href="" target="_blank"></a></span>-->
                                                        </div>
                                                        <div class="slds-col slds-size_7-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Student:</b></span>
                                                            <span id="name1"></span>
                                                            <!--<span><a id="name1" target="_blank" href="#"></a></span>-->
                                                        </div>
                                                    </div>
                                                    <div class="slds-grid slds-gutters">
                                                        <div class="slds-col slds-size_5-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Teacher Name:</b></span>
                                                            <span id="teacherNameEditPopup"></span>
                                                            <!--<span><a id="teacherNameEditPopup" target="_blank" href="#"></a></span>-->
                                                        </div>
                                                        
                                                        <div class="slds-col slds-size_7-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Parent:</b></span>
                                                            <span id="parentname1"></span>
                                                            <!--<span><a id="parentname1" target="_blank" href="#"></a></span>-->
                                                        </div>
                                                        
                                                    </div>
                                                    <div class="slds-grid slds-gutters">
                                                        <div class="slds-col slds-size_5-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Date:</b></span>
                                                            <span id="date"></span>
                                                           
                                                        </div>
                                                        
                                                        <div class="slds-col slds-size_7-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Phone:</b></span>
                                                            <!--<span id="phone"> </span>-->
                                                        </div>
                                                    </div>
                                                    <div class="slds-grid slds-gutters">
                                                        <div class="slds-col slds-size_5-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Time:</b></span>
                                                            <span id="serviceTime"></span>
                                                           
                                                        </div>
                                                        
                                                        <div class="slds-col slds-size_7-of-12" style="margin-right: 0px;padding-right: 0PX;">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Email:</b></span>
                                                            <!--<span id="email"></span>-->
                                                        </div>
                                                    </div>
                                                    <div class="slds-grid slds-gutters">
                                                        <div class="slds-col slds-size_5-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Package:</b></span>
                                                            <span id="servicePackagName"></span>
                                                        </div>
                                                        <div class="slds-col slds-size_7-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Duration:</b></span>
                                                            <span id="serviceDuration"></span>
                                                        </div>
                                                        
                                                    </div>
                                                 </div>
                                                    <hr style="margin-bottom: 0px;" id="hr-editAppointment"/>
                                                    <div class="slds-grid slds-gutters slds-m-top_large" >
                                                        <div class="slds-col slds-size_5-of-12" id="button_Group_reschedule" style="padding-left:0px;padding-right:0px;">
                                                            <div class="slds-button-group" role="group" >
                                                                <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" title="No-show" aria-pressed="false" id="noShowBooking">No-show
                                                                <svg class="slds-button__icon" aria-hidden="true">
                                                                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}" />
                                                                </svg>
                                                                <span class="slds-assistive-text">No-show</span>
                                                              </button>
                                                               <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" title="Completed" aria-pressed="false" id="completeBooking">Completed
                                                                <svg class="slds-button__icon" aria-hidden="true">
                                                                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                </svg>
                                                                <span class="slds-assistive-text">Complete</span>
                                                              </button>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="slds-col slds-size_5-of-12" style="padding-left:0px;padding-right:0px;">
                                                            <div class="slds-button-group" role="group">
                                                               <!-- <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" title="Cancel" aria-pressed="false" id="cancelBooking">Cancel
                                                                <svg class="slds-button__icon" aria-hidden="true">
                                                                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#clear')}" />
                                                                </svg>
                                                                <span class="slds-assistive-text">Cancelled</span>
                                                              </button>
                                                              <button class="slds-button slds-button_icon slds-button_icon-border-filled editBooking button-shadow" title="Reschedule" aria-pressed="false">Reschedule
                                                                <svg class="slds-button__icon" aria-hidden="true">
                                                                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#edit')}" />
                                                                </svg>
                                                                <span class="slds-assistive-text">Reschedule</span>
                                                              </button>-->
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_2-of-12" id="button_Group_EditDetails" style="padding-left:0px;padding-right:0px;">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="tab-default-2" class="slds-tabs--default__content slds-hide" role="tabpanel" aria-labelledby="tab-default-2__item">
                                            <div class="slds-col slds-size_1-of-1">
                                                <div>
                                                    <a href="javascript:void(0);" class="slds-button slds-button_brand" id="newBookingNote">
                                                        <svg class="slds-button__icon slds-icon_x-small" aria-hidden="true">
                                                            <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#add')}"></use>
                                                        </svg>
                                                        Add New Booking Note
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="slds-grid"> 
                                                <div class="slds-col slds-size_3-of-3 slds-m-top_small slds-wrap slds-scrollable_x" style="height: 200px;overflow-y: auto;">
                                                    <h1>
                                                        <span class="slds-page-header__title slds-truncate">
                                                            Booking Notes:
                                                        </span>
                                                    </h1>
                                                    <table class="slds-table slds-no-row-hover slds-table_bordered slds-wrap slds-scrollable_x">
                                                        <thead>
                                                            <tr class="slds-line-height_reset">
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate">Title</div>
                                                                </th>
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate">Body</div>
                                                                </th>
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate">Date-Time</div>
                                                                </th>
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate">Created By</div>
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="bookingNotesTBody"></tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="tab-default-3" class="slds-tabs--default__content slds-hide" role="tabpanel" aria-labelledby="tab-default-3__item" style="max-height: 300px;overflow-y: auto;">
                                            <p id="bookingHistory" class="slds-m-top_small"></p>
                                        </div>
                                        
                                        <div id="tab-default-5" class="slds-tabs--default__content" role="tabpanel" aria-labelledby="tab-default-5__item" style="max-height: 300px;overflow-y: auto;">
                                            <div class="slds-col slds-size_1-of-1 slds-p-around_small slds-align_absolute-center">
                                                <span>
                                                    <button class="slds-button slds-button_neutral" style="width:350px" id="sendTrialEnrollmentLink" onclick="sendTrialEnrollment($(this).attr('data-id'));return false;">
                                                        Send Enrolment Link
                                                    </button>
                                                </span>
                                            </div>
                                            <div class="slds-col slds-size_1-of-1 slds-p-around_small slds-align_absolute-center">
                                                <span>
                                                    <a class="slds-button slds-button_neutral" style="width:350px;pointer-events:none;" disabled="true" id="completeTrialEnrollmentLink" onclick="$('#trialBookingClickModal').addClass('slds-hide');">
                                                        Complete Enrolment and Send Payment Link
                                                    </a>
                                                </span>
                                            </div>
                                        </div>
                                        <!-- tab 4 start -->
                                        <div id="tab-default-4" class="slds-tabs--default__content slds-hide" role="tabpanel" aria-labelledby="tab-default-4__item">
                                            <div class="slds-form-element__control">
                                                     <div class="slds-grid slds-gutters">
                                                        <div class="slds-col slds-size_5-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Package Process Type:</b></span>
                                                            <span id="processTypeEdit"></span>
                                                        </div>
                                                        <div class="slds-col slds-size_7-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>New Package(If any):</b></span>
                                                            <span><a id="newPackageEdit" target="_blank" href="#"></a></span>
                                                        </div>
                                                    </div>                                                        
                                                    <div class="slds-grid slds-gutters">
                                                        <div class="slds-col slds-size_5-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Request Date:</b></span>
                                                            <span id="requestDateEdit"></span>
                                                        </div>
                                                        <div class="slds-col slds-size_7-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Effective Date:</b></span>
                                                            <span id="effectiveDateEdit"></span>
                                                        </div>
                                                    </div>
                                                    <div class="slds-grid slds-gutters">
                                                        <div class="slds-col slds-size_5-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Notice Period Start:</b></span>
                                                            <span id="noticeStartEdit"></span>
                                                        </div>
                                                        <div class="slds-col slds-size_7-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Notice Period End:</b></span>
                                                            <span id="noticeEndEdit"></span>
                                                        </div>
                                                    </div>
                                                    <div class="slds-grid slds-gutters">
                                                        <div class="slds-col slds-size_5-of-12">
                                                            <span class="slds-form-element__label slds-text-align_right"><b>Created By:</b></span>
                                                            <span id="advanceActionRequestedBy"></span>
                                                        </div>
                                                        <div class="slds-col slds-size_7-of-12">
                                                        </div>
                                                    </div>
                                                  </div>
                                            </div>
                                        </div>
                                        <!-- tab 4 ends && tab 5 starts -->
                                        
                                        <!-- tab 5 ends-->
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                
                
                <div class="editCustomerDetails slds-hide">
                    <section aria-describedby="dialog-body-id-3" aria-labelledby="dialog-heading-id-3"  role="dialog">
                        <button class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close" title="Close dialog" onclick="$('.editCustomerDetails').addClass('slds-hide'); return false;">
                            <svg class="slds-button__icon" aria-hidden="true">
                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#close" />
                            </svg>
                            <span class="slds-assistive-text">Close dialog</span>
                        </button>
                        <header class="slds-popover__header" style="background: #F8B52F; color: #fff">
                            <h2 class="slds-text-heading_small"><b>Editing</b> <span id="popoverTitle"></span></h2>
                        </header>
                        <div class="slds-popover__body slds-form-element slds-form-element_compound" id="dialog-body-id-3">
                            <div class="slds-form-element__control">
                                <div class="slds-form-element__row">
                                    <div class="slds-size_1-of-2">
                                        <div class="slds-form-element customPadding">
                                            <div class="slds-form-element__control">
                                                <input type="text" id="fname" class="slds-input" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-size_1-of-2">
                                        <div class="slds-form-element">
                                            <div class="slds-form-element__control">
                                                <input type="text" id="lname" class="slds-input" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form-element__row slds-m-top_large">
                                    <div class="slds-size_1-of-2">
                                        <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left">
                                            <svg class="slds-icon slds-input__icon slds-input__icon_left slds-icon-text-default" aria-hidden="true">
                                                <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#call"></use>
                                            </svg>
                                            <input id="telephone" class="slds-input" type="text" value="" />
                                        </div>
                                    </div>
                                    <div class="slds-size_1-of-2">
                                        <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left">
                                            <svg class="slds-icon slds-input__icon slds-input__icon_left slds-icon-text-default" aria-hidden="true">
                                                <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#search"></use>
                                            </svg>
                                            <input id="parentsms" class="slds-input customInput" type="text" value="" />
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form-element__row slds-m-top_large">
                                    <div class="slds-size_1-of-1">
                                        <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left">
                                            <svg class="slds-icon slds-input__icon slds-input__icon_left slds-icon-text-default" aria-hidden="true">
                                                <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#email"></use>
                                            </svg>
                                            <input id="parentEmail" class="slds-input" type="text" value="" />
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form-element__row slds-m-top_large">
                                    <div class="slds-form-element__row">
                                        <div class="slds-size_1-of-2">
                                            <div class="slds-form-element customPadding">
                                                <div class="slds-form-element__control">
                                                    <input type="text" id="parentfname" class="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-size_1-of-2">
                                            <div class="slds-form-element">
                                                <div class="slds-form-element__control">
                                                    <input type="text" id="parentlname" class="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form-element__row slds-m-top_large">
                                    <div class="slds-size_1-of-1">
                                        <div class="slds-form-element__control">
                                            <select class="slds-select">
                                                <option>New Customer</option>
                                                <option>Returning Customer</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <!--<div class="slds-form-element__row slds-m-top_large">
<div class="slds-size_1-of-1">
<p><a href="javascript:void(0);">Select or add another customer instead</a></p>
</div>
</div>-->
                                <div class="slds-form-element__row slds-m-top_large">
                                    <div class="slds-size_1-of-2">
                                        <div class="slds-form-element__control">
                                            <a class="slds-button slds-button_neutral" style="width: 97%; margin-right: 10px" href="javascript:void(0);" onclick="$('.editCustomerDetails').addClass('slds-hide'); return false;">Cancel</a>
                                        </div>
                                    </div>
                                    <div class="slds-size_1-of-2">
                                        <div class="slds-form-element__control">
                                            <a class="slds-button slds-button_brand" style="width: 97%; margin-left: 10px" href="javascript:void(0);" onclick="updateCustomer();return false;">Update</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                
                <div class="cancellationReasonPopup slds-hide">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                        <div class="slds-modal__container" style="width: 35%;">
                            <div class="slds-modal__content" id="modal-content-id-1">
                                <div style="background:#303a42;  color:white;">
                                    <div class="slds-grid slds-wrap">
                                        <div class="slds-col slds-size_11-of-12 slds-large-size_11-of-12">
                                            <h2 id="reasonPopupText" class="slds-text-heading_medium slds-hyphenate slds-p-around_medium">Cancel appointment</h2>
                                        </div>
                                        <div class="slds-col slds-size_1-of-12 slds-large-size_1-of-12 slds-p-top_medium">
                                            <span class="pointerForClick" onclick="$('.cancellationReasonPopup').addClass('slds-hide'); return false;">
                                                <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                    <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#close"></use>
                                                </svg>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="popupBody">
                                    <div class="slds-p-around_small notMakeupHoursShow">
                                        <b>The following services will be cancelled:</b>
                                        <ul style="padding-left:25px;list-style:disc">
                                            <li><span id="lessonOnCancel"></span> with <span id="teacherOnCancel"></span> on <span id="dateAndTimeOnCancel"></span></li>
                                        </ul>
                                    </div>
                                    <div class="slds-p-around_small slds-hide makeupTitle">
                                        <b>You are cancelling this event within 24 hours. Do you want to give make up credit for this booking:</b>
                                        <div class="slds-p-around_small">
                                            <button class="slds-button slds-button_neutral" id="no-makeup"> 
                                                <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                    <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#close"></use>
                                                </svg>
                                                No
                                            </button>
                                            <button class="slds-button slds-button_brand" id="yes-makeup"> 
                                                <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                    <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#check"></use>
                                                </svg>
                                                Yes
                                            </button>
                                        </div>
                                    </div>
                                    <div class="slds-p-around_small reasonSection">
                                        <b class="reasonText">Reason for Cancellation</b>
                                        <select class="slds-select" id="cancelReason" onchange="showMessageForCancellation();return false;">
                                            
                                        </select>
                                        <p id="errorMsgReason" style="color:red;"></p>
                                    </div>
                                    <!--<div class="slds-p-around_small">
<a href="javascript:void(0);">Add cancellation reasons >></a>
</div>-->
                                    <div class="slds-p-around_small slds-hide makeupCredit">
                                        <b>Remark for Make-up credit</b>
                                        <textarea id="remarkForCancellation" placeholder="Please Enter Reason for Make-up Credit" class="slds-textarea"></textarea>
                                        <p id="errorMsgRemark" style="color:red;"></p>
                                    </div>
                                    
                          
                                </div>
                            </div>
                            <footer class="slds-modal__footer">
                                <button class="slds-button slds-button_neutral close-popup" onclick="$('.cancellationReasonPopup').addClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                        <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#close"></use>
                                    </svg>
                                    Close
                                </button>
                                
                                <button class="slds-button slds-button_neutral slds-button_destructive" href="javascript:void(0);" id="cancelBookingWithReason">
                                    <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                        <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#delete"></use>
                                    </svg>
                                    Cancel Appointment
                                </button>
                                <button class="slds-button slds-button_neutral slds-hide" href="javascript:void(0);" id="cancelBookingWithMakeupBtn">
                                    Give Makeup Credit Hours
                                </button>
                            </footer>
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                <div class="confirmModal slds-hide" id="confirmModal">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                        <div class="slds-modal__container" style="width: 35%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="confirmHeader" class="slds-text-heading_medium slds-hyphenate"></h2>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="confirmBody"></div>
                            <footer class="slds-modal__footer">
                                <button class="slds-button slds-button_brand yesClass" id="confirmModalYes">Yes</button>
                                <button class="slds-button slds-button_neutral revert" id="confirmModalNo" onclick="$('.confirmModal').addClass('slds-hide'); return false;">No</button>
                            </footer>
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
               
                <!--New Booking Click Modal-->
                <div class="slds-hide" id="newBookingModal">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                        <div class="slds-modal__container" style="width: 30%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="newBookingHeader" class="slds-text-heading_medium slds-hyphenate"></h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#newBookingModal').addClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="newBookingBody">
                                <div class="slds-grid slds-wrap">
                                    <div class="slds-col slds-size_1-of-1 slds-align_absolute-center">
                                        <span>
                                            <button class="slds-button slds-button_neutral" style="width:250px" id="addNewBooking" onclick="newAppointmentPopup($(this).attr('data-centerid'), $(this).attr('data-teacherid'), $(this).attr('data-date'));return false;">
                                                <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                    <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#event')}"></use>
                                                </svg>Add Appointment
                                            </button>
                                        </span>
                                    </div>
                                    <div class="slds-col slds-size_1-of-1 slds-align_absolute-center">
                                        <span>
                                            <button class="slds-button slds-button_neutral" style="width:250px" id="addBusyTime" onclick="addBusyTimeFunc();return false;">
                                                <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                    <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#error')}"></use>
                                                </svg>Add busy time
                                            </button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                
                <!--Trial Booking Click Modal-->
                <div class="slds-hide" id="trialBookingClickModal">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                        <div class="slds-modal__container" style="width: 35%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="trialBookingClickModalHeader" class="slds-text-heading_medium slds-hyphenate">Trial Booking</h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#trialBookingClickModal').addClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="trialBookingClickModalBody">
                                <div class="slds-grid slds-wrap">
                                    <div class="slds-col slds-size_1-of-1 slds-align_absolute-center">
                                        <span>
                                            <!--<button class="slds-button slds-button_neutral" style="width:350px" id="rescheduleTrialBooking" onclick="rescheduleTrialBookingfunc($(this).attr('data-id'), $(this).attr('data-date'));return false;">
                                                Reschedule Trial Appointment
                                            </button>-->
                                        </span>
                                    </div>
                                    <div class="slds-col slds-size_1-of-1 slds-align_absolute-center">
                                        <span>
                                            <button class="slds-button slds-button_neutral" style="width:350px" id="sendTrialEnrollmentLink" onclick="sendTrialEnrollment($(this).attr('data-id'));return false;">
                                                Send Enrolment Link
                                            </button>
                                        </span>
                                    </div>
                                    <div class="slds-col slds-size_1-of-1 slds-align_absolute-center">
                                        <span>
<!-- <a class="slds-button slds-button_neutral" style="width:350px;pointer-events:none;" id="completeTrialEnrollmentLink" disabled="true" onclick="$('#trialBookingClickModal').addClass('slds-hide');">
                                                Complete Enrolment and Send Payment Link!
                                            </a> -->
                                            <button class="slds-button slds-button_neutral" style="width:350px;pointer-events:none;" id="completeTrialEnrollmentLink" disabled="true" onclick="$('#trialBookingClickModal').addClass('slds-hide');">
                                                Complete Enrolment and Send Payment Link!
                                            </button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                <!--New Booking Note popup-->
                <div class="addNotes slds-hide" style="height: 640px;">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_small">
                        <div class="slds-modal__container" style="width: 50%;">
                            <header class="slds-modal__header" style="background: #303a42;">
                                <a href="javascript:void(0);" class="slds-button slds-button_icon close-btn" title="Close" onclick="$('.addNotes').addClass('slds-hide'); return false;" style="color:#fff;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                                <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate" style="text-align: left; color: #fff; font-weight: 600;">Add New Booking Note</h2>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                <div id="addBookingNoteSection">
                                    <div class="slds-box slds-m-top_small">
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__label">Title</label>
                                            <div class="slds-form-element__control">
                                                <input type="text" id="title" class="slds-input" required="true" />
                                            </div>
                                        </div>
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__label">Body</label>
                                            <div class="slds-form-element__control">
                                                <textarea id="note" class="slds-textarea"></textarea>
                                            </div>
                                        </div>
                                        <div class="slds-form-element slds-text-align_right slds-m-top_small">
                                            <a href="javascript:void(0);" class="slds-button slds-button_brand" id="saveBookingNote" onclick="saveBookingNote(); return false;">
                                                Save
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--<footer class="slds-modal__footer">
<a href="javascript:void(0);" class="slds-button slds-button_neutral" onclick="$('.addNotes').addClass('slds-hide'); return false;">Close</a>
</footer>-->
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                
                <!-- New Appointment create popup -->
                <div class="slds-hide" id="newBookingDetails">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                        <div class="slds-modal__container" style="padding: 10px;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="newBookingDetailsHeader" class="slds-text-heading_medium slds-hyphenate">Create Appointment</h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#newBookingDetails').addClass('slds-hide');refreshNewBookingPopup(); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="newBookingDetailsBody" style="overflow-y: auto;height:600px">
                                 <div class="slds-grid slds-wrap slds-p-around_xx-small">
                                 
                                    <div class="slds-col slds-size_1-of-1">
                                        <div class="slds-grid slds-gutters">
                                            <div class="slds-col slds-size_1-of-12">
                                                <label class="slds-form-element__label hyphens-none-fix" style="hyphens:none" for="centerNameLabel"><b>Location:</b></label>
                                            </div>
                                            <div class="slds-col slds-size_4-of-12">
                                                <div class="slds-form-element__control" style="top: 3px;padding-left:10px;">
                                                    <label id="centerNameLabel"></label>
                                                </div>
                                            </div>
                                            <div class="slds-col slds-size_1-of-12">
                                                <label class ="slds-form-element__label hyphens-none-fix" for="studentInput"><b>Student:</b></label> 
                                            </div>
                                             <div class="slds-col slds-size_6-of-12" style="padding-left:20px;">
                                                <div class="slds-form-element__control">
                                                    <div class="slds-combobox_container">
                                                        <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click " aria-expanded="false" aria-haspopup="listbox" role="combobox" id="studentSelectContainer">
                                                            <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                                <input class="slds-input slds-combobox__input" id="studentInput" aria-autocomplete="list" aria-controls="listbox-id-1" autocomplete="off" role="textbox" type="text" placeholder="Student Name" value="" />
                                                                
                                                            </div>
                                                            <div id="listbox-id-1" class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox" style="max-height: 160px;">
                                                                <ul class="slds-listbox slds-listbox_vertical" role="presentation" id="studentSearchList">
                                                                    
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                 </div>
                                            </div>
                                        </div>
                                        
                                        <div class="slds-grid slds-gutters">
                                            <div class="slds-col slds-size_1-of-12" style="padding-top:10px;">
                                               <label class="slds-form-element__label hyphens-none-fix" for="dateLabel"><b>Date:</b></label>
                                            </div>
                                            <div class="slds-col slds-size_4-of-12" style="padding-top:14px;">
                                                <div class="slds-form-element__control" style="padding-left:10px;">
                                                    <label class="slds-form- element__label" id="dateLabel"></label>
                                                </div>
                                            </div>
                                            <div class="slds-col slds-size_1-of-12" style="padding-top:10px;">
                                                    <label class="slds-form-element__label hyphens-none-fix" for="parentInput"><b>Parent:</b></label>
                                            </div>
                                            <div class="slds-col slds-size_6-of-12" style="padding-top:10px;">
                                                <div class="slds-form-element__control" style="padding-left:9px;">
                                                    <input id="parentInput" placeholder="Parent Name" class="slds-input" type="text" value="" />  
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="slds-grid slds-gutters">
                                            <div class="slds-col slds-size_1-of-12" style="padding-top:10px;">
                                               <label class="slds-form-element__label" for="timeLabel"><b>Time:</b></label> 
                                            </div>
                                            <div class="slds-col slds-size_4-of-12" style="padding-top:14px;">
                                               <div class="slds-form-element__control" style="padding-left:10px;">
                                                    <label id="timeLabel"></label>
                                                </div>     
                                            </div>
                                            <div class="slds-col slds-size_1-of-12" style="padding-top:10px;">
                                               <label class="slds-form-element__label" for="phoneInput"><b>Phone:</b></label> 
                                            </div>
                                            <div class="slds-col slds-size_6-of-12" style="padding-top:10px;">
                                                <div class="slds-form-element__control" style="padding-left:9px;">
                                                    <input id="phoneInput" placeholder="Phone" class="slds-input" type="text" value="" /> 
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="slds-grid slds-gutters">
                                            <div class="slds-col slds-size_1-of-12" style="padding-top:10px;">
                                               <label class="slds-form-element__label" for="makeupHoursLabel"><b>AMM:</b></label> 
                                            </div>
                                            <div class="slds-col slds-size_4-of-12" style="padding-top:14px;">
                                               <div class="slds-form-element__control" style="padding-left:10px;">
                                                    <label id="makeupHoursLabel"></label><br/>
                                                    <label class="" id="makeupHoursErrorMsg" style="color:red;"></label>
                                                </div>     
                                            </div>
                                            <div class="slds-col slds-size_1-of-12" style="padding-top:10px;">
                                               <label class="slds-form-element__label" for="emailInput"><b>Email:</b></label>  
                                            </div>
                                            <div class="slds-col slds-size_6-of-12" style="padding-top:10px;">
                                                <div class="slds-form-element__control" style="padding-left:9px;">
                                                   <input id="emailInput" placeholder="Email" class="slds-input" type="text" value="" /> 
                                                </div>
                                            </div>
                                            
                                        </div>
                                        
                                        <div class="slds-grid slds-gutters">
                                            <div class="slds-col slds-size_1-of-12" style="padding-top:10px;">
                                               <label class ="slds-form-element__label hyphens-none-fix" for="durationLabel"><b>Duration:</b></label> 
                                            </div>
                                            <div class="slds-col slds-size_4-of-12" style="padding-top:14px;">
                                               <div class="slds-form-element__control" style="padding-left:10px;">
                                                    <label id="durationLabel"></label>
                                                </div>     
                                            </div>
                                            <div class="slds-col slds-size_1-of-12" style="padding-top:10px;">
                                               <label class="slds-form-element__label hyphens-none-fix" for="packageSelect"><b>Package:</b></label> 
                                            </div>
                                            <div class="slds-col slds-size_6-of-12" style="padding-top:10px;">
                                               <div class="slds-form-element__control" style="padding-left:9px;">
                                                <div class="slds-combobox_container">
                                                  <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" id="getPackageId" aria-expanded="true" aria-haspopup="listbox" role="combobox">
                                                    <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                      <input type="text" class="slds-input slds-combobox__input slds-has-focus" id="packageSelect" aria-controls="listbox-id-3" autoComplete="off" role="textbox" placeholder="Select Package" readonly="true" />
                                                      <span class="slds-icon_container slds-icon-utility-down slds-input__icon slds-input__icon_right">
                                                        <svg class="slds-icon slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                          <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#down')}"></use>
                                                        </svg>
                                                      </span>
                                                    </div>
                                                    <div id="selectPackageListSection" class="slds-dropdown slds-dropdown_fluid slds-dropdown_length-5" role="listbox">
                                                          
                                                    </div>
                                                  </div>
                                                </div> 
                                               </div>
                                            </div>
                                        </div>
                                        
                                        <div class="slds-grid slds-gutters">
                                            <div class="slds-col slds-size_1-of-1" style="padding-top:10px;">
                                                <div class="slds-form__row slds-hide" id="recurringSection">
                                                    <div class="slds-form__item" role="listitem" style="padding-left: 5px;">
                                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                                           <table class="slds-table slds-no-row-hover recurrence ">
                                                                <tr>
                                                                    <th>Repeat</th>
                                                                    <td>
                                                                        <select class="slds-select" id="repeatSelect" onchange="repeatSelectFunc($(this).val());return false;">
                                                                            <option value="">None</option>
                                                                            <option value="Weeks">Weekly</option>
                                                                        </select>
                                                                    </td>
                                                                </tr>
                                                                <tr class="repeatSelection slds-hide">
                                                                    <th>Repeat Every</th>
                                                                    <td>
                                                                        <select class="slds-select" id="repeatWeek">
                                                                            
                                                                        </select>
                                                                        <span id="repeatValue">Week</span>
                                                                    </td>
                                                                </tr>
                                                                <tr class="repeatSelection slds-hide">
                                                                    <th>Ends</th>
                                                                    <td>
                                                                        <p>
                                                                            <span>
                                                                                <input name="radio" type="radio" id="afterRadio" checked="true"/>
                                                                            </span>&nbsp;&nbsp; After
                                                                            <select class="slds-select" id="recurrenceOccure">
                                                                                
                                                                            </select>&nbsp;&nbsp;
                                                                            <span>occurrencess</span>
                                                                        </p>
                                                                        <p class="slds-m-top_xxx-small">
                                                                            <span>
                                                                                <input name="radio" type="radio" id="onRadio"/>
                                                                            </span>&nbsp;&nbsp; on 
                                                                            <input class="slds-input" type="text" placeholder="Pick a Date" label="Date Picker Label" id="onSelectedDate"/>
                                                                        </p>
                                                                        
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="slds-form__item" role="listitem"> 
                                                        
                                                    </div>
                                                </div>
                                    
                                            </div>
                                        </div>
                                    </div>
                                 </div>
                            </div>   
                            <footer class="slds-modal__footer">
                                <button class="slds-button slds-button_neutral" onclick="$('#newBookingDetails').addClass('slds-hide');refreshNewBookingPopup(); return false;">No</button>
                                <button class="slds-button slds-button_brand" id="saveNewBooking" onclick="createBooking();return false;">Save</button>
                            </footer>  
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                
                <!-- Send Email -->
                <div class="sendEmail slds-hide">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_small">
                        <div class="slds-modal__container" style="width: 50%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('.sendEmail').addClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                                <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Send Email</h2>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                <c:sendemailcomp />
                            </div>
                            <footer class="slds-modal__footer">
                                <a href="javascript:void(0);" class="slds-button slds-button_neutral" onclick="$('.sendEmail').addClass('slds-hide'); return false;">Close</a>
                                <a href="javascript:void(0);" class="slds-button slds-button_brand" onclick="sendEmail(); $('.confirmModal').addClass('slds-hide'); $('.sendEmail').addClass('slds-hide'); return false">Send E-Mail</a> 
                            </footer>
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
            </div>
            
            <!--case container message-->
            <div class="slds-notify_container slds-hide" id="caseContainerMessage">
                <div class="slds-notify slds-notify--alert slds-theme_alt-inverse" role="alert" style="justify-content: right;text-align: left; padding:0px;">
                    <button class="slds-button slds-notify__close slds-button--icon-inverse" id="caseContainerClose" title="Close" onclick="closeCaseContainer();return false;">
                        <svg aria-hidden="true" class="slds-button__icon">
                            <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                        </svg>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <div class="slds-grid slds-wrap" style="flex-wrap: inherit;">
                        <div class="slds-col slds-size_12-of-12">
                            <span class="slds-form-element__label" style="color: #fff;"><b>Parent Name: </b></span>
                            <span>
                                <a href="#" id="caseParentName" target="_blank"></a>
                            </span>
                        </div>
                        <div class="slds-col slds-size_12-of-12">
                            <span class="slds-form-element__label" style="color: #fff;"><b>Case No: </b></span>
                            <span>
                                <a href="#" id="caseNo" target="_blank"></a>
                            </span>
                        </div>
                        <div class="slds-col slds-size_12-of-12">
                            <span class="slds-form-element__label" style="color: #fff;"><b>Type: </b></span>
                            <span id="caseType">
                                <!--<a href="#"  target="_blank"></a> -->
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <!--case container message end -->
            
            <!-- container message -->
            <div class="slds-notify_container slds-hide" id="containerMessage">
                <div class="slds-notify slds-notify--alert slds-theme_alt-inverse" style="padding:0px;" role="alert">
                    <button class="slds-button slds-notify__close slds-button--icon-inverse" id="rescheduleClose" title="Close" onclick="closeContainerMessage();">
                        <svg aria-hidden="true" class="slds-button__icon">
                            <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                        </svg>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <span class="slds-assistive-text">Info</span>
                    <h2>Select Time To Reschedule Appointment</h2>
                </div>
            </div>
            <!-- container message end -->
            <div class="slds-hide" id="newAdhocDetailPopup">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_medium">
                        <div class="slds-modal__container">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="newAdhocDetailHeader" class="slds-text-heading_medium slds-hyphenate">New Appointment Detail</h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#newAdhocDetailPopup').addClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="newAdhocDetailBody">
                                <div class="slds-form__row">
                                        <div class="slds-form__item" role="listitem">
                                            <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                                <label class="slds-form-element__label" for="studentNameadhoc"><b>Student Name:</b></label>  
                                                <div class="slds-form-element__control">
                                                    <label class="slds-form- element__label" id="studentNameadhoc"></label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-form__item" role="listitem">
                                            <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                                <label class="slds-form-element__label" for="centerNameadhoc"><b>Center Name:</b></label> 
                                                <div class="slds-form-element__control">
                                                    <label class="slds-form- element__label" id="centerNameadhoc"></label>                                                   
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="slds-form__row">
                                        <div class="slds-form__item" role="listitem">
                                            <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                                <label class="slds-form-element__label" for="teacherNameAdhoc"><b>Teacher Name:</b></label>  
                                                <div class="slds-form-element__control">
                                                    <label class="slds-form- element__label" id="teacherNameAdhoc"></label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-form__item" role="listitem">
                                            <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                                <label class="slds-form-element__label" for="packageDurationadhoc"><b>Package Duration:</b></label> 
                                                <div class="slds-form-element__control">
                                                    <label class="slds-form- element__label" id="packageDurationadhoc"></label>                                                   
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!--<div class="slds-form__row">
                                        <div class="slds-form__item" role="listitem">
                                            <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                                <label class="slds-form-element__label" for="packageUnitsadhoc"><b>Package Units:</b></label>  
                                                <div class="slds-form-element__control">
                                                    <label class="slds-form- element__label" id="packageUnitsadhoc"></label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-form__item" role="listitem">
                                            <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                                <label class="slds-form-element__label" for="packageFeesadhoc"><b>Package Fees:</b></label> 
                                                <div class="slds-form-element__control">
                                                    <label class="slds-form- element__label" id="packageFeesadhoc"></label>                                                   
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="slds-form__row">
                                        <div class="slds-form__item" role="listitem">
                                            <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                                <label class="slds-form-element__label" for="bookingDateAdhoc"><b>Date:</b></label>  
                                                <div class="slds-form-element__control">
                                                    <label class="slds-form- element__label" id="bookingDateAdhoc"></label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-form__item" role="listitem">
                                            <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                                <label class="slds-form-element__label" for="bookingTimeAdhoc"><b>Time:</b></label> 
                                                <div class="slds-form-element__control">
                                                    <label class="slds-form- element__label" id="bookingTimeAdhoc"></label>                                                   
                                                </div>
                                            </div>
                                        </div>
                                    </div>-->
                                    <div class="slds-p-around_medium">
                                        <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                  <thead>
                                    <tr class="slds-line-height_reset">
                                      <th class="" scope="col">
                                        <div class="slds-truncate" title="Sr.No">Sr No</div>
                                      </th>
                                      <th class="" scope="col">
                                        <div class="slds-truncate" title="Package Name">Package Name</div>
                                      </th>
                                      <th class="" scope="col">
                                        <div class="slds-truncate" title="Package Time">Booking Time</div>
                                      </th>
                                      <th class="" scope="col">
                                        <div class="slds-truncate" title="Package Unit Price">Package Unit Price</div>
                                      </th>
                                      
                                    </tr>
                                  </thead>
                                  <tbody id="countOfBookingTableBody">
                                       
                                   
                                  </tbody>
                                </table>

                                    
                                    </div>
                                    

                            </div>   
                            <footer class="slds-modal__footer">
                                <a href="javascript:void(0);" class="slds-button slds-button_brand" id="createAdhocBookingBtn" onclick="createAdhocBookings();return false;">Create booking and generate invoice</a>
                            </footer>  
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                
                 <!--Advance Option Button Click Popup-->
                <div class="slds-hide" id="advanceOptionPopup">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_medium">
                        <div class="slds-modal__container" style="width: 30%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="advanceOptionPopupHeader" class="slds-text-heading_medium slds-hyphenate">Advance Options</h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#advanceOptionPopup').addClass('slds-hide');refreshAdvancePopup(); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="advanceOptionPopupBody">
                                <div class="slds-col slds-size_1-of-1">
                                    <div class="slds-grid slds-gutters">
                                        <div class="slds-col slds-size_1-of-2">
                                            <span class="slds-form-element__label slds-text-align_right"><b>Package Name: </b></span>
                                            <span id="packageNameAdvance"></span>
                                        </div>
                                        <div class="slds-col slds-size_1-of-2">
                                            <span class="slds-form-element__label slds-text-align_right"><b>Subscription Start Date: </b></span>
                                            <span id="subscriptionDateAdvance"></span>
                                        </div>
                                    </div>
                                    <div class="slds-grid slds-gutters">
                                        <div class="slds-col slds-size_1-of-2">
                                            <span class="slds-form-element__label slds-text-align_right"><b>Frequency: </b></span>
                                            <span id="frequencyAdvance"></span>
                                        </div>
                                        <div class="slds-col slds-size_1-of-2">
                                            <span class="slds-form-element__label slds-text-align_right"><b>Timeslot: </b></span>
                                            <span id="timeslotAdvance"></span>
                                        </div>
                                    </div>
                                    
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-p-around_medium">
                                    <div class="slds-button-group" role="group">
                                      <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" title="Cancel Subscription" aria-pressed="false" id="cancelSubscriptionBtn" onclick="cancelSubscription();return false;">Withdraw
                                        <svg class="slds-button__icon" aria-hidden="true">
                                            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}" />
                                        </svg>
                                        <span class="slds-assistive-text">Withdraw</span>
                                      </button>
                                      <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" title="Upgrade Subscription" aria-pressed="false" id="upgradeSubscriptionBtn" onclick="upgradeSubscription();return false;">Upgrade Subscription
                                          <svg class="slds-button__icon" aria-hidden="true">
                                            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#arrowup')}" />
                                          </svg>
                                          <span class="slds-assistive-text">Upgrade Subscription</span>
                                      </button>
                                      <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" title="Downgrade Subscription" aria-pressed="false" id="downgradeSubscriptionBtn" onclick="downgradeSubscription();return false;">Downgrade Subscription
                                          <svg class="slds-button__icon" aria-hidden="true">
                                            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#arrowdown')}" />
                                          </svg>
                                          <span class="slds-assistive-text">Downgrade Subscription</span>
                                      </button>
                                    </div>
                                </div>
                            </div>  
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                
                 <!--Upgrade Subscriptions-->
                <div class="slds-hide" id="gradeSubscriptionPopup">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_medium">
                        <div class="slds-modal__container" style="width: 30%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="gradeSubscriptionPopupHeader" class="slds-text-heading_medium slds-hyphenate"><b>Upgrade Subscription</b></h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#gradeSubscriptionPopup').addClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="gradeSubscriptionPopupBody">
                                <div class="slds-grid slds-wrap">
                                    <div class="slds-col slds-size_6-of-12">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Current Package: </b></span>
                                        <span id="currentPackageName"></span>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Requested Package: </b></span>
                                        <span>
                                            <select class="slds-select" id="selectRequestedPackage" style="width: auto;">
                                            </select>
                                        </span>
                                        <label style="color:red;padding-left: 122px;" id="upgradePackageSelectError"></label>
                                      </div>
                                      <div class="slds-col slds-size_6-of-12">
                                          <div class="slds-grid slds-gutters">
                                              <div class="slds-col slds-size_4-of-12" style="padding-right: 0px;">
                                                <span class="slds-form-element__label slds-text-align_right"><b>Effective Date: </b></span>
                                              </div>
                                              <div class="slds-col slds-size_8-of-12">
                                                <span><input class="slds-input" type="text" placeholder="Pick a Date" label="Date Picker Label" id="effectiveDateInput"/></span>
                                                <label style="color:red;padding-left: 3px;" id="effectiveDateError"></label>
                                              </div>
                                        </div>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12">
                                     </div>
                                     <div class="slds-col slds-size_4-of-12">
                                         <button class="slds-button button-shadow" title="Summary Request" onclick="upgradeSummary('upgrade');return false;" aria-pressed="false">Summary
                                             <svg class="slds-button__icon" aria-hidden="true">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#summary')}" />
                                             </svg>
                                             <span class="slds-assistive-text">Summary</span>
                                         </button>
                                     </div>
                                     <div class="slds-col slds-size_4-of-12">
                                         <button class="slds-button button-shadow" title="Submit Request" aria-pressed="false" id="submitUpgradeRequest" onclick="submitUpgradePackageRequest();return false;">Submit Request
                                             <svg class="slds-button__icon" aria-hidden="true">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                             </svg>
                                             <span class="slds-assistive-text">Submit Request</span>
                                         </button>
                                     </div>
                                      <div class="slds-col slds-size_4-of-12">
                                         <button class="slds-button button-shadow" title="Cancel Request" aria-pressed="false" id="cancelUpgradeRequest" onclick="$('#gradeSubscriptionPopup').addClass('slds-hide'); return false;">Cancel Request
                                             <svg class="slds-button__icon" aria-hidden="true">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}" />
                                             </svg>
                                             <span class="slds-assistive-text">Cancel Request</span>
                                         </button>
                                       </div>
                                     </div>
                                  </div>
                                  
                            </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                
                <!--Cancel subscription Modal-->
                <div class="slds-hide" id="canelSubscriptionPopup">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_medium">
                        <div class="slds-modal__container" style="width: 30%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="canelSubscriptionPopupHeader" class="slds-text-heading_medium slds-hyphenate"><b>Cancel Subscription</b></h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#canelSubscriptionPopup').addClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="canelSubscriptionPopupBody">
                                <div class="slds-grid slds-wrap">
                                    <!--Row 1 -->
                                    <div class="slds-col slds-size_3-of-12 slds-p-vertical_x-small">
                                    </div>
                                    <div class="slds-col slds-size_5-of-12 slds-p-vertical_x-small">
                                        <span class="slds-radio">
                                        <input type="radio" id="cancelByRequestDate" name="cancelByOptions" onchange="cancelBy();return false;"/>
                                        <label class="slds-radio__label" for="cancelByRequestDate">
                                          <span class="slds-radio_faux"></span>
                                          <span class="slds-form-element__label">By Cancellation Request Date</span>
                                        </label>
                                      </span>
                                     </div>
                                     <div class="slds-col slds-size_4-of-12 slds-p-vertical_x-small">
                                        <span class="slds-radio">
                                        <input type="radio" id="cancelByLessonEndDate" name="cancelByOptions" onchange="cancelBy();return false;"/>
                                        <label class="slds-radio__label" for="cancelByLessonEndDate">
                                          <span class="slds-radio_faux"></span>
                                          <span class="slds-form-element__label">By Lesson End Date</span>
                                        </label>
                                      </span>
                                     </div>
                                     <!--Row 2 -->
                                     <div class="slds-col slds-size_1-of-12 slds-p-vertical_x-small">
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                         <span class="slds-form-element__label slds-text-align_right"><b>Cancellation Request Date</b></span>
                                         <span>
                                             <input class="slds-input" id="cancelRequestDate" style="width:130px;" onchange="getCancelRequestDateFunc();return false;"/>
                                         </span>
                                     </div>
                                     <div class="slds-col slds-size_5-of-12 slds-p-vertical_x-small">
                                         <span class="slds-form-element__label slds-text-align_right"><b>Last Lesson Date</b></span>
                                         <span>
                                             <input class="slds-input" id="lastLessonDate" style="width:130px;" onchange="getLastLessonDateFunc();return false;"/>
                                         </span>
                                     </div>
                                     <!--Row 3 -->
                                     <div class="slds-col slds-size_2-of-12 slds-p-vertical_x-small">
                                     </div>
                                      <div class="slds-col slds-size_5-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Notice Period Start: </b></span>
                                        <span id="noticePeriodStart"></span>
                                     </div>
                                     <div class="slds-col slds-size_5-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Notice Period End: </b></span>
                                        <span id="noticePeriodEnd"></span>
                                     </div>
                                     <!--Row 4-->
                                     <div class="slds-col slds-size_4-of-12 slds-p-vertical_x-small">
                                         <button class="slds-button button-shadow" title="Summary Request" onclick="withdrawSummary();return false;" aria-pressed="false">Summary
                                             <svg class="slds-button__icon" aria-hidden="true">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#summary')}" />
                                             </svg>
                                             <span class="slds-assistive-text">Summary</span>
                                         </button>
                                     </div>
                                     <div class="slds-col slds-size_4-of-12 slds-p-vertical_x-small">
                                         <!--<div class="slds-button-group" role="group">-->
                                             <button class="slds-button button-shadow" title="Confirm Withdrawal" aria-pressed="false" id="submitCancelRequest" onclick="submitCancelPackageRequest();return false;">Confirm Withdrawal
                                                 <svg class="slds-button__icon" aria-hidden="true">
                                                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                 </svg>
                                                 <span class="slds-assistive-text">Confirm Withdrawal</span>
                                             </button>
                                         <!--</div>-->
                                     </div>
                                      <div class="slds-col slds-size_4-of-12 slds-p-vertical_x-small">
                                         <!--<div class="slds-button-group" role="group">-->
                                             <button class="slds-button button-shadow" title="Cancel" aria-pressed="false" id="cancelUpgradeRequest" onclick="$('#canelSubscriptionPopup').addClass('slds-hide');return false;">Cancel
                                                 <svg class="slds-button__icon" aria-hidden="true">
                                                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}" />
                                                 </svg>
                                                 <span class="slds-assistive-text">Cancel</span>
                                             </button>
                                         <!--</div>-->
                                       </div>
                                </div>
                                  
                            </div>
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
               <!-- Cancel subscription popup closed -->
               <!-- Summary for withdrawl popup start-->
                <div class="slds-hide" id="summaryPopForAdvanceAction">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_medium">
                        <div class="slds-modal__container" style="width: 30%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="summaryPopForAdvanceActionHeader" class="slds-text-heading_medium slds-hyphenate"><b>Summary</b></h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#summaryPopForAdvanceAction').addClass('slds-hide');$('#canelSubscriptionPopup').removeClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="summaryPopForAdvanceActionBody">
                                <div class="slds-grid slds-wrap">
                                     <!--Row 1 -->
                                     <!--<div class="slds-col slds-size_2-of-12 slds-p-vertical_x-small">
                                     </div>-->
                                      <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Request Date: </b></span>
                                        <span id="summaryRequestDate"></span>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Last Lesson Date: </b></span>
                                        <span id="summaryLastLessonDate"></span>
                                     </div>
                                     <!--Row 2 -->
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Notice Period Start Date: </b></span>
                                        <span id="summaryNoticeStartDate"></span>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Notice Period End Date: </b></span>
                                        <span id="summaryNoticeEndDate"></span>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Lesson To Be Adjusted Against Deposit Fee: </b></span>
                                        <span id="summaryNoOfLessonFromDeposit"></span>
                                     </div>
                                     <!--Row 3 -->
                                     <!--Row 4-->
                                </div>
                            </div>
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                 
               <!-- Summary for withdrawl popup end-->
                
                <!-- Summary for downgrade/upgrade popup start-->
                <div class="slds-hide" id="summaryPopForUpDown">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_medium">
                        <div class="slds-modal__container" style="width: 30%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="summaryPopForUpDownHeader" class="slds-text-heading_medium slds-hyphenate"><b>Summary</b></h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" id="updownsummaryclose" title="Close" onclick="closeUpDownSummary();return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="summaryPopForUpDownBody">
                                <div class="slds-grid slds-wrap slds-hide" id="downgradeDetailsSection">
                                     <!--row1-->
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Request Date: </b></span>
                                        <span id="summaryRequestDate1"></span>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Effective Date: </b></span>
                                        <span id="summaryEffectiveLessonDate"></span>
                                     </div>
                                         <!--Row 2 -->
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Notice Period Start Date: </b></span>
                                        <span id="summaryNoticeStartDate1"></span>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Notice Period End Date: </b></span>
                                        <span id="summaryNoticeEndDate1"></span>
                                     </div>
                                 </div>
                                 <div class="slds-grid slds-wrap">
                                
                                     <!--Row 3 -->
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Old Pakcage </b></span>
                                        <span id="oldPackageName"></span>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>New Package</b></span>
                                        <span id="newPackageName"></span>
                                     </div>
                                     <!--Row 4-->
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>No Of Lesson With Old Package: </b></span>
                                        <span id="lessonWithOldPackage"></span>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>No Of Lesson With new Package:</b></span>
                                        <span id="lessonWithNewPackage"></span>
                                     </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                <!-- Summary for downgrade/upgrade popup end-->
                  
                <!--Busy Time Creation Modal-->
                <div class="slds-hide" id="busyBookingCreateModal">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                        <div class="slds-modal__container" style="padding:10px;"> <!-- width: 35%;-->
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="busyBookingCreateModalHeader" class="slds-text-heading_medium slds-hyphenate">Busy Booking</h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#busyBookingCreateModal').addClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a> 
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="busyBookingCreateModalBody">
                                <div class="slds-grid slds-wrap">
                                    <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:10px;">
                                        <span><b>Location</b></span>
                                    </div>
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:10px;">
                                        <span><label id="centerNameBusyCreate">Aureus Northpoint</label></span>
                                    </div>
                                     <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:10px;">
                                        <span><b>Time</b></span>
                                    </div>
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:10px;">
                                        <span><label id="timeSlotBusyCreate">Mon, 18 March 2019 at 10:00 AM</label></span>
                                    </div>
                                    <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:5px;">
                                        <span><b>Staff</b></span>
                                    </div>
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:5px;">
                                        <span><label id="staffBusyCreate"></label></span>
                                    </div>
                                    <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:10px;">
                                        <span><b>Duration</b></span>
                                    </div>
                                    
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:5px;">
                                        <span>
                                            <select class="slds-select" id="durationSelectBusyCreate" style="width: auto;">
                                                <option value="30">30 Mins</option>
                                                <option value="45">45 Mins</option>
                                            </select>
                                        </span>
                                    </div>
                                    
                                    <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:10px;">
                                        <span><b>Category</b></span>
                                    </div>
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:5px;">
                                        <span>
                                            <select class="slds-select" id="categorySelectBusyCreate" style="width: auto;">
                                                
                                            </select>
                                        </span>
                                    </div>
                                     <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:10px;">
                                        <span><b>Description</b></span>
                                    </div>
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:5px;">
                                        <textarea type="text" id="descriptionBusyCreate" placeholder="Enter Description" class="slds-textarea" />
                                    </div>
                                </div>
                                
                                <div class="slds-grid slds-gutters">
                                    <div class="slds-col slds-size_1-of-1" style="padding-top:10px;">
                                        <div class="slds-form__row" style="padding-left:20px;padding-top:5px;">
                                            <div class="slds-form__item" role="listitem" style="padding-left: 5px;">
                                                <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                                   <table class="slds-table slds-no-row-hover recurrence ">
                                                        <tr>
                                                            <th>Repeat</th>
                                                            <td>
                                                                <select class="slds-select" id="repeatSelectBusy" onchange="repeatSelectFunc($(this).val());return false;">
                                                                    <option value="">None</option>
                                                                    <option value="Weeks">Weekly</option>
                                                                </select>
                                                            </td>
                                                        </tr>
                                                        <tr class="repeatSelection slds-hide">
                                                            <th>Repeat Every</th>
                                                            <td>
                                                                <select class="slds-select" id="repeatWeekBusy">
                                                                    
                                                                </select>
                                                                <span id="repeatValue">Week</span>
                                                            </td>
                                                        </tr>
                                                        <tr class="repeatSelection slds-hide">
                                                            <th>Ends</th>
                                                            <td>
                                                                <p>
                                                                    <span>
                                                                        <input name="radio" type="radio" id="afterRadioBusy" checked="true"/>
                                                                    </span>&nbsp;&nbsp; After
                                                                    <select class="slds-select" id="recurrenceOccureBusy">
                                                                        
                                                                    </select>&nbsp;&nbsp;
                                                                    <span>occurrencess</span>
                                                                </p>
                                                                <p class="slds-m-top_xxx-small">
                                                                    <span>
                                                                        <input name="radio" type="radio" id="onRadioBusy"/>
                                                                    </span>&nbsp;&nbsp; on 
                                                                    <input class="slds-input" type="text" placeholder="Pick a Date" label="Date Picker Label" id="onSelectedDateBusy"/>
                                                                </p>
                                                                
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="slds-form__item" role="listitem"> 
                                                
                                            </div>
                                        </div>
                            
                                    </div>
                                </div>
                            </div>
                             <footer class="slds-modal__footer">
                                <div class="slds-button-group" role="group" style="display: block;">
                                    <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" title="Cancel" aria-pressed="false" id="cancelBusyBookingCreate" onclick="$('#busyBookingCreateModal').addClass('slds-hide'); return false;">Cancel
                                        <svg class="slds-button__icon" aria-hidden="true">
                                          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}" />
                                        </svg>
                                        <span class="slds-assistive-text">Cancel</span>
                                  </button>
                                  <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" title="Save" aria-pressed="false" id="saveBusyBookingCreate" onclick="saveBusyBookingFunc();return false;">Save
                                        <svg class="slds-button__icon" aria-hidden="true">
                                          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#save')}" />
                                        </svg>
                                        <span class="slds-assistive-text">Save</span>
                                  </button>
                                </div>
                                
                            </footer> 
                        </div> 
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                <!--Downgrade Subscriptions-->
                <div class="slds-hide" id="downgradePopup">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_medium">
                        <div class="slds-modal__container" style="width: 30%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="downgradePopupHeader" class="slds-text-heading_medium slds-hyphenate"><b>Downgrade Subscription</b></h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#downgradePopup').addClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="downgradeSubscriptionPopupBody">
                                <div class="slds-grid slds-wrap">
                                    <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Current Package: </b></span>
                                        <span id="currentPackageNameDowngrade"></span>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 slds-p-vertical_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Requested Package: </b></span>
                                        <span>
                                            <select class="slds-select" id="selectRequestedPackageDowngrade" style="width: 177px;">
                                            </select>
                                        </span>
                                        <label style="color:red;padding-left: 122px;" id="downgradePackageSelectError"></label>
                                      </div>
                                      <div class="slds-col slds-size_6-of-12" style="margin-bottom: -10px;">
                                          <div class="slds-grid slds-gutters">
                                              <div class="slds-col slds-size_4-of-12" style="padding-right: 0px;">
                                                <span class="slds-form-element__label slds-text-align_right"><b>Effective Date: </b></span>
                                              </div>
                                              <div class="slds-col slds-size_8-of-12">
                                                <span><input class="slds-input" type="text" placeholder="Pick a Date" label="Date Picker Label" id="effectiveDateInputDowngrade" onchange="getNoticePeriod();return false;"/></span>
                                                <label style="color:red;padding-left: 3px;" id="effectiveDateErrorDowngrade"></label>
                                              </div>
                                        </div>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 ">
                                     </div>
                                     <!--Row 3 -->
                                      <div class="slds-col slds-size_6-of-12 slds-p-bottom_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Notice Period Start: </b></span>
                                        <span id="noticePeriodDowngradeStart"></span>
                                     </div>
                                     <div class="slds-col slds-size_6-of-12 slds-p-bottom_x-small">
                                        <span class="slds-form-element__label slds-text-align_right"><b>Notice Period End: </b></span>
                                        <span id="noticePeriodDowngradeEnd"></span>
                                     </div>
                                     <div class="slds-col slds-size_4-of-12">
                                         <button class="slds-button button-shadow" title="Summary Request" onclick="upgradeSummary('downgrade');return false;" aria-pressed="false">Summary
                                             <svg class="slds-button__icon" aria-hidden="true">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#summary')}" />
                                             </svg>
                                             <span class="slds-assistive-text">Summary</span>
                                         </button>
                                     </div>
                                     <div class="slds-col slds-size_4-of-12">
                                         <button class="slds-button button-shadow"  title="Submit Request" aria-pressed="false" id="submitDowngradeRequest" onclick="submitDowngradePackageRequest();return false;">Submit Request
                                             <svg class="slds-button__icon" aria-hidden="true">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                             </svg>
                                             <span class="slds-assistive-text">Submit Request</span>
                                         </button>
                                         
                                     </div>
                                     <div class="slds-col slds-size_4-of-12">
                                         <button class="slds-button button-shadow" title="Cancel Request" aria-pressed="false" onclick="$('#downgradePopup').addClass('slds-hide');return false;">Cancel Request
                                             <svg class="slds-button__icon" aria-hidden="true">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}" />
                                             </svg>
                                             <span class="slds-assistive-text">Cancel Request</span>
                                         </button>
                                     </div>
                                     </div>
                                  </div>
                                  
                            </div>
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
                 <!--Busy Bookings View-->
                <div class="slds-hide" id="busyBookingViewModal">
                    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                        <div class="slds-modal__container" style="width: 50%;">
                            <header class="slds-modal__header" style="background: #303a42; color: white;">
                                <h2 id="busyBookingViewModalHeader" class="slds-text-heading_medium slds-hyphenate">Busy Booking</h2>
                                <a href="javascript:void(0);" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="$('#busyBookingViewModal').addClass('slds-hide'); return false;">
                                    <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                        <use xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
                                    </svg>
                                    <span class="slds-assistive-text">Close</span>
                                </a>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="busyBookingViewModalBody">
                                <div class="slds-grid slds-wrap">
                                    <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:10px;">
                                        <span><b>Location</b></span>
                                    </div>
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:10px;">
                                        <span><label id="centerNameBusyView"></label></span>
                                    </div>
                                     <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:10px;">
                                        <span><b>Time</b></span>
                                    </div>
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:10px;">
                                        <span><label id="timeSlotBusyView"></label></span>
                                    </div>
                                    <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:10px;">
                                        <span><b>Duration</b></span>
                                    </div>
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:5px;">
                                        <span>
                                            <label id="durationBusyView"></label>
                                        </span>
                                    </div>
                                    <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:5px;">
                                        <span><b>Staff</b></span>
                                    </div>
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:5px;">
                                        <span><label id="staffBusyView"></label></span>
                                    </div>
                                    <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:10px;">
                                        <span><b>Category</b></span>
                                    </div>
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:10px;">
                                        <span><label id="categoryBusyView"></label></span>
                                    </div>
                                     <div class="slds-col slds-size_3-of-12" style="padding-left:20px;padding-top:10px;">
                                        <span><b>Description</b></span>
                                    </div>
                                    
                                    <div class="slds-col slds-size_9-of-12" style="padding-top:5px;">
                                        <textarea type="text" id="descriptionBusyView" placeholder="Busy Time Description" class="slds-textarea" readonly="true" style="cursor: default;"/>
                                    </div>
                                </div>
                            </div>
                             <footer class="slds-modal__footer">
                                <div class="slds-grid slds-gutters">
                                      <div class="slds-col slds-size_12-of-12" id="button_Group_reschedule" style="padding-left:0px;padding-right:0px;">
                                        <div class="slds-button-group" role="group" >
                                          <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow addNewBookingFromBusy" aria-pressed="false" id="addNewBooking" onclick="newAppointmentPopup($(this).attr('data-centerid'), $(this).attr('data-teacherid'), $(this).attr('data-date'));return false;">Add Appointment
                                            <svg class="slds-button__icon" aria-hidden="true">
                                              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#event')}" />
                                            </svg>
                                            <span class="slds-assistive-text">Add Appointment</span>
                                          </button>
                                          
                                            <!--<button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow editBooking" title="Reschedule" aria-pressed="false" id="rescheduleBusyBookingView" onclick="$('#busyBookingViewModal').addClass('slds-hide'); return false;">Reschedule
                                                <svg class="slds-button__icon" aria-hidden="true">
                                                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#edit')}" />
                                                </svg>
                                                <span class="slds-assistive-text">Reschedule</span>
                                          </button>
                                           <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" title="Cancel" aria-pressed="false" id="cancelBusyBookingView" onclick="cancelBusyAppointment();return false;">Cancel
                                        <svg class="slds-button__icon" aria-hidden="true">
                                          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}" />
                                        </svg>
                                        <span class="slds-assistive-text">Cancel</span>
                                  </button>-->
                                        </div>
                                    </div>
                                      
                                </div>
                                <!--<div class="slds-button-group" role="group" style="display: block;">
                                  <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow editBooking" title="Reschedule" aria-pressed="false" id="rescheduleBusyBookingView" onclick="$('#busyBookingViewModal').addClass('slds-hide'); return false;">Reschedule
                                        <svg class="slds-button__icon" aria-hidden="true">
                                          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#edit')}" />
                                        </svg>
                                        <span class="slds-assistive-text">Reschedule</span>
                                  </button>
                                  <button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" title="Cancel" aria-pressed="false" id="cancelBusyBookingView" onclick="cancelBusyAppointment();return false;">Cancel
                                        <svg class="slds-button__icon" aria-hidden="true">
                                          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}" />
                                        </svg>
                                        <span class="slds-assistive-text">Cancel</span>
                                  </button>
                                </div>
                                -->
                            </footer> 
                        </div> 
                    </section>
                    <div class="slds-backdrop slds-backdrop_open"></div>
                </div>
        </apex:form>
        <div id="blank" style="display:none"></div>
        <script>
        //Global Variable for Filter
        var filter = {};
        filter.center = '';
        filter.teacher = '';
        filter.resource = '';
        filter.instrument = '';
        
        
        var bookingReschedule = {};
        bookingReschedule.Id = '';
        bookingReschedule.Type = '';
        bookingReschedule.resource = '';
        bookingReschedule.date = '';
        bookingReschedule.Individual = '';
        bookingReschedule.isRecurrence = '';
        bookingReschedule.scheduleType = '';
        
        var eventsOfCalendar = {};
        var createBookingResult = {};
        var isRecursive = true;
        var teacher = '{!teacherName}';
        var center = '{!centerName}';
        var teacherWorkingHours = {};
        var instruments = '';
        var eventId = '';
        var originalTime;
        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!
        var yyyy = today.getFullYear();
        var isReschedule = false;
        var caseId = '';
        var userDetail = '';
        if(dd < 10){
            dd = '0' + dd;
        }
        
        //$('[id$=teachers]').children().first().after('<option value="AllRosteredStaff">All rostered staff</option><option value="AllStaff">All staff</option>');
        //$('[id$=resources]').children().first().after('<option value="AllRosteredResource">All rostered resources</option><option value="AllResource">All Resources</option>');
        
        $('[id$=teachers]').val('AllRosteredStaff');
        
        filter.center =  $('[id$=centers]').val();
        filter.teacher = $('[id$=teachers]').val();
        teacher= $('[id$=teachers]').val();
        if(mm < 10){
            mm = '0' + mm;
        }
        console.error('filter.teacher',filter.teacher);
        today = [yyyy + '-' + mm + '-' + dd];
        
        var calView = $('#calendar').fullCalendar('getView').name;
        //alert(calView);
        if ( calView == '' || calView === 'undefined' || calView === 'month' || calView === undefined){
            calView = 'agendaDay';
        }
        
        var bookingData = {};
        //var j$ = jQuery.noConflict();
        //Assigning SLDS Static Resource Path To A Variable To Use It With ALJS Initialization
        var assetsLoc = '';
          
        //ALJS Initialization   
               
        $.aljsInit({
          assetsLocation: assetsLoc, //SLDS Static Resource Path
          scoped: true
        });
           
      
       $( document ).on( 'keydown', function ( e ) {
            if ( e.keyCode === 27 ) { // ESC
               closeContainerMessage();
            }
        });
        
        var datesArray = new Array();
        var dt = moment();
        //console.log('dt',dt);
        var bookDate = dt.format('YYYY-MM-DD');
        
        /*beginOfWeek = dt.startOf('week');
        var start = beginOfWeek.format('YYYY-MM-DD');
        
        var endOfWeek = dt.endOf('week');
        var end = endOfWeek.format('YYYY-MM-DD');
        
        datesArray.push(start);*/
        datesArray.push(bookDate);
        
        var calendarDates = datesArray;
        //console.log('calendarDates',calendarDates);
        //console.log('userDetail before first call ',userDetail );
        initResources(center, teacher, filter.resource, calendarDates , 'agendaDay', filter.instrument); // 'agendaTwoDay'
        
        $(document).ready(function(){
            caseId = '{!$currentpage.parameters.id}';
            getCaseDetails(caseId);
            getUserDetails();
            var profileId = '{!$Profile.Id}';
            console.log('Profile Id ', profileId.length);
            //console.log('Current Parameter {!$currentpage.parameters.id}');
            //$('[id$=teachers]').val('AllRosteredStaff');        
            $('#onSelectedDate').datepicker({
                initDate: moment(), //Today Date
                format: 'YYYY-MM-DD', //Date Format Of Datepicker Input Field
                onChange: function(datepicker) {
                $('#SelectedDate').html('Selected Date: <strong>'+moment(datepicker.selectedFullDate._d).format('YYYY-MM-DD')+'</strong>');
               }
            });
            
            $('#onSelectedDateBusy').datepicker({
                initDate: moment(), //Today Date
                format: 'YYYY-MM-DD', //Date Format Of Datepicker Input Field
            });
             var today = new Date();
             $('#effectiveDateInput').datepicker({
                initDate: moment(), //Today Date
                format: 'YYYY-MM-DD',
                minDate: today, //Date Format Of Datepicker Input Field
                onChange: function(datepicker) {
                $('#effectiveDateInput').html('Selected Date: <strong>'+moment(datepicker.selectedFullDate._d).format('YYYY-MM-DD')+'</strong>');
               }
            });
            
            console.log('user Details before date initialize',userDetail );
            /*$('#cancelRequestDate').datepicker({
                initDate: moment(), //Today Date
                format: 'YYYY-MM-DD', //Date Format Of Datepicker Input Field
                onChange: function(datepicker) {
                $('#cancelRequestDate').html('Selected Date: <strong>'+moment(datepicker.selectedFullDate._d).format('YYYY-MM-DD')+'</strong>');
               }
            });
            */
            $('#lastLessonDate').datepicker({
                initDate: moment(), //Today Date
                format: 'YYYY-MM-DD', //Date Format Of Datepicker Input Field
                onChange: function(datepicker) {
                $('#lastLessonDate').html('Selected Date: <strong>'+moment(datepicker.selectedFullDate._d).format('YYYY-MM-DD')+'</strong>');
               }
            });
          
             $('#effectiveDateInputDowngrade').datepicker({
                initDate: moment(), //Today Date
                format: 'YYYY-MM-DD', //Date Format Of Datepicker Input Field
                onChange: function(datepicker) {
                $('#selectRequestedPackageDowngrade').html('Selected Date: <strong>'+moment(datepicker.selectedFullDate._d).format('YYYY-MM-DD')+'</strong>');
               }
            }); 
          
            initChange();
            $('#repeatValue').html($('#repeats').val());
            $('.whenPencilled').hide();
            $('.whenConfirmed').hide();
            $('#autoExpireDateTime').hide();
            $('#confirm').click();
            
            // Tabs
            $('.slds-tabs--default__link,.slds-tabs--scoped__link').click(function(){
                $(this).parent().parent().find('.slds-tabs--default__link,.slds-tabs--scoped__link').attr('aria-selected','false');
                $(this).attr('aria-selected','true');
                $(this).parent().parent().find('.slds-tabs--default__link,.slds-tabs--scoped__link').attr('tabindex','-1');
                $(this).attr('tabindex','0');
                $(this).parent().addClass('slds-active').siblings().removeClass('slds-active');
                $(this).parent().parent().parent().find('.'+$(this).parent().parent().parent().find('.slds-tabs--default__content,.slds-tabs--scoped__content')[0].classList[0]).removeClass('slds-show').addClass('slds-hide');
                $(this).parent().parent().parent().find('#'+$(this).attr('aria-controls')).removeClass('slds-hide').addClass('slds-show');
            });
            // End Tabs
        });
        
        $('#repeats').change(function(){
            $('#repeatValue').html($('#repeats').val());
        });
        
        /*$('#containerMessage').click(function(){
                
            });*/
        $('#pencilled').click(function(){
            $('.whenConfirmed').hide();
            $('.whenPencilled').show();
        });
        
        $('#confirm').click(function(){
            $('.whenPencilled').hide();
            $('.whenConfirmed').show();
        });
        
        $("#autoExire").click(function () {
            if ($(this).is(":checked")) {
                $("#autoExpireDateTime").show();
            } else {
                $("#autoExpireDateTime").hide();
            }
        });
        
        function repeatSelectFunc(val){
             $('#recurrenceOccure').empty();
             $('#recurrenceOccureBusy').empty();
             $('#repeatWeek').empty();
             $('#repeatWeekBusy').empty();
            console.log('val', val);
            if(val == 'None'){
                $('.repeatSelection').addClass('slds-hide');
            }else{
                var optionRecursion = '';
                for(let i = 1;i <= {!$Label.Recurring_occurrence};i++){
                    optionRecursion += '<option value="'+i+'">'+i+'</option>';
                }
                $('#recurrenceOccure').append(optionRecursion);
                $('#recurrenceOccureBusy').append(optionRecursion);
                optionRecursion = '';
                
                for(let j = 1; j<=1; j++){
                    optionRecursion += '<option value="'+j+'">'+j+'</option>';
                }
                $('#repeatWeek').append(optionRecursion);
                $('#repeatWeekBusy').append(optionRecursion);
                $('.repeatSelection').removeClass('slds-hide');
            }
        }
        
        $('#packageSelect').focusin(function() {
            $('#getPackageId').addClass('slds-is-open');
        });
        
        //Cancel Booking event 
        $('#cancelBooking').click(function(){
            var timeDeff;
            $('.editDetails').addClass('slds-hide');
            var bookingId = $(this).attr("data-id");
            var bookingDateTime = $(this).attr("data-date");
            var bookingType = $(this).attr("data-type");
            console.log('bookingType',bookingType);
            if(bookingId && bookingDateTime && bookingType && bookingType != 'Busy'){
                if(isDateTimeInFuture(bookingDateTime)){
                    console.log('yes we are in future');
                    timeDeff = isDateBetween24Hours(bookingDateTime);
                    if(timeDeff > 24 || bookingType == 'Trial'){
                        Visualforce.remoting.Manager.invokeAction(
                            '{!$RemoteAction.AureusCalendarController.getPickListValues}',
                            'Booking__c', 'Cancellation_Reason__c', 
                            function(result, event){
                                console.log('result', result);
                                if(result){
                                    $('#cancelBookingWithReason').attr('data-id', bookingId);
                                    $('#cancelBookingWithReason').attr('data-time', timeDeff);
                                    $('#cancelBookingWithReason').attr('data-type', bookingType);
                                    $('#cancelReason').empty();
                                    var cancelReason = '<option value="">Select Cancellation Reason</option>';
                                    $(result).each(function(index, value){
                                        cancelReason += '<option value="'+value+'">'+value+'</option>'
                                    });                                                                      
                                    console.log('result ', result);
                                    $('#cancelReason').append(cancelReason);
                                    $('.cancellationReasonPopup').removeClass('slds-hide');
                                }
                            }, 
                            {escape: true}
                        );
                    }else{
                        console.log('open second popup');
                        $('.cancellationReasonPopup').addClass('slds-hide');
                    $('#cancelBookingWithMakeupBtn').attr({'data-id':bookingId, 'data-reason':'' });
                    $('#no-makeup').attr({'data-id':bookingId, 'data-reason':'' });
                    Visualforce.remoting.Manager.invokeAction(
                        '{!$RemoteAction.AureusCalendarController.getPickListValues}',
                        'Booking__c', 'Makeup_Reason__c', 
                        function(result, event){
                            console.log('result', result);
                            if(result){
                                $('#cancelReason').empty();
                                
                                var cancelReason = '<option value="">Select Make Up Credit Reason</option>';
                                $(result).each(function(index, value){
                                    cancelReason += '<option value="'+value+'">'+value+'</option>'
                                });                                                                      
                                console.log('result ', result);
                                $('#cancelReason').append(cancelReason); 
                                $('.reasonSection').addClass('slds-hide'); 
                                $('#reasonPopupText').html('Make Up Credit for Booking');
                                $('.notMakeupHoursShow').addClass('slds-hide');
                                $('.reasonText').html('Reason For Make up Credit:');
                                $('#cancelBookingWithReason').addClass('slds-hide');
                                
                                $('.makeupTitle').removeClass('slds-hide');
                                $('.close-popup').addClass('slds-hide');
                                
                                $('.cancellationReasonPopup').removeClass('slds-hide');
                                
                            }
                        }, 
                        {escape: true}
                    );
                    }
                }else{
                    $('#toastMsg').html('Cannot cancel past Bookings');
                    $('.toastclass').removeClass('slds-theme_success');
                    $('.toastclass').addClass('slds-theme_error');
                    
                    toastLaunch();
                }
            }else{
                
                $('#confirmBody').html('Do you want cancel busy appointment?');
                $('#confirmHeader').html('Cancel Booking');
                $('#confirmModalYes').attr('data-id', bookingId);
                $('#confirmModalYes').attr('data-time', timeDeff);
                $('#confirmModalYes').attr('data-type', bookingType);
                $('#confirmModalYes').attr('data-origin','cancel');
                $('#confirmModalNo').attr('data-origin','cancel');
                $('.confirmModal').removeClass('slds-hide');
            }
            
        });
        $('.editBooking').click(function(){
            $('.editDetails').addClass('slds-hide');
            //$('.popupDetails').addClass('slds-hide');
            $('#containerMessage').removeClass('slds-hide');
            bookingReschedule.Id = $(this).attr('data-id');
            bookingReschedule.Type = $(this).attr('data-type');
            bookingReschedule.Individual = $(this).attr('data-individual');
            if(bookingReschedule.Type == 'Regular'){
                isReschedule = true;
            }
            console.log('On Edit Button click ', bookingReschedule);
        });
        function toJSDate( dateTime ) {
            //2019-02-09T16:15:00
            var dateTime = dateTime.split("T");//dateTime[0] = date, dateTime[1] = time
            
            var date = dateTime[0].split("-");
            var time = dateTime[1].split(":");
           
            return new Date(date[0], (date[1]-1), date[2], time[0], time[1], 0, 0);
            
        }
        function closeContainerMessage(){
            isReschedule = false;
            bookingReschedule.Id = '';
            $('#containerMessage').addClass('slds-hide');
        }
        function isDateTimeInFuture(bookingDateTime){
            var now = new Date();
            var originalDate =  toJSDate(bookingDateTime); //toJSDate(originalTime);
            isDateBetween24Hours(bookingDateTime);
            
            return (Date.parse(now) < Date.parse(originalDate ));
        }
        function isDateBetween24Hours(bookingDateTime){
            var bookingDate = toJSDate(bookingDateTime);
            var now = new Date();
            var timeDiff = Math.abs(bookingDate.getTime() - now.getTime());
            console.log('time diff',timeDiff/ (1000 * 3600) );
            timeDiff = timeDiff/ (1000 * 3600);
            // days difference
            return timeDiff;
        }
        $('#cancelBookingWithReason').click(function(){
            
            var bookingId = $(this).attr("data-id");
            var bookingCancelTime = $(this).attr("data-time");
            var cancelReasonValue = $('#cancelReason').val();
            var bookingType = $(this).attr("data-type");
            console.log(bookingId, bookingCancelTime, cancelReasonValue, bookingType);
            if(bookingId && bookingCancelTime && bookingType){
                if(bookingCancelTime < 24 && (bookingType == 'Regular' || bookingType == 'Make-up') && cancelReasonValue){
                    console.log('Other popup should open');
                    $('.cancellationReasonPopup').addClass('slds-hide');
                    $('#cancelBookingWithMakeupBtn').attr({'data-id':bookingId, 'data-reason':cancelReasonValue });
                    $('#no-makeup').attr({'data-id':bookingId, 'data-reason':cancelReasonValue });
                    Visualforce.remoting.Manager.invokeAction(
                        '{!$RemoteAction.AureusCalendarController.getPickListValues}',
                        'Booking__c', 'Makeup_Reason__c', 
                        function(result, event){
                            console.log('result', result);
                            if(result){
                                $('#cancelReason').empty();
                                
                                var cancelReason = '<option value="">Select Make Up Credit Reason</option>';
                                $(result).each(function(index, value){
                                    cancelReason += '<option value="'+value+'">'+value+'</option>'
                                });                                                                      
                                console.log('result ', result);
                                $('#cancelReason').append(cancelReason); 
                                $('.reasonSection').addClass('slds-hide'); 
                                $('#reasonPopupText').html('Make Up Credit for Booking');
                                $('.notMakeupHoursShow').addClass('slds-hide');
                                $('.reasonText').html('Reason For Make up Credit:');
                                $('#cancelBookingWithReason').addClass('slds-hide');
                                
                                $('.makeupTitle').removeClass('slds-hide');
                                $('.close-popup').addClass('slds-hide');
                                
                                $('.cancellationReasonPopup').removeClass('slds-hide');
                                
                            }
                        }, 
                        {escape: true}
                    );
                }else if(cancelReasonValue){
                    console.log('In scenario');
                    Visualforce.remoting.Manager.invokeAction(
                        '{!$RemoteAction.AureusCalendarController.cancelBooking}',
                        bookingId, $('#cancelReason').val(), '', '', caseId, 
                        function(result, event){
                            console.log(result);
                            if(result.caseId){
                                console.log('result.caseId '+result.caseId);
                                redirectToCaseRecord(result.caseId);    
                            }
                            /*$('.cancellationReasonPopup').addClass('slds-hide');
                            var b = $('#calendar').fullCalendar('getDate');
                            var bookDate = [b.format('YYYY-MM-DD')];
                            teacher = $(".teachers").val();
                            var calView = $('#calendar').fullCalendar('getView').name;
                            
                            var calendarDates = isWeekDay();
                            if(calView == 'agendaTwoDay'){
                                initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                            }else{
                                initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                            }*/
                            /*$('.confirmModal').removeClass('slds-hide');
                            $('#confirmBody').html('Do you want to send an email?');
                            $('#confirmHeader').html('Email Confirmation');
                            $('#confirmModalYes').attr('data-origin','email');
                            $('#confirmModalNo').attr('data-origin','email');*/
                        }, 
                        {escape: true}
                    );
                }else{
                    console.log('Please select the reason');
                    $('#errorMsgReason').html('Please select the reason');
                }
                
            }
            
        });
        
        function studentFocusOut(){
            $('#studentSelectContainer').removeClass('slds-is-open');
            $('#studentSelectContainer').attr('aria-expanded', 'false');
            $('#studentSearchList').empty();
        }
        
        $('#cancelBookingWithMakeupBtn').click(function(){
            var bookingId = $(this).attr('data-id');
            var cancelReasonValue = $(this).attr('data-reason');
            var makeupReason = $('#cancelReason').val();
            var makeupCreditRemark = $('#remarkForCancellation').val();
            console.log(bookingId, cancelReasonValue);
            if(bookingId){ //&& cancelReasonValue
                if(makeupReason && (makeupReason == 'Other' || makeupReason == 'Admin/CM Exception')){
                    if(makeupCreditRemark){
                        Visualforce.remoting.Manager.invokeAction(
                            '{!$RemoteAction.AureusCalendarController.cancelBooking}',
                            bookingId, cancelReasonValue, makeupReason, makeupCreditRemark, caseId, 
                            function(result, event){
                                if(result.caseId){
                                    redirectToCaseRecord(result.caseId);
                                }
                            }, 
                            {escape: true}
                        );
                    }else{
                        $('#errorMsgRemark').html('Makeup Remark cannot be empty for '+makeupReason);
                        console.log('Please Fill Make up Credit hour remark...');
                    }
                }else if(makeupReason){
                    Visualforce.remoting.Manager.invokeAction(
                        '{!$RemoteAction.AureusCalendarController.cancelBooking}',
                        bookingId, cancelReasonValue, makeupReason, '', caseId, 
                        function(result, event){
                            if(result.caseId){
                                redirectToCaseRecord(result.caseId);
                            }
                            /*$('.cancellationReasonPopup').addClass('slds-hide');
                            var b = $('#calendar').fullCalendar('getDate');
                            var bookDate = [b.format('YYYY-MM-DD')];
                            teacher = $(".teachers").val();
                            var calView = $('#calendar').fullCalendar('getView').name;
                            
                            var calendarDates = isWeekDay();
                            if(calView == 'agendaTwoDay'){
                                initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                            }else{
                                initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                            }*/
                            /*$('.confirmModal').removeClass('slds-hide');
                            $('#confirmBody').html('Do you want to send an email?');
                            $('#confirmHeader').html('Email Confirmation');
                            $('#confirmModalYes').attr('data-origin','email');
                            $('#confirmModalNo').attr('data-origin','email');*/
                        }, 
                        {escape: true}
                    );
                }else{
                    $('#errorMsgReason').html('Please select the reason');
                    console.log('Please Select Make up Credit Reason...');
                }
            }else{
                console.log('Some Error Ocurred Please try again...');
            }
        });
        
       
        $('#no-makeup').click(function(){
            var bookingId = $(this).attr('data-id');
            var cancelReasonValue = $(this).attr('data-reason');
            if(bookingId   ){ //&& cancelReasonValue
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AureusCalendarController.cancelBooking}',
                    bookingId, cancelReasonValue, 'NoMakeUpForToday', '', caseId, 
                    function(result, event){
                        if(result.caseId){
                            redirectToCaseRecord(result.caseId);
                        }
                        
                        /*$('.cancellationReasonPopup').addClass('slds-hide');
                        var b = $('#calendar').fullCalendar('getDate');
                        var bookDate = [b.format('YYYY-MM-DD')];
                        teacher = $(".teachers").val();
                        var calView = $('#calendar').fullCalendar('getView').name;
                        
                        var calendarDates = isWeekDay();
                        if(calView == 'agendaTwoDay'){
                            initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                        }else{
                            initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                        }*/
                        /*$('.confirmModal').removeClass('slds-hide');
                        $('#confirmBody').html('Do you want to send an email?');
                        $('#confirmHeader').html('Email Confirmation');
                        $('#confirmModalYes').attr('data-origin','email');
                        $('#confirmModalNo').attr('data-origin','email');*/
                    }, 
                    {escape: true}
                );
            }
        });
        
        function rescheduleTrialBookingfunc(bookingId, dateOfBooking){
            console.log('bookingId', bookingId);
            console.log('dateOfBooking', dateOfBooking);
            $('#rescheduleTrialBooking').removeAttr('data-id');
            $('#rescheduleTrialBooking').removeAttr('data-date');
            $('#trialBookingClickModal').addClass('slds-hide');
            if(bookingId && dateOfBooking){
                initEvents(bookingId , dateOfBooking);
            }
        }
        
        $('#yes-makeup').click(function(){
            
            $('.makeupTitle').addClass('slds-hide');
            $('.reasonSection').removeClass('slds-hide');
            $('.makeupCredit').removeClass('slds-hide');
            $('#cancelBookingWithMakeupBtn').removeClass('slds-hide');
        });
        
        $('#confirmModalYes').click(function(){
            var origin = $(this).attr('data-origin');
            var bookingId = $(this).attr('data-bookingid');
            
            if(origin == 'email'){
                $('.sendEmail').attr('data-bookingId', bookingId);
                $('.confirmModal').addClass('slds-hide');
                $('.sendEmail').removeClass('slds-hide');
                var b = $('#calendar').fullCalendar('getDate');
                var bookDate = [b.format('YYYY-MM-DD')];
                teacher = $(".teachers").val();
                var calView = $('#calendar').fullCalendar('getView').name;
                
                var calendarDates = isWeekDay();
                if(calView == 'agendaTwoDay'){
                    initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                }else{
                    initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                }
            }else if(origin == 'eventdrop'){
                $('.confirmModal').addClass('slds-hide');
                
                updateBooking($(this).attr('data-bookingid'), $(this).attr('data-starttime'), $(this).attr('data-endtime'), $(this).attr('data-resourceid'), $(this).attr('data-isplaceholder'));
            }else if(origin == 'bookingComplete' || origin == 'bookingNoShow'){
                completedOrNoShow($(this).attr('data-id'), $(this).attr('data-type'), $(this).attr('data-status'));
                
            }else if(origin == 'cancel'){
                $('.confirmModal').addClass('slds-hide');
                bookingId = $('#confirmModalYes').attr('data-id');
                console.log('bookingId',bookingId);
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AureusCalendarController.cancelBooking}',
                    bookingId, '', '', '', 
                    function(result, event){
                        console.log('result',result);
                        if(result.caseId){
                            redirectToCaseRecord(result.caseId);
                        }
                        
                        /*$('.confirmModal').removeClass('slds-hide');
                        var b = $('#calendar').fullCalendar('getDate');
                        var bookDate = [b.format('YYYY-MM-DD')];
                        teacher = $(".teachers").val();
                        var calView = $('#calendar').fullCalendar('getView').name;
                        
                        var calendarDates = isWeekDay();
                        if(calView == 'agendaTwoDay'){
                            initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                        }else{
                            initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                        }*/
                        /*$('#confirmBody').html('Do you want to send an email?');
                        $('#confirmHeader').html('Email Confirmation');
                        $('#confirmModalYes').attr('data-origin','email');
                        $('#confirmModalNo').attr('data-origin','email');*/
                    }, 
                    {escape: true}
                );
            }
        });
        $('#confirmModalNo').click(function(){
            var origin = $(this).attr('data-origin');
            if(origin == 'email'){
                $('.confirmModal').addClass('slds-hide');
                var b = $('#calendar').fullCalendar('getDate');
                var bookDate = [b.format('YYYY-MM-DD')];
                teacher = $(".teachers").val();
                var calView = $('#calendar').fullCalendar('getView').name;
                
                var calendarDates = isWeekDay();
                if(calView == 'agendaTwoDay'){
                    initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                }else{
                    initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                }
            }else if(origin == 'reschedule'){
                bookingReschedule.Id = '';
                bookingReschedule.Type = '';
                bookingReschedule.resource = '';
                bookingReschedule.date = '';
                isReschedule = false;
                $('#containerMessage').addClass('slds-hide');
            }
        });
        function initResources(centerId, teacherId, resourceId, dateOfAppointment, view, instrument){
            console.log('TeacherId in initresource',teacherId);
            //console.log(centerId, teacherId, resourceId, dateOfAppointment, view, instrument);
            $('#statusOnPage').show();
            var listOfResource = [];
            var listOfEvents = [];
            var minTime;
            var maxTime;
            console.log('instrument',instrument);
            console.log('dateOfAppointment',dateOfAppointment);
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getCalendarData}',
                centerId, teacherId, resourceId, dateOfAppointment, instrument,
                function(result, event){
                    var msg = '';
                    if (event.status) {
                        
                        if(result != '' && result != null && result != 'undefined'){
                            $('#instruments').empty();
                            var calendarResult = JSON.parse(result.replace(/(&quot\;)/g,"\""));
                            //console.log('JSON String',result.replace(/(&quot\;)/g,"\""));
                            //console.log(calendarResult);
                            listOfResource = calendarResult.listOfResources;
                            listOfEvents = calendarResult.listOfEvents;
                            teacherWorkingHours = calendarResult.teachersWorkingHours;
                            eventsOfCalendar = calendarResult.listOfEvents;
                            getInstruments(listOfResource);                            
                            if(calendarResult.minTime != '' && calendarResult.minTime != null && calendarResult.minTime != 'undefined'
                               && calendarResult.maxTime != '' && calendarResult.maxTime != null && calendarResult.maxTime != 'undefined'){
                                console.log('calendarResult.minTime'+calendarResult.minTime);
                                minTime = calendarResult.minTime;
                                maxTime = calendarResult.maxTime;
                                
                                $('#calendar').html('');
                                
                                initCalendar(listOfResource,listOfEvents,dateOfAppointment,minTime,maxTime,view);
                                
                            }else{
                                msg = 'TODAY IS OFF';
                                $('#calendar').html(msg);
                            }
                        }else{
                            msg = 'TODAY IS OFF';
                            $('#calendar').html(msg);
                        }
                    } else if (event.type === 'exception') {
                        document.getElementById("responseErrors").innerHTML = 
                            event.message + "<br/>\n<pre>" + event.where + "</pre>";
                    } else {
                        document.getElementById("responseErrors").innerHTML = event.message;
                    }
                }, 
                {escape: true}
            );
        }
        
        
        function getInstruments(Ids){
            
            var teacherIds = [];
            $(Ids).each(function(index, val){
                teacherIds.push(val.id);
            });
            console.log('teacherIds ',teacherIds);
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getInstruments}',
                teacherIds,
                function(result, event){
                    if (event.status) {
                        console.log('success');
                        console.log('result ',result);
                        var instrumentsOption = '<option value="">All</option>';
                        $(result).each(function(index, value){
                            instrumentsOption += '<option value="'+value+'">'+value+'</option>';
                        });
                        $('#instruments').append(instrumentsOption);
                        $('#instruments').children().each(function(index, value){
                            if($(this).val() == filter.instrument){
                                $('#instruments').val(filter.instrument);
                            }
                        });
                        $('#statusOnPage').hide();
                    }
                }
            );
        }
        function initEvents(eventId, eventDate){
            console.log('caseId ', caseId);
            resetTabs();
            refreshEditAppointment();
            $('.editBooking').removeAttr('disabled');
            $('#cancelBooking').removeAttr('disabled');
            $('#statusLabelOnEdit').text('');
            $('#noShowBooking').removeAttr('disabled');
            $('#completeBooking').removeAttr('disabled');
            console.log('eventDate',eventDate);
            $('#submitUpgradeRequest').attr('data-date', eventDate);
            $('#errorMsgReason').html('');
            $('#errorMsgRemark').html('');
            $('.bookingStatus').empty();
            console.log('eventId ',eventId);
            $('.makeupTitle').addClass('slds-hide');
            $('#reasonPopupText').html('Cancel appointment');
            $('.notMakeupHoursShow').removeClass('slds-hide');
            $('.reasonText').html('Reason for Cancellation');
            $('.reasonSection').removeClass('slds-hide');
            $('.makeupCredit').addClass('slds-hide');
            $('.close-popup').removeClass('slds-hide');
            $('#cancelBookingWithReason').removeClass('slds-hide');
            $('#cancelBookingWithMakeupBtn').addClass('slds-hide');
            $('.studentImg').removeAttr('src');
            $('#selectStudio').removeClass('slds-hide');
            $('#selectTeacher').removeClass('slds-hide');
            $('#advanceDetailsSection').addClass('slds-hide');
            $('#enrolmentDetailSection').addClass('slds-hide');
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getEventDetails}',
                eventId,
                function(result, event){
                    var msg = '';
                    if (event.status) {
                        if(result != '' && result != null && result != 'undefined'){
                            var eventResult = JSON.parse(result.replace(/(&quot\;)/g,"\""));
                            $('#completeBooking').attr({'data-id':eventResult.Id, 'data-type':eventResult.type, 'data-status':'Completed'});
                            $('#noShowBooking').attr({'data-id':eventResult.Id, 'data-type':eventResult.type, 'data-status':'No-show'});
                            if(eventResult.status == 'Completed' || eventResult.status == 'No-show'){
                                $('#completeBooking').attr('disabled','true');
                                $('#noShowBooking').attr('disabled','true');
                                $('#cancelBooking').attr('disabled','true');
                            }
                            console.log('eventResult ',eventResult);
                            if(isDateTimeInFuture(eventDate)){
                                $('#completeBooking').attr('disabled','true');
                                $('#noShowBooking').attr('disabled','true');
                            }else{
                                $('#cancelBooking').attr('disabled','true');
                                $('.editBooking').attr('disabled','true');
                            }
                            $('#statusIconOnEdit').empty();
                            $('#statusLabelOnEdit').text(eventResult.status);
                            if(eventResult.status == 'Scheduled'){
                                $('#statusIconOnEdit').append('<svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#clock')}" /></svg>');
                            }else if(eventResult.status == 'Pending'){
                                $('#statusIconOnEdit').append('<svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#reminder')}" /></svg>');
                            }else if(eventResult.status == 'Completed'){
                                $('#statusIconOnEdit').append('<svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#check')}" /></svg>');
                            }else if(eventResult.status == 'No-show'){
                                $('#statusIconOnEdit').append('<svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}" /></svg>');
                            }else if(eventResult.status == 'Canceled'){
                                $('#statusIconOnEdit').append('<svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#clear')}" /></svg>');
                            }
                            
                            if(eventResult.type == 'Trial'){
                                $('#enrolmentDetailSection').removeClass('slds-hide');
                                $('#sendTrialEnrollmentLink').attr({'data-id': eventId});
                                //$('#completeTrialEnrollmentLink').attr({'href': 'apex/trialtoEnrolmentprocess?id='+eventId, 'target': '_blank'});
                        
                            }
                            
                            $('#editBooking').attr('data-id', eventResult.Id);
                            $('.editBooking').attr({'data-id': eventResult.Id, 'data-type': eventResult.type, 'data-individual': eventResult.Individual});
                            console.log('data-individual', eventResult.Individual);
                            
                            //console.log('result ', eventResult );
                            if(!eventResult.studentFirstName){
                                eventResult.studentFirstName = '';
                            }
                            if(!eventResult.studentLastName){
                                eventResult.studentLastName = '';
                            }
                            if(!eventResult.parentFirstName){
                                eventResult.parentFirstName = '';
                            }
                            if(!eventResult.parentLastName){
                                eventResult.parentLastName = '';
                            }
                            $('.editCustomerDetails').attr('data-id', eventResult.studentId);
                            if(eventResult.parentId){
                                $('.editCustomerDetails').attr('data-parentId', eventResult.parentId);
                            }else{
                                $('.editCustomerDetails').attr('data-parentId', eventResult.studentId);
                            }
                            
                            $('#cancelBooking').attr('data-id',eventResult.Id);
                            $('#cancelBooking').attr('data-date',eventDate);
                            $('#cancelBooking').attr('data-type',eventResult.type);
                            $('#lesson').text(eventResult.service);
                            $('#teacherName').text(eventResult.staffMember);
                            $('#teacherNameEditPopup').text(eventResult.staffMember);
                            $('#teacherNameEditPopup').attr('href','/'+eventResult.staffMemberId);
                            $('#resource').text(eventResult.resource);
                            $('#dateAndTime').text(eventResult.dateAndTime);
                            $('.sendEmail').attr('data-bookingId', eventResult.Id);
                            if(eventResult.parentId){
                                $('.sendEmail').attr('data-parentId', eventResult.parentId);
                            }else{
                                $('.sendEmail').attr('data-parentId', eventResult.studentId);
                                
                            }
                            
                            var dateTime = eventResult.dateAndTime;
                            var res;
                            if(dateTime){
                                res =  dateTime.split("at"); 
                                $('#date').text(res[0]);
                                $('#time').text(res[1]);
                            }
                            
                            if(eventResult.processStatus == 'Pending'){
                                $('#advanceDetailsSection').removeClass('slds-hide');
                                $('#processTypeEdit').html(eventResult.processType);
                                $('#newPackageEdit').attr('href', '/'+eventResult.newPackage);
                                $('#newPackageEdit').html(eventResult.newPackageName);
                                $('#advanceActionRequestedBy').html(eventResult.requestedBy);
                                if(eventResult.processRequestDate){
                                    $('#requestDateEdit').html(convertDateToMoment(eventResult.processRequestDate));
                                }
                                
                                if(eventResult.processEffectiveDate){
                                    $('#effectiveDateEdit').html(convertDateToMoment(eventResult.processEffectiveDate));
                                }
                                
                                if(eventResult.noticeStartDate){
                                    $('#noticeStartEdit').html(convertDateToMoment(eventResult.noticeStartDate));
                                }
                                
                                if(eventResult.noticeEndDate){
                                    $('#noticeEndEdit').html(convertDateToMoment(eventResult.noticeEndDate));
                                }
                                
                                
                            }
                            $('#date').text(convertDateToMoment(eventResult.eventDateTime.split('T')[0]));
                            $('.studentImg').attr('src','/servlet/servlet.FileDownload?file='+eventResult.teacherAttachmentId+'');
                            $('#duration').text(eventResult.duration);
                            $('#price').text(eventResult.price);
                            $('#totalPrice').text('$'+eventResult.price);
                            
                            $('#lessonOnCancel').text(eventResult.service);
                            $('#teacherOnCancel').text(eventResult.staffMember);
                            $('#dateAndTimeOnCancel').text(convertDateToMoment(eventResult.eventDateTime.split('T')[0]) +' '+convertTimeToMoment(eventResult.eventDateTime.split('T')[1].split(':')[0], eventResult.eventDateTime.split('T')[1].split(':')[1]));
                            
                            $('#name').text(eventResult.studentFirstName+' '+eventResult.studentLastName+' - '+eventResult.parentFirstName +' '+eventResult.parentLastName);
                            //$('#name1').text(eventResult.studentFirstName+' '+eventResult.studentLastName+' - '+eventResult.parentFirstName +' '+eventResult.parentLastName);                                
                            $('#name1').text(eventResult.studentFirstName+' '+eventResult.studentLastName);
                            $('#name1').attr('href', '/'+eventResult.studentId);
                            $('#parentname1').text(eventResult.parentFirstName +' '+eventResult.parentLastName);
                            $('#parentname1').attr('href', '/'+eventResult.parentId);
                            $('.popupDetails').removeClass('slds-hide');
                            if(eventResult.rType == 'Lesson'){
                                $('#selectStudio').addClass('slds-hide');
                            }else if(eventResult.rType == 'Facility'){
                                $('#selectTeacher').addClass('slds-hide');
                            }
                            
                            $('#fname').val(eventResult.studentFirstName);
                            $('#lname').val(eventResult.studentLastName);
                            $('#telephone').val(eventResult.parentPhone);
                            $('#parentsms').val(eventResult.parentMobile);
                            $('#parentEmail').val(eventResult.parentEmail);
                            
                            $('#parentfname').val(eventResult.parentFirstName);
                            $('#parentlname').val(eventResult.parentLastName);
                            $('#popoverTitle').text(eventResult.studentFirstName+ ' '+eventResult.studentLastName + ' - ' +eventResult.parentFirstName+ ' '+eventResult.parentLastName);
                            
                            $('#phone').text(eventResult.parentMobile);
      //.html('<a href="tel:01234567890">01234 567 890</a>')    //text('aaaa'+eventResult.parentMobile);
                            //$('#phone').text(eventResult.parentMobile);
                            //$('#phone').attr('href', 'tel:'+eventResult.parentMobile);
                            
                            $('#email').text(eventResult.parentEmail);
                            
                            $('#studentName').text(eventResult.studentFirstName+ ' '+eventResult.studentLastName);
                            $('#parentName').text(eventResult.parentFirstName+ ' '+eventResult.parentLastName);
                            $('#parentMobile').text(eventResult.parentMobile);
                            $('#parentPhone').text(eventResult.parentPhone);
                            $('#parentEmail').text(eventResult.parentEmail);
                            //console.log(eventResult.servicePackagName);
                            
                            $('#servicePackagName').text(eventResult.service);
                            $('#serviceStaff').text(eventResult.staffMember);
                            $('#serviceResource').text(eventResult.resource);
                            $('#serviceTime').text(eventResult.timeOfBooking);
                            
                            $('#serviceDuration').text(eventResult.duration);
                            
                            $('#servicePrice').text(eventResult.price);
                            
                            $('.editDetails').removeClass('slds-hide'); 
                            /*if(eventResult.subscriptionLineItemList && eventResult.subscriptionLineItemList.length > 0){
                                    $('#serviceBody').html('');
                                    var j = 1;
                                    for(var i = 0; i < eventResult.subscriptionLineItemList.length; i++){
                                        $('#serviceBody').append('<tr class="slds-hint-parent" style="background: #f3ecec;"><th id="services">Service '+ j +' </th><td><div class="slds-truncate" id="servicePackagName">'+ eventResult.subscriptionLineItemList[i].Plan_Package__r.Name +'</div></td><td><div class="slds-truncate" id="serviceStaff">'+ eventResult.subscriptionLineItemList[i].Enrolment__r.Teacher__r.Name +'</div></td><td><div class="slds-truncate" id="serviceResource">No Resource</div></td><td><div class="slds-truncate" id="serviceTime"></div></td><td><div class="slds-truncate" id="serviceDuration"></div></td><td><div class="slds-truncate" id="servicePrice">'+ eventResult.subscriptionLineItemList[i].Amount__c +'</div></td></tr>');
                                        j++;
                                    }
                                }*/
                            console.log('Notes ',eventResult.contentNoteList);
                            if(eventResult.contentNoteList && eventResult.contentNoteList.length > 0){
                                $('#bookingNotesTBody').html('');
                                for(var i = 0; i < eventResult.contentNoteList.length; i++){
                                    var title = eventResult.contentNoteList[i].Title;
                                    var body = eventResult.contentNoteList[i].TextPreview;
                                    var dateTime = new Date(eventResult.contentNoteList[i].CreatedDate);
                                    createdDate = moment(dateTime).format("D MMM YYYY");
                                    createdTime = moment(dateTime).format("HH:mmA");
                                    ownerName = eventResult.contentNoteList[i].Owner.Name;
                                    
                                    $('#bookingNotesTBody').append('<tr class="slds-line-height_reset"> <th class="" scope="col"> <div class="slds-truncate">Title</div> </th> <th class="" scope="col"> <div class="slds-truncate">Body</div> </th> <th class="" scope="col"> <div class="slds-truncate">Date-Time</div> </th> <th class="" scope="col"> <div class="slds-truncate">Created By</div> </th> </tr> </thead> <tbody> <tr class="slds-hint-parent"> <td scope="row"> <div class="slds-truncate">'+ title +'</div> </td> <td scope="row"> <div class="slds-truncate">'+ body +'</div> </td> <td scope="row"> <div class="slds-truncate">'+ createdDate +' at '+createdTime +'</div> </td> <td scope="row"> <div class="slds-truncate">' +ownerName+ '</div> </td> </tr>');
                                }
                            }else{
                                $('#bookingNotesTBody').html('');
                            }
                            
                            if(eventResult.bookingHistoryList.length > 0){
                                $('#HistoryCount').html(eventResult.bookingHistoryList.length);
                                $('#bookingHistory').html('');
                                for(var i = 0; i < eventResult.bookingHistoryList.length; i++){
                                    
                                    var description = eventResult.bookingHistoryList[i].Description;
                                    var historyDateTime = eventResult.bookingHistoryList[i].DateOfHistory;
                                    var historyBy = eventResult.bookingHistoryList[i].HistoryBy;
                                    if(historyBy){
                                        $('#bookingHistory').append('<div class="eventHistory"><h1><span class="slds-page-header__title slds-truncate headerTitle"> ' +historyDateTime+ '<span class="historyBy"> - by '+ historyBy +'</span></span></h1> '+description+ ' </div>');
                                    }else{
                                        $('#bookingHistory').append('<div class="eventHistory"><h1><span class="slds-page-header__title slds-truncate headerTitle"> ' +historyDateTime+ ' </span></h1> '+description+ ' </div>');
                                    }
                                }
                            }else{
                                $('#HistoryCount').html(eventResult.bookingHistoryList.length);
                                $('#bookingHistory').html('');
                            }
                        }
                    } else if (event.type === 'exception') {
                        document.getElementById("responseErrors").innerHTML = 
                            event.message + "<br/>\n<pre>" + event.where + "</pre>";
                    } else {
                        document.getElementById("responseErrors").innerHTML = event.message;
                    }
                }, 
                {escape: true}
            );
        }
        function saveBookingNote(){
            var title = $('#title').val();
            var note = $('#note').val();
            
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.saveBookingNote}',
                title,note,eventId,
                function(result, event){
                    if (event.status) {
                        if(result != '' && result != null && result != 'undefined'){
                            var bookingNoteResult = JSON.parse(result.replace(/(&quot\;)/g,"\""));
                            console.log('Result = ', bookingNoteResult);
                            if(bookingNoteResult.title){
                                $('#title').val('');
                                $('#note').val('');
                                
                                var title = bookingNoteResult.title;
                                var body = bookingNoteResult.Body;
                                var dateTime = new Date(bookingNoteResult.createdDate);
                                createdDate = moment(dateTime).format("D MMM YYYY");
                                createdTime = moment(dateTime).format("HH:mmA");
                                ownerName = bookingNoteResult.CreatedBy;
                                
                                $('#bookingNotesTBody').append('<tr class="slds-line-height_reset"> <th class="" scope="col"> <div class="slds-truncate">Title</div> </th> <th class="" scope="col"> <div class="slds-truncate">Body</div> </th> <th class="" scope="col"> <div class="slds-truncate">Date-Time</div> </th> <th class="" scope="col"> <div class="slds-truncate">Created By</div> </th> </tr> </thead> <tbody> <tr class="slds-hint-parent"> <td scope="row"> <div class="slds-truncate">'+ title +'</div> </td> <td scope="row"> <div class="slds-truncate">'+ body +'</div> </td> <td scope="row"> <div class="slds-truncate">'+ createdDate +' at '+createdTime +'</div> </td> <td scope="row"> <div class="slds-truncate">' +ownerName+ '</div> </td> </tr>');
                                
                            }
                        }
                    } else if (event.type === 'exception') {
                        document.getElementById("responseErrors").innerHTML = 
                            event.message + "<br/>\n<pre>" + event.where + "</pre>";
                    } else {
                        document.getElementById("responseErrors").innerHTML = event.message;
                    }
                }, 
                {escape: true}
            );
            $('.addNotes').addClass('slds-hide');
            // sendBooingNoteToController(title,note,eventId);
        }
        
        function initCalendar(listOfResource,listOfEvents,dateOfAppointment,minTime,maxTime,view){
            $('#confirmModalNo').attr('onclick', "$('.confirmModal').addClass('slds-hide');return false;");
            $('#cancelChanges').attr('onclick','cancelRescheduling();return false;');
            $('#closeRescheduleIconButton').attr('onclick', 'cancelRescheduling();return false;');
            $('#calendar').fullCalendar('destroy');
            $('#calendar').fullCalendar({
                defaultView: view,
                groupByDateAndResource: true,
                schedulerLicenseKey: 'GPL-My-Project-Is-Open-Source',
                editable: true,
                selectable: true,
                defaultDate: dateOfAppointment[0],
                eventLimit: true,
                minTime: minTime,
                maxTime: maxTime,
                
                slotDuration: '00:15:00',
                slotLabelFormat: 'hh:mm a',  //'h(:mm) a',
                slotMinutes: 30,
                titleFormat: 'ddd, MMM DD YYYY',
                header: {
                    left: 'prev,myCustomButton,next today',
                    center: 'title',
                    right: 'agendaDay,agendaTwoDay'
                },
                customButtons:{
                    myCustomButton:{
                        text: new Date().toJSON().slice(0,10).replace(/-/g,'/'),
                        click: function(){
                        }
                    }
                },
                views: {
                    agendaTwoDay: {
                        type: 'agenda',
                        duration: { week: 1 },
                        // groupByResource: true
                        columnFormat: 'ddd D MMM',
                    },
                    week: {
                        titleFormat: 'D MMMM YYYY',
                        titleRangeSeparator: ' to ',
                    }
                },
                allDaySlot: false,
                resources: listOfResource,
                events: listOfEvents,
                timeFormat: 'hh:mm a',
                eventAfterAllRender: function( view, element ){
                    console.log('viewRender eventAfterAllRender');
                     
                    setTimeout(function(){
                           var calView = $('#calendar').fullCalendar('getView').name;
                           if(calView == 'agendaTwoDay'){
                               showTimeOnResourceColumn(7,'week');
                           }else{
                               showTimeOnResourceColumn(listOfResource.length,'day');
                           }
                        },40);
                        $('.fc-slats tr').each(function(){
                            var time = $(this).attr('data-time');
                            if(time && time.includes('00:00')){
                                $(this).children('td:nth-child(2)').addClass("black");
                            }
                            
                            if(listOfResource.length > 1){
                                var width = '';
                                if(listOfResource.length > 6){
                                    width = (listOfResource.length * 15);
                                    $('.fc-view-container').css({'width': width+'vw', 'overflow-x': 'visible'});
                                }
                            }
                        });
                },
                viewRender: function( view, element ){
                    console.log('viewRender');
                    $('.fc-slats tr').each(function(){
                        var time = $(this).attr('data-time');
                        if(time && time.includes('00:00')){
                            //console.log($(this).children('td'));
                            $(this).children('td:nth-child(2)').addClass("black");
                        }
                        
                        if(listOfResource.length > 1){
                            var width = '';
                            setTimeout(function(){
                                if(listOfResource.length > 6){
                                    width = (listOfResource.length * 15);
                                    $('.fc-view-container').css({'width': width+'vw', 'overflow-x': 'visible'});
                                }
                            }, 30);
                        }
                        
                        /*var calView = $('#calendar').fullCalendar('getView').name;
                        if(calView == 'agendaTwoDay'){
                            showTimeOnResourceColumn(7,'week');
                        }else{
                            showTimeOnResourceColumn(listOfResource.length,'day');
                        }*/
                    });
                },
                eventResize: function(event, delta, revertFunc) {
                    revertFunc();
                },
                dayClick: function(date, jsEvent, view,resourceObj) {
                   /* bookingReschedule.resource = resourceObj.id;
                    bookingReschedule.date = date.format();
                    
                    if(bookingReschedule.Id && bookingReschedule.Type == 'Regular' && bookingReschedule.Individual == 'false'){
                        console.log('In If Condition');
                        isReschedule = false;
                        $('#confirmModalYes').addClass('slds-hide');
                        $('#confirmModalNo').html('Cancel');
                        $('#confirmModalNo').attr('data-origin', 'reschedule');
                        $('#confirmHeader').html('Recurring event');
                        $('#confirmHeader').parent().addClass('slds-text-align_left');
                        $('#confirmBody').addClass('slds-text-align_center');
                        $('#confirmBody').html('<p>Would you like to apply this change to this event only,<br/>or the current and future events in the series?</p><div><button class="slds-button slds-m-around_small slds-p-horizontal_large" style="background: #00b3f0;color:#fff;" id="thisReschedule" onclick="rescheduleThisOnly();return false;">This only</button><button class="slds-button slds-m-around_small slds-p-horizontal_large" style="background: #00b3f0;color:#fff;" id="thisAndFutureReschedule" onclick="rescheduleFutureAlso();return false;">This and future</button></div>');
                        $('#confirmModal').removeClass('slds-hide');
                    }else if(bookingReschedule.Id){
                        console.log('In Else Condition...', bookingReschedule);
                        bookingReschedule.isRecurrence = 'false';
                        var startTime = date.format();
                        var endTime = toJSDate( date.format());
                        var milleseconds = new Date(endTime.getTime() + (30 * 60 * 1000));
                        milleseconds = new Date(milleseconds.getTime() - (milleseconds.getTimezoneOffset() * 60 * 1000));
                        if(milleseconds){
                            milleseconds = milleseconds.toJSON().split('.')[0];
                        }
                        if(isDateTimeInFuture(date.format()) && isEventInTeacherWorkingHour(teacherWorkingHours, startTime, milleseconds, bookingReschedule.resource)){
                            reschedule();
                        }
                        
                    }else if(!bookingReschedule.Id){
                        var startTime = date.format();
                        var endTime = toJSDate( date.format());
                        var milleseconds = new Date(endTime.getTime() + (30 * 60 * 1000));
                        milleseconds = new Date(milleseconds.getTime() - (milleseconds.getTimezoneOffset() * 60 * 1000));
                        if(milleseconds){
                            milleseconds = milleseconds.toJSON().split('.')[0];
                        }
                        console.log(teacherWorkingHours, startTime, milleseconds  , bookingReschedule.resource);
                        if(isDateTimeInFuture(date.format()) && isEventInTeacherWorkingHour(teacherWorkingHours, startTime, milleseconds, bookingReschedule.resource)){
                            $('#addNewBooking').attr({'data-centerId' : filter.center, 'data-teacherId' : resourceObj.id, 'data-date' : startTime});
                            $('#addBusyTime').attr({'data-centerId' : filter.center, 'data-teacherId' : resourceObj.id, 'data-date' : startTime});
                            $('#newBookingHeader').html(convertTimeToMoment(startTime.split('T')[1].split(':')[0], startTime.split('T')[1].split(':')[1]));
                            $('#newBookingModal').removeClass('slds-hide');
                            
                        }else{
                            console.log('In Not Day Click');
                        }
                    }
                    */
                    /*if(isReschedule){
                            updateBooking(bookingReschedule.Id, bookingReschedule.date, '', bookingReschedule.resource, false);
                        }*/
                },
                eventRender: function(event, element, view) {
                    if(event.className.includes('bookingNotAvailable')){
                        element.find('.fc-time').remove();
                    }else{
                        var spantext = element.find('.fc-time').children('span').text();
                        if(spantext){
                            spantext = spantext.split('-')[0];
                            element.find('.fc-time').children('span').text(spantext);
                        }
                    }
                    if(event.Type == 'Busy'){
                        element.find('.fc-title').css({"text-overflow":"ellipsis","white-space":"nowrap"});
                        element.attr('title', event.title);
                        //event.title = '';
                    }
                    
                    if(element.find(".fc-content").text()){
                        element.find(".fc-content").append('<div id="eventIcons"></div>');
                        if(event.Notes > 0){
                            element.find(".fc-content #eventIcons").append("<span class='closeon' id='sms'><a href='javascript:void(0);'><svg class='slds-button__icon slds-icon_xx-small' aria-hidden='true'><use xlink:href='{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#chat')}'></use></svg></a></span>");
                        }
                        if(event.Status === 'Completed'){
                            element.find(".fc-content #eventIcons").append("<span class='closeon'  id='check'><a href='javascript:void(0);'><svg class='slds-button__icon slds-icon_xx-small' aria-hidden='true'><use xlink:href='{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#check')}'></use></svg></a></span>");
                        }
                        if(event.Status === 'No-show'){
                            element.find(".fc-content #eventIcons").append("<span class='closeon'  id='cross'><a href='javascript:void(0);'><svg class='slds-button__icon slds-icon_xx-small' aria-hidden='true'><use xlink:href='{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}'></use></svg></a></span>");
                        }
                        if(event.Type === 'Regular' && event.Individual == 'false'){
                            element.find(".fc-content #eventIcons").append("<span class='closeon' id='retweet'><a href='javascript:void(0);'><svg class='slds-button__icon slds-icon_xx-small' aria-hidden='true'><use xlink:href='{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#retweet')}'></use></svg></a></span>");
                        }
                        
                        element.find("#sms").on('click', function() {
                            $('#blank').html('sms');
                        });
                        element.find("#retweet").on('click', function() {
                            $('#blank').html('retweet');
                        });
                        element.find("#check").on('click', function() {
                            $('#blank').html('check');
                        });
                    }
                        
                },
                eventDragStart: function(event) {
                    var startTime = event.start.format();
                    originalTime = startTime; 
                    
                    console.log('startTime on drag',startTime);
                },
                eventDrop: function(event, delta, revertFunc) {
                    revertFunc();
                    /*bookingReschedule.Id = event.id;
                    bookingReschedule.Type = event.Type;
                    bookingReschedule.resource = event.resourceId;
                    bookingReschedule.date = event.start.format();
                    bookingReschedule.Individual = event.Individual;
                    bookingReschedule.isRecurrence = 'false';
                    $('#closeRescheduleIconButton').attr('onclick', 'cancelRescheduling();closeRescheduleModal();return false;');
                    if(isDateTimeInFuture(originalTime) && isEventInTeacherWorkingHour(teacherWorkingHours, event.start.format(), event.end.format(), event.resourceId) && isDateTimeInFuture(event.start.format())){
                        if(bookingReschedule.Type == 'Regular' && bookingReschedule.Individual == 'false'){
                            console.log('In If Condition');
                            isReschedule = false;
                            $('#confirmModalYes').addClass('slds-hide');
                            $('#confirmModalNo').html('Cancel');
                            $('#confirmModalNo').attr('data-origin', 'reschedule');
                            $('#confirmModalNo').attr('onclick', "$('.confirmModal').addClass('slds-hide');closeRescheduleModal(); return false;");
                            $('#confirmHeader').html('Recurring event');
                            $('#confirmHeader').parent().addClass('slds-text-align_left');
                            $('#confirmBody').addClass('slds-text-align_center');
                            $('#confirmBody').html('<p>Would you like to apply this change to this event only,<br/>or the current and future events in the series?</p><div><button class="slds-button slds-m-around_small slds-p-horizontal_large" style="background: #00b3f0;color:#fff;" id="thisReschedule" onclick="rescheduleThisOnly();return false;">This only</button><button class="slds-button slds-m-around_small slds-p-horizontal_large" style="background: #00b3f0;color:#fff;" id="thisAndFutureReschedule" onclick="rescheduleFutureAlso();return false;">This and future</button></div>');
                            $('#confirmModal').removeClass('slds-hide');
                        }else if(bookingReschedule.Id){
                            console.log('In Else Condition...');
                            bookingReschedule.isRecurrence = 'false';
                            reschedule();
                        }
                    }else{
                        revertFunc();
                    }
                    */
                    console.log('event', event);
                    /*if(isDateTimeInFuture(originalTime) && isEventInTeacherWorkingHour(event.source.rawEventDefs, event.start.format(), event.end.format(), event.resourceId) && isDateTimeInFuture(event.start.format())){
                            var isplaceholder = 'true';
                            console.log('do dmls');
                            $('.confirmModal').removeClass('slds-hide');
                            $('#confirmBody').html('Do you want to reschedule appointment?');
                            $('#confirmHeader').html('Reschedule');
                            if(isDateBetween24Hours(event.start.format()) < 24){
                                isplaceholder = 'false';
                            }
                            $('#confirmModalYes').attr("data-origin",'eventdrop');
                            $('#confirmModalNo').attr("data-origin",'eventdrop');
                            $('.sendEmail').attr('data-parentId', event.parentId);
                            console.log('isplaceholder ',isplaceholder);
                            $('#confirmModalYes').attr("data-isplaceholder", isplaceholder);
                            $('#confirmModalYes').attr("data-bookingId",event.id);
                            $('#confirmModalYes').attr("data-startTime",event.start.format());
                            $('#confirmModalYes').attr("data-endTime",event.end.format());
                            $('#confirmModalYes').attr("data-resourceId",event.resourceId);
                        
                            $('#confirmModalNo').click(function(){
                                var reason = $('#confirmModalNo').attr("data-origin");
                                console.log('reason',reason );
                                if(reason && reason==='eventdrop'){ 
                                    revertFunc();
                                }
                            });
                        }else{
                            revertFunc();
                        }*/
                    
                },
                eventClick:  function(event, jsEvent, view,date) {
                    var status = event.Status;
                    $('#advanceOptionsBtn').remove();
                    console.log('event...',event);
                    //console.log(date);
                    $('#timeDuration').html(event.start.format('h:mm a')+ ' - '+event.end.format('h:mm a'));
                    console.log('event.start', event.start.format());
                    eventId = event.id;
                    var centerName = $('.centerList option:selected').text();
                    console.log('centerName ', $('.centerList option:selected').text(), $('.centerList option:selected').val());
                    $('#centerName').html(centerName);
                    $('#centerName').attr('href', '/'+$('.centerList option:selected').val());
                    $('#centerNameBusyView').html(centerName);
                    if(/*event.Type != 'Trial' &&*/ event.Type != 'Regular' && event.Type != 'Busy'){
                        initEvents(eventId, event.start.format());
                    }else if(event.Type != 'Trial' && event.Type == 'Regular'){
                        /*$('#button_Group_EditDetails').append('<button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" style="margin-left: -34px;width:130px;" title="Advance Actions" aria-pressed="false" id="advanceOptionsBtn" onclick="showAdvanceOptions();return false;" data-id="'+eventId+'">Advance Actions <svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#settings')}" /></svg><span class="slds-assistive-text">Advance Actions</span></button>');
                        */
                        initEvents(eventId, event.start.format());
                    }/*else if(event.Type == 'Trial' && eventId){
                        initEvents(eventId, event.start.format());
                        $('#enrolmentDetailSection').removeClass('slds-hide');
                        $('#rescheduleTrialBooking').attr({'data-id':eventId, 'data-date': event.start.format()});
                        $('#sendTrialEnrollmentLink').attr({'data-id': eventId});
                        $('#completeTrialEnrollmentLink').attr({'href': 'apex/trialtoEnrolmentprocess?id='+eventId, 'target': '_blank'});
                    }*/else if(event.Type == 'Busy' && eventId){
                        $('.addNewBookingFromBusy').addClass('slds-hide');    
                        //console.log('eventtype', event.Type, eventId, event);
                        $('#cancelBooking').attr({'data-id': eventId, 'data-date': event.start.format(), 'data-type': event.Type});
                        $('#rescheduleBusyBookingView').attr({'data-id': eventId, 'data-type': event.Type, 'data-individual': event.Individual});
                        $('#rescheduleBusyBookingView').removeClass('slds-hide');
                        $('#rescheduleBusyBookingView').removeAttr('disabled');
                        $('#rescheduleBusyBookingView').css('pointer-events', '');
                        if(event.category == 'Placeholder'){
                            $('.addNewBookingFromBusy').removeClass('slds-hide');    
                        }
                        $('.addNewBookingFromBusy').css('pointer-events', '');
                        $('.addNewBookingFromBusy').removeAttr('disabled');

                        
                        if(!isDateTimeInFuture(event.start.format())){
                            $('#rescheduleBusyBookingView').css('pointer-events', 'none');
                            $('#rescheduleBusyBookingView').attr('disabled', 'true');
                            $('.addNewBookingFromBusy').css('pointer-events', 'none');
                            $('.addNewBookingFromBusy').attr('disabled', 'true');
                        }
                        getBusyBookingDetails(eventId,event.start.format());
                    }
                    
                    
                    if($('#blank').html() === 'sms' || $('#blank').html() == ''){
                        $('body').css('overflow', 'false');
                        
                    }else{
                        $('#blank').html('');
                    }
                    
                    $('#newBookingNote').click(function(){
                        $('.addNotes').removeClass('slds-hide');
                    });
                },
            });
            $('#calendar').fullCalendar('rerenderEvents');
            function isEventInTeacherWorkingHour(eventsjson, startTime, endTime, resourceId){
                var timeSlots = [];
                var isReschedulable = false;
                var teacherWorkings = [];
                console.log('eventsjson',eventsjson);
                console.log('startTime',startTime);
                console.log('endTime',endTime);
                console.log('resourceId',resourceId);
                for(index in eventsjson){
                    if(eventsjson[index].className == 'teacherWorkingHours' && eventsjson[index].resourceId == resourceId){
                        teacherWorkings.push(eventsjson[index]);
                    }
                }
                $(teacherWorkings).each(function(index, value){
                    console.log('teacherWorkings ',value);
                    if(Date.parse(toJSDate(value.start)) <= Date.parse(toJSDate(startTime)) && Date.parse(toJSDate(value.end)) >= Date.parse(toJSDate(endTime))){
                        isReschedulable = true;
                    }
                });
                console.log('isReschedulable ',isReschedulable );
                return isReschedulable;
            }
            
            
            
            $('.fc-next-button').click(function(e){
                var b = $('#calendar').fullCalendar('getDate');
                var bookDate = [b.format('YYYY-MM-DD')];
                teacher = $(".teachers").val();
                var calView = $('#calendar').fullCalendar('getView').name;
                
                var calendarDates = isWeekDay();
                if(calView == 'agendaTwoDay'){
                    initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                }else{
                    initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                }
            });
            
            $('.fc-prev-button').click(function(e){
                var b = $('#calendar').fullCalendar('getDate');
                var bookDate = [b.format('YYYY-MM-DD')];
                teacher = $(".teachers").val();
                var calView = $('#calendar').fullCalendar('getView').name;
                
                var calendarDates = isWeekDay();
                if(calView == 'agendaTwoDay'){
                    initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                }else{
                    initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                }
            });
            
            $('.fc-today-button').click(function(e){
                var b = $('#calendar').fullCalendar('getDate');
                var bookDate = [b.format('YYYY-MM-DD')];
                teacher = $(".teachers").val();
                var calView = $('#calendar').fullCalendar('getView').name;
                
                var calendarDates = isWeekDay();
                if(calView == 'agendaTwoDay'){
                    initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                }else{
                
                    initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                }
            });
            
            $('.fc-agendaDay-button').click(function(e){
                $('[id$=teachers]').children().each(function(index, value){
                    if($(this).val() == 'AllRosteredStaff' || $(this).val() == 'AllStaff'){
                        $(this).remove();
                    }
                });
                $('[id$=resources]').children().each(function(index, value){
                    if($(this).val() == 'AllRosteredResource' || $(this).val() == 'AllResource'){
                        $(this).remove();
                    }
                });
                $('[id$=teachers]').children().first().after('<option value="AllRosteredStaff">All rostered staff</option><option value="AllStaff">All staff</option>');
                $('[id$=resources]').children().first().after('<option value="AllRosteredResource">All rostered resources</option><option value="AllResource">All Resources</option>');
                //$('[id$=teachers]').val('AllRosteredStaff');
                
                var b = $('#calendar').fullCalendar('getDate');
                var bookDate = [b.format('YYYY-MM-DD')];
                teacher = $(".teachers").val();
                var calView = $('#calendar').fullCalendar('getView').name;
                
                var calendarDates = isWeekDay();
                initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                $(this).addClass('fc-state-disabled');
            });
            
            $('.fc-agendaTwoDay-button').click(function(e){
                $('[id$=teachers]').children().each(function(index, value){
                    if($(this).val() == 'AllRosteredStaff' || $(this).val() == 'AllStaff'){
                        $(this).remove();
                    }
                });
                $('[id$=resources]').children().each(function(index, value){
                    if($(this).val() == 'AllRosteredResource' || $(this).val() == 'AllResource'){
                        $(this).remove();
                    }
                });
                var b = $('#calendar').fullCalendar('getDate');
                var bookDate = [b.format('YYYY-MM-DD')];
                if(!$(".teachers").val()){
                    $(".teachers").val( $('[id$=teachers]').children().eq(1).val());
                }
                teacher = $(".teachers").val();
                //console.log('teacher',teacher)
                var calView = $('#calendar').fullCalendar('getView').name;
                
                var calendarDates = isWeekDay();
                initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
            });
            
            $('.fc-myCustomButton-button').after('<span class="fc-button fc-button-title fc-state-default fc-state-hover"><input class="slds-input" type="text" id="fullCalendarDate" style="padding: 0px;border: 0px;cursor: pointer;text-align: center;" onchange="getDirectDate();return false;" readonly/></span>');
            $('.fc-myCustomButton-button').remove();
            var b = $('#calendar').fullCalendar('getDate');
            var bookDate = [b.format('YYYY-MM-DD')];
             $( "#fullCalendarDate" ).val(bookDate);
            //console.log(bookDate.getFullYear()+'-'+(bookDate.getMonth()+1)+'-'+bookDate.getDate());
           
              $( "#fullCalendarDate" ).datepicker({
                  numberOfMonths: 2,
                  showButtonPanel: false,
                  dateFormat: "yy-mm-dd"
            });
              
        }
              
        function getDirectDate(){
            
            console.log('value',$('#fullCalendarDate').val());
            var b = $('#fullCalendarDate').val();
            console.log('b',b);
            var bookDates = [b];
            
            teacher = $(".teachers").val();
            var calView = $('#calendar').fullCalendar('getView').name;
            datesArray = new Array();
            var dt = moment();
            dt.year(b.split('-')[0]).month(b.split('-')[1] - 1).date(b.split('-')[2]);
            console.log('dt',dt);
            var bookDate = dt.format('YYYY-MM-DD');
            
            var beginOfWeek = dt.startOf('week');
            var start = beginOfWeek.format('YYYY-MM-DD');
            
            var endOfWeek = dt.endOf('week');
            var end = endOfWeek.format('YYYY-MM-DD');
            
            datesArray.push(start);
            datesArray.push(end);
            
            var calendarDates = datesArray;
            console.log('calendarDates '+calendarDates);
            if(calView == 'agendaTwoDay'){
                initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
            }else{
                initResources(center, teacher, filter.resource, bookDates , calView, filter.instrument);
            }
        }
        
        function getPackage(package){
            $('#makeupHoursSection').addClass('slds-hide');
            if(package != 'Select Package'){
                bookingData.packageId = package.split('-')[0];
                
            }
            $(createBookingResult.packages).each(function(index6, value6){
                if(bookingData.packageId == value6.id){
                    $('#packageSelect').val(value6.name);
                    $('#getPackageId').removeClass('slds-is-open');
                    console.log('value 6', value6);
                    /*if(value6.duration == 'Trial' && value6.type != 'Home'){
                        bookingData.type = value6.duration;
                        bookingData.duration = '30';
                    }*/
                    if(value6.type == 'Trial'){
                        bookingData.type =  value6.type; // value6.duration;
                        bookingData.duration = value6.duration;   //'30';
                    }else if(value6.duration == 'Trial' && value6.type == 'Home'){
                        bookingData.type = 'home-trial';
                        bookingData.duration = '30';
                    }else if(value6.type == 'Makeup'){
                        bookingData.type = 'Makeup';
                        bookingData.duration = value6.duration;
                    }else if(value6.type == 'Adhoc'){
                        bookingData.type = value6.type;
                        bookingData.duration = value6.duration;
                    }    
                    
                }
            });
            var duration = package;
            var type = '';
            if(duration){
                $(createBookingResult.packages).each(function(index2, value2){
                    console.log('value ',value2);
                    if(value2.id == duration.split('-')[0]){
                        type = value2.type;
                    }   
                     
                });
            
                if(duration.split('-')[1] == 'Trial'){
                    $('#durationLabel').html('30 min');
                    $('#adhoc_method_section').addClass('slds-hide');
                     $('#makeupHoursSection').addClass('slds-hide');
                     $('#recurringSection').addClass('slds-hide');
                }else if(type  == 'Makeup'){
                    $('#durationLabel').html(duration.split('-')[1] + ' min');
                    $('#makeupHoursSection').removeClass('slds-hide');
                    $('#recurringSection').removeClass('slds-hide');
                }else if(type  == 'Adhoc'){
                    $('#durationLabel').html(duration.split('-')[1] + ' min');
                     $('#recurringSection').removeClass('slds-hide');
                }else{
                     $('#durationLabel').html(duration.split('-')[1] + ' min');
                     $('#adhoc_method_section').addClass('slds-hide');
                     $('#makeupHoursSection').addClass('slds-hide');
                     $('#recurringSection').addClass('slds-hide');
                }
                
            }else{
                $('#durationLabel').html('');
            }
           console.log('$$$bookingData',bookingData);
        }        
        
        function newAppointmentPopup(centerid, teacherid, dateOfAppointment){
            console.log('centerid', centerid);
            console.log('teacherid', teacherid);
            console.log('dateOfAppointment', dateOfAppointment);
            $("#busyBookingViewModal").addClass('slds-hide');
            
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getTeacherAndCenter}',
                centerid, teacherid,
                function(result, event){
                    var msg = '';
                    if (event.status) {
                        console.log('result ',result); 
                        $('#newBookingModal').addClass('slds-hide'); 
                        var eventResult = JSON.parse(result.replace(/(&quot\;)/g,"\""));
                        createBookingResult = eventResult;
                        var packages = '';
                        console.log('eventResult ',eventResult);
                        $('#dateLabel').html(convertDateToMoment(dateOfAppointment.split('T')[0]));
                        $('#timeLabel').html(convertTimeToMoment(dateOfAppointment.split('T')[1].split(':')[0], dateOfAppointment.split('T')[1].split(':')[1]));
                        $(eventResult.entities).each(function(index, value){
                            if(value.type == 'Centre'){
                                $('#centerNameLabel').html(value.name);
                            }
                        });
                        $('#saveNewBooking').attr('data-date', dateOfAppointment);
                        
                        var setOfPackageType = new Set();
                        var packageBody = [];
                        $(eventResult.packages).each(function(index1, value1){
                            /*if(value1.type && value1.type != 'Individual'){
                                setOfPackageType.add(value1.type);
                            }else if((!value1.type || value1.type == 'Individual') && value1.duration == 'Trial'){
                                setOfPackageType.add(value1.duration);
                            }*/
                            if(value1.type){
                                setOfPackageType.add(value1.type);
                            }
                            
                        });
                       
                        console.log('setOfPackageType',setOfPackageType);

                        for(let setValue of setOfPackageType){
                            packageBody[setValue] = '<ul class="slds-listbox slds-listbox_vertical" role="group" aria-label="'+setValue+'"> <li role="presentation" class="slds-listbox__item"><div id="'+setValue+'" class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small" role="presentation"><h3 class="slds-listbox__option-header" role="presentation">'+setValue+'</h3></div></li>';
                        }
                        
                        $(eventResult.packages).each(function(index1, value1){
                            /*if(value1.type  && value1.type != 'Individual'){
                                packageBody[value1.type] += '<li role="presentation" class="slds-listbox__item"><div id="'+value1.id+'-'+value1.duration+'" onclick="getPackage($(this).attr(\'id\'));return false;" class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small" role="option"><span class="slds-media__figure slds-listbox__option-icon"></span><span class="slds-media__body"><span class="slds-truncate" title="'+value1.name+'">'+value1.name+'</span></span></div></li>';
                            }else if((!value1.type || value1.type == 'Individual') && value1.duration == 'Trial'){
                                packageBody[value1.duration] += '<li role="presentation" class="slds-listbox__item"><div id="'+value1.id+'-'+value1.duration+'" onclick="getPackage($(this).attr(\'id\'));return false;" class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small" role="option"><span class="slds-media__figure slds-listbox__option-icon"></span><span class="slds-media__body"><span class="slds-truncate" title="'+value1.name+'">'+value1.name+'</span></span></div></li>';
                            }*/
                            if(value1.type){
                                packageBody[value1.type] += '<li role="presentation" class="slds-listbox__item"><div id="'+value1.id+'-'+value1.duration+'" onclick="getPackage($(this).attr(\'id\'));return false;" class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small" role="option"><span class="slds-media__figure slds-listbox__option-icon"></span><span class="slds-media__body"><span class="slds-truncate" title="'+value1.name+'">'+value1.name+'</span></span></div></li>';
                            }
                        });
                        
                        for(let Value of setOfPackageType){
                            packageBody[Value] += '</ul>';
                            packages += packageBody[Value];
                            
                        }
                        console.log('setOfPackageType ',packageBody);
                        
                        $('#selectPackageListSection').append(packages);
                        
                        /*$('#packageSelect').change(function(){
                            var duration = this.value;
                            var type = '';
                            if(duration != 'Select Package'){
                                $(eventResult.packages).each(function(index2, value2){
                                    console.log('value ',value2);
                                    if(value2.id == duration.split('-')[0]){
                                        type = value2.type;
                                    }   
                                     
                                });
                            
                                if(duration.split('-')[1] == 'Trial'){
                                    $('#durationLabel').html('30 min');
                                    $('#adhoc_method_section').addClass('slds-hide');
                                     $('#makeupHoursSection').addClass('slds-hide');
                                     $('#recurringSection').addClass('slds-hide');
                                }else if(type  == 'Makeup'){
                                    $('#durationLabel').html(duration.split('-')[1] + ' min');
                                    $('#makeupHoursSection').removeClass('slds-hide');
                                    $('#recurringSection').removeClass('slds-hide');
                                }else if(type  == 'Adhoc'){
                                    $('#durationLabel').html(duration.split('-')[1] + ' min');
                                     $('#recurringSection').removeClass('slds-hide');
                                }else{
                                     $('#durationLabel').html(duration.split('-')[1] + ' min');
                                     $('#adhoc_method_section').addClass('slds-hide');
                                     $('#makeupHoursSection').addClass('slds-hide');
                                     $('#recurringSection').addClass('slds-hide');
                                }
                                
                            }else{
                                $('#durationLabel').html('');
                            }
                        });*/
                        
                        
                        $('#newBookingDetails').removeClass('slds-hide');
                        
                        
                        $('#studentInput').keyup(function(){
                            var student_name = $(this).val();
                            var studentListItem = '';
                            setTimeout(function(){
                                Visualforce.remoting.Manager.invokeAction(
                                    '{!$RemoteAction.AureusCalendarController.getStudents}',
                                    student_name,
                                    function(result, event){
                                        var ResultOfEvent = JSON.parse(result.replace(/(&quot\;)/g,"\""));
                                        console.log('result ', ResultOfEvent );
                                        $(ResultOfEvent).each(function(index3, value3){
                                            studentListItem += '<li role="presentation" class="slds-listbox__item " id="'+value3.id+'"><div id="option'+(index3+1)+'" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta student-list" role="option"><span class="slds-media__body">';
                                            studentListItem += '<span class="slds-listbox__option-text slds-listbox__option-text_entity studentNameLabel">'+value3.label+'</span><span class="slds-listbox__option-meta slds-listbox__option-meta_entity"> • '+value3.parentName+'</span></span></div></li>';
                                        });
                                        $('#studentSelectContainer').removeClass('slds-is-open');
                                        $('#studentSelectContainer').attr('aria-expanded', 'false');
                                        $('#studentSearchList').empty();
                                        $('#studentSearchList').append(studentListItem); 
                                        
                                        $('#studentSelectContainer').addClass('slds-is-open');
                                        $('#studentSelectContainer').attr('aria-expanded', 'true');
                                        if(ResultOfEvent.length == 0){
                                            $('#studentSelectContainer').removeClass('slds-is-open');
                                            $('#studentSelectContainer').attr('aria-expanded', 'false');
                                            $('#studentSearchList').empty();
                                            $('#parentInput').removeAttr('disabled');
                                            $('#phoneInput').removeAttr('disabled');
                                            $('#emailInput').removeAttr('disabled');
                                            $('#parentInput').val('');
                                            $('#phoneInput').val('');
                                            $('#emailInput').val('');
                                        }
                                        
                                        $('.student-list').click(function(){
                                            var studentId = $(this).parent().attr('id');
                                            $(ResultOfEvent).each(function(index4, value4){
                                                if(value4.id == studentId){
                                                    bookingData.studentId = value4.id;
                                                    if(value4.label){
                                                        $('#studentInput').val(value4.label);
                                                    }else{
                                                        $('#studentInput').val('');
                                                    }
                                                    
                                                    if(value4.parentName){
                                                        $('#parentInput').val(value4.parentName);
                                                    }else{
                                                        $('#parentInput').val('');
                                                    }
                                                    
                                                    if(value4.phone){
                                                        $('#phoneInput').val(value4.phone);
                                                    }else{
                                                        $('#phoneInput').val('');
                                                    }
                                                    
                                                   if(value4.email){
                                                        $('#emailInput').val(value4.email);
                                                    }else{
                                                        $('#emailInput').val('');
                                                    }
                                                    $('#makeupHoursLabel').html(value4.makeupHours+' min');
                                                    $('#parentInput').attr('disabled', '');
                                                    $('#phoneInput').attr('disabled', '');
                                                    $('#emailInput').attr('disabled', '');
                                                    $('#studentSelectContainer').removeClass('slds-is-open');
                                                    $('#studentSelectContainer').attr('aria-expanded', 'false');
                                                    $('#studentSearchList').empty();
                                                }                                
                                            });
                                            
                                        });
                                        
                                        
                                        
                                    }, 
                                    {escape: true}
                                ); 
                                
                            }, 500);
                        });
                    }
                },
                {escape: true}
            );
            
            
        }
        
        function closeRescheduleModal(){
            $('.editDetails').addClass('slds-hide');
            refreshEditAppointment(); 
            $('.popupDetails').removeClass('slds-hide'); 
            resetTabs();
            var b = $('#calendar').fullCalendar('getDate');
            var bookDate = [b.format('YYYY-MM-DD')];
            teacher = $(".teachers").val();
            var calView = $('#calendar').fullCalendar('getView').name;
            
            var calendarDates = isWeekDay();
            if(calView == 'agendaTwoDay'){
                initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
            }else{
                initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
            }
        }
        function refreshNewBookingPopup(){
            bookingData = {};
            $('#saveNewBooking').css('pointer-events', '');
        
            $('#centerNameLabel').html('');
            $('#dateLabel').html('');
            $('#timeLabel').html('');
            $('#packageSelect').val('');
            $('#durationLabel').html('');
            $('#parentInput').val('');
            $('#phoneInput').val('');
            $('#emailInput').val(''); 
            $('#studentInput').val('');
            $('#parentInput').removeAttr('disabled');
            $('#phoneInput').removeAttr('disabled');
            $('#emailInput').removeAttr('disabled');
            $('#adhoc_method_section').addClass('slds-hide');
            $('#makeupHoursSection').addClass('slds-hide');
            $('.repeatSelection').addClass('slds-hide');
            $('#recurringSection').addClass('slds-hide');
            $('#makeupHoursErrorMsg').text('');
            $('#recurrenceOccure').empty();
            $('#onSelectedDate').val('');
            $('#totalNoOfBookings').html('');
            $('#afterRadio').prop('checked', true);
            $('#makeupHoursLabel').text('');
            $('#repeatSelect').val('None');
            $('#afterRadio').prop('checked');
            $('#selectPackageListSection').empty();
            $('#getPackageId').removeClass('slds-is-open');
            $('#repeatSelectBusy').val('None');
        }
        
        
         $('#paymentRadio').change(function(index, value){
            if($(paymentRadio).prop( "checked" )){
                $('#makeupHoursSection').addClass('slds-hide');
            }
        });
        
        $('#completeBooking').click(function(){
            console.log('Disabled ', $(this).attr('disabled'));
            if(!$(this).attr('disabled')){
                $('.editDetails').addClass('slds-hide');
                var bookingId = $(this).attr('data-id');
                var type = $(this).attr('data-type');
                var status = $(this).attr('data-status');
                $('#confirmModalYes').attr({'data-id':bookingId, 'data-type':type, 'data-status':status, 'data-origin':'bookingComplete'});
                $('#confirmModalNo').removeAttr('data-origin');
                $('#confirmHeader').html('Complete This Appointment');
                $('#confirmBody').html('Do you want to complete this Appointment?');
                $('#confirmModal').removeClass('slds-hide');
            }
            
        });
        $('#noShowBooking').click(function(){
            if(!$(this).attr('disabled')){
                $('.editDetails').addClass('slds-hide');
                var bookingId = $(this).attr('data-id');
                var type = $(this).attr('data-type');
                var status = $(this).attr('data-status');
                $('#confirmModalNo').removeAttr('data-origin');
                $('#confirmModalYes').attr({'data-id':bookingId, 'data-type':type, 'data-status':status, 'data-origin':'bookingNoShow'});
                $('#confirmHeader').html('No-show This Appointment');
                $('#confirmBody').html('Do you want to No-show this Appointment?');
                $('#confirmModal').removeClass('slds-hide');
            }
        });
        function updateBooking(id, start, end, teacherId, isplaceholder, isFuture){
            console.log('updateBooking', id, start, end, teacherId, isplaceholder, isFuture);
            
            if(id && start){ //&& end
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AureusCalendarController.updateBooking}',
                    id, start, end, teacherId, isplaceholder, isFuture, caseId, 
                    function(result, event){
                        var msg = '';
                        if (event.status) {
                            $('.editDetails').addClass('slds-hide');
                            isReschedule = false;
                            
                            $('#confirmModalNo').html('No');
                            $('#confirmHeader').parent().removeClass('slds-text-align_left');
                            $('#confirmBody').removeClass('slds-text-align_center');
                            $('#confirmModalYes').removeClass('slds-hide');
                            $("#rescheduleClose").trigger("click");
                            if(bookingReschedule.scheduleType == 'commitEmail'){
                                $('#confirmModalYes').attr('data-origin', 'email');
                                $('#confirmModalYes').trigger('click');
                            }else if(bookingReschedule.scheduleType == 'commit'){
                                console.log('Nothing will show...',result.caseId);
                                
                                if(result.caseId){
                                    redirectToCaseRecord(result.caseId); 
                                }else{
                                    var b = $('#calendar').fullCalendar('getDate');
                                    var bookDate = [b.format('YYYY-MM-DD')];
                                    teacher = $(".teachers").val();
                                    var calView = $('#calendar').fullCalendar('getView').name;
                                    
                                    var calendarDates = isWeekDay();
                                
                                    if(calView == 'agendaTwoDay'){
                                        initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                                    }else{
                                        initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                                    }
                                }
                            }else{
                                $('.confirmModal').removeClass('slds-hide');
                                $('#confirmBody').html('Do you want to send an email?');
                                $('#confirmHeader').html('Email Confirmation');
                                $('#confirmModalYes').attr('data-origin','email');
                                $('#confirmModalNo').attr('data-origin','email');
                                $('#confirmModalYes').removeAttr('data-starttime');
                                $('#confirmModalYes').removeAttr('data-resourceid'); 
                                $('#confirmModalYes').removeAttr('data-endtime');
                            }
                            bookingReschedule.Id = '';
                            bookingReschedule.Type = '';
                            bookingReschedule.resource = '';
                            bookingReschedule.date = '';
                            bookingReschedule.Individual = '';
                            bookingReschedule.isRecurrence = '';
                            bookingReschedule.scheduleType = '';
                            
                            $('#toastMsg').html('Appointment Reschedule successfully');
                            toastLaunch();
                        }
                    },
                    {buffer: false, escape: true}
                );
            }
        }
        function rescheduleThisOnly(){
            bookingReschedule.isRecurrence = 'false';
            //console.log('In Rescedule Only ', bookingReschedule);
            reschedule();
        }
        function rescheduleFutureAlso(){
            bookingReschedule.isRecurrence = 'true';
            //console.log('In Future ....' ,bookingReschedule);
            reschedule();
        }
        function reschedule(){
            $('#commitChanges').remove();
            $('#commitEmail').remove(); 
            $('#cancelChanges').remove();
            //console.log('Booking ', bookingReschedule);
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.showRescheduledBookings}',
                bookingReschedule,
                function(result, event){
                    var msg = '';
                    if (event.status) {
                        if(result){
                            $('#detailPopupTitle').html('Rescheduled Appointment');
                            $('#confirmModal').addClass('slds-hide');
                            var eventResult = JSON.parse(result.replace(/(&quot\;)/g,"\""));
                            console.log('eventResult ... ', eventResult);
                            $('.editCustomerDetails').attr('data-id', eventResult.studentId);
                            
                            if(eventResult.parentId){
                                $('.editCustomerDetails').attr('data-parentId', eventResult.parentId);
                            }else{
                                $('.editCustomerDetails').attr('data-parentId', eventResult.studentId);
                            }
                            $('#teacherNameEditPopup').html(eventResult.staffMember);
                            $('#teacherNameEditPopup').attr('hrrf','/'+eventResult.staffMember);
                            
                            $('#cancelBooking').attr('data-id',eventResult.Id);
                            $('#cancelBooking').attr('data-type',eventResult.type);
                            $('#lesson').text(eventResult.service);
                            $('#teacherName').text(eventResult.staffMember);
                            $('#resource').text(eventResult.resource);
                            $('#dateAndTime').text(eventResult.dateAndTime);
                            $('.sendEmail').attr('data-bookingId', eventResult.Id);
                            
                            if(eventResult.parentId){
                                $('.sendEmail').attr('data-parentId', eventResult.parentId);
                            }else{
                                $('.sendEmail').attr('data-parentId', eventResult.studentId);
                            }
                            
                            $('#statusIconOnEdit').empty();
                            $('#statusLabelOnEdit').text(eventResult.status);
                            if(eventResult.status == 'Scheduled'){
                                $('#statusIconOnEdit').append('<svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#clock')}" /></svg>');
                            }else if(eventResult.status == 'Pending'){
                                $('#statusIconOnEdit').append('<svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#reminder')}" /></svg>');
                            }else if(eventResult.status == 'Completed'){
                                $('#statusIconOnEdit').append('<svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#check')}" /></svg>');
                            }else if(eventResult.status == 'No-show'){
                                $('#statusIconOnEdit').append('<svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#close')}" /></svg>');
                            }else if(eventResult.status == 'Canceled'){
                                $('#statusIconOnEdit').append('<svg class="slds-button__icon" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS,'/assets/icons/utility-sprite/svg/symbols.svg#clear')}" /></svg>');
                            }
                            
 
                            
                            var dateTime = eventResult.dateAndTime;
                            var res;
                            if(dateTime){
                                res =  dateTime.split("T"); 
                                $('#date').text(convertDateToMoment(res[0]));
                                $('#time').text(convertTimeToMoment(res[1].split(':')[0], res[1].split(':')[1]));
                                $('#serviceTime').text(convertTimeToMoment(res[1].split(':')[0], res[1].split(':')[1]));
                            }
                            $('#tab-default-2__item').addClass('slds-hide');
                            $('#tab-default-3__item').addClass('slds-hide');
                            $('#tab-default-5').addClass('slds-hide');
                            $('#enrolmentDetailSection').addClass('slds-hide');
                            $('#advanceDetailsSection').addClass('slds-hide');
                            $('.studentImg').attr('src','/servlet/servlet.FileDownload?file='+eventResult.teacherAttachmentId+'');
                            $('#duration').text(eventResult.duration);
                            $('#price').text(eventResult.price);
                            $('#totalPrice').text('$'+eventResult.price);
                            
                            $('#lessonOnCancel').text(eventResult.service);
                            $('#teacherOnCancel').text(eventResult.staffMember);
                            $('#dateAndTimeOnCancel').text(eventResult.dateAndTime);
                            $('#name').text(eventResult.studentFirstName+' '+eventResult.studentLastName+' - '+eventResult.parentFirstName +' '+eventResult.parentLastName);
                            //$('#name1').text(eventResult.studentFirstName+' '+eventResult.studentLastName+' - '+eventResult.parentFirstName +' '+eventResult.parentLastName);                                
                            $('#name1').text(eventResult.studentFirstName+' '+eventResult.studentLastName);
                            $('#parentname1').text(eventResult.parentFirstName +' '+eventResult.parentLastName);
                            $('.popupDetails').removeClass('slds-hide');
                            if(eventResult.rType == 'Lesson'){
                                $('#selectStudio').addClass('slds-hide');
                            }else if(eventResult.rType == 'Facility'){
                                $('#selectTeacher').addClass('slds-hide');
                            }
                            $('#fname').val(eventResult.studentFirstName);
                            $('#lname').val(eventResult.studentLastName);
                            $('#telephone').val(eventResult.parentPhone);
                            $('#parentsms').val(eventResult.parentMobile);
                            $('#parentEmail').val(eventResult.parentEmail);
                            
                            $('#parentfname').val(eventResult.parentFirstName);
                            $('#parentlname').val(eventResult.parentLastName);
                            $('#popoverTitle').text(eventResult.studentFirstName+ ' '+eventResult.studentLastName + ' - ' +eventResult.parentFirstName+ ' '+eventResult.parentLastName);
                            
                            $('#phone').text(eventResult.parentMobile);
                            $('#email').text(eventResult.parentEmail);
                            
                            $('#studentName').text(eventResult.studentFirstName+ ' '+eventResult.studentLastName);
                            $('#parentName').text(eventResult.parentFirstName+ ' '+eventResult.parentLastName);
                            $('#parentMobile').text(eventResult.parentMobile);
                            $('#parentPhone').text(eventResult.parentPhone);
                            $('#parentEmail').text(eventResult.parentEmail);
                            $('#servicePackagName').text(eventResult.service);
                            $('#serviceStaff').text(eventResult.staffMember);
                            $('#serviceResource').text(eventResult.resource);
                           // $('#serviceTime').text(eventResult.timeOfBooking);
                            $('#serviceDuration').text(eventResult.duration);
                            
                            $('#servicePrice').text(eventResult.price);
                            $('.editDetails').removeClass('slds-hide');
                            $('.editBooking').addClass('slds-hide');
                            $('#noShowBooking').addClass('slds-hide');
                            $('#completeBooking').addClass('slds-hide');
                            $('#cancelBooking').addClass('slds-hide');
                            var addbuttons = '<button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" aria-pressed="false" id="commitChanges" onclick="commit();return false;">Confirm Changes</button>';
                            addbuttons +='<button class="slds-button slds-button_icon slds-button_icon-border-filled button-shadow" aria-pressed="false" id="cancelChanges" onclick="cancelRescheduling();return false;">Cancel</button>';
                            $('#button_Group_reschedule').removeClass('slds-size_5-of-12');
                            $('#button_Group_reschedule').addClass('slds-size_12-of-12');
                            $('#completeBooking').after(addbuttons);
                            //console.log('In Reschedule ... ', bookingReschedule);
                            $('#cancelChanges').attr('onclick','cancelRescheduling();closeRescheduleModal();return false;');
                        }  
                    }
                },
                {escape: true}
            );
            
        }
        
        function sendTrialEnrollment(bookingId){
            console.log('bookingId', bookingId);
            if(bookingId){
                 console.log('bookingId 1', bookingId);
                 Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getParentId}',
                bookingId,
                    function(result, event){
                        console.log('parent Email is ', result);
                        $('.sendEmail').attr({'data-parentId': result, 'data-bookingId': bookingId});
                        $('#trialBookingClickModal').addClass('slds-hide');
                        $('.sendEmail').removeClass('slds-hide');
                        
                    }
                 );
            }
            
        }
        
        function commit(){
            bookingReschedule.scheduleType = 'commit';
            if(bookingReschedule.Type == 'Regular' && bookingReschedule.isRecurrence == 'false' && bookingReschedule.Individual == 'true'){
                console.log('In 1st Condition .... ',bookingReschedule);
                updateBooking(bookingReschedule.Id, bookingReschedule.date, '', bookingReschedule.resource, 'false', 'false');
            }else if(bookingReschedule.Type == 'Regular' && bookingReschedule.Individual == 'false' && bookingReschedule.isRecurrence == 'false'){
                console.log('In 2nd Condition .... ',bookingReschedule);
                updateBooking(bookingReschedule.Id, bookingReschedule.date, '', bookingReschedule.resource, 'true', 'false');
            }else if(bookingReschedule.Type != 'Regular'){
                console.log('In r3d Condition .... ',bookingReschedule);
                updateBooking(bookingReschedule.Id, bookingReschedule.date, '', bookingReschedule.resource, 'false', 'false');
            }else if(bookingReschedule.Type == 'Regular' &&  bookingReschedule.isRecurrence == 'true'){
                console.log('In r3d Condition .... ',bookingReschedule);
                updateBooking(bookingReschedule.Id, bookingReschedule.date, '', bookingReschedule.resource, 'false', 'true');
            }
            
        }
        function commitAndEmail(){
            bookingReschedule.scheduleType = 'commitEmail';
            if(bookingReschedule.Type == 'Regular' && bookingReschedule.isRecurrence == 'false' && bookingReschedule.Individual == 'true'){
                console.log('In 1st Condition .... ',bookingReschedule);
                updateBooking(bookingReschedule.Id, bookingReschedule.date, '', bookingReschedule.resource, 'false', 'false');
            }else if(bookingReschedule.Type == 'Regular' && bookingReschedule.Individual == 'false' && bookingReschedule.isRecurrence == 'false'){
                console.log('In 2nd Condition .... ',bookingReschedule);
                updateBooking(bookingReschedule.Id, bookingReschedule.date, '', bookingReschedule.resource, 'true', 'false');
            }else if(bookingReschedule.Type != 'Regular'){
                console.log('In r3d Condition .... ',bookingReschedule);
                updateBooking(bookingReschedule.Id, bookingReschedule.date, '', bookingReschedule.resource, 'false', 'false');
            }else if(bookingReschedule.Type == 'Regular' &&  bookingReschedule.isRecurrence == 'true'){
                console.log('In r3d Condition .... ',bookingReschedule);
                updateBooking(bookingReschedule.Id, bookingReschedule.date, '', bookingReschedule.resource, 'false', 'true');
            }
        }
        function cancelRescheduling(){
            $('.editDetails').addClass('slds-hide');
            bookingReschedule.Id = '';
            bookingReschedule.Type = '';
            bookingReschedule.resource = '';
            bookingReschedule.date = '';
            bookingReschedule.Individual = '';
            bookingReschedule.isRecurrence = '';
            bookingReschedule.scheduleType = '';
            isReschedule = false;
            $('#containerMessage').addClass('slds-hide');
            
        }
        function refreshEditAppointment(){
            $('#tab-default-2__item').removeClass('slds-hide');
            $('#tab-default-3__item').removeClass('slds-hide');
            $('.editBooking').removeClass('slds-hide');
            $('#commitChanges').remove();
            $('#commitEmail').remove(); 
            $('#cancelChanges').remove();
            $('#noShowBooking').removeClass('slds-hide');
            $('#cancelBooking').removeClass('slds-hide');
            $('#completeBooking').removeClass('slds-hide');
            $('#detailPopupTitle').html('Edit Appointment');
            $('#repeatAppointment').removeClass('slds-hide');
            $('#hr-editAppointment').removeClass('slds-hide');
            $('#completeEnrollment').remove();
            $('.custBtn').css("width", "130px");
            $('#button_Group_reschedule').removeClass('slds-size_12-of-12');
            $('#button_Group_reschedule').addClass('slds-size_5-of-12');
            $('#requestDateEdit').html('');
            $('#effectiveDateEdit').html('');
            $('#noticeStartEdit').html('');
            $('#noticeEndEdit').html('');
            $('#processTypeEdit').html('');
            $('#newPackageEdit').html('');
            $('#newPackageEdit').attr('href','');
        }
        function toastLaunch(){
            if($("#ToastMessage").hasClass('slds-hide')){
                $("#ToastMessage").removeClass('slds-hide');
            }else{
                $("#ToastMessage").addClass('slds-hide');
            }
            setTimeout(function(){
                $("#ToastMessage").addClass('slds-hide');
                $('.toastclass').removeClass('slds-theme_error');
                $('.toastclass').addClass('slds-theme_success');
            }, 6000);
            
        }
        function initChange(){
            
            
            var teacherId = '';
            $(".teachers").change(function(){
                getTeacher($('[id$=teachers]').val());
                teacherId = $(this).val();
                center = $('.centerList').val();
                
                var b = $('#calendar').fullCalendar('getDate');
                var bookDate = [b.format('YYYY-MM-DD')];
                var calView = $('#calendar').fullCalendar('getView').name;
                console.log('calView initchange '+calView);
                var calendarDates = isWeekDay();
                if(calView == 'agendaTwoDay'){
                    initResources(center, teacherId, filter.resource, calendarDates, calView, filter.instrument);
                }else{
                    //$('[id$=teachers]').val('AllRosteredStaff');
                    //teacherId = $(this).val();
                    
                    initResources(center, teacherId, filter.resource, bookDate, calView, filter.instrument);
                }
            });
        }
        
        function showAdvanceOptions(){
            $('#downgradeSubscriptionBtn').removeAttr('disabled');
            $('#downgradeSubscriptionBtn').attr('title', 'Downgrade Subscription');
            $('#downgradeSubscriptionBtn').css('pointer-events', '');
           
            $('#cancelSubscriptionBtn').removeAttr('disabled');
            $('#cancelSubscriptionBtn').attr('title', 'Cancel Subscription');
            $('#cancelSubscriptionBtn').css('pointer-events', '');
            $('.editDetails').addClass('slds-hide');
            var bookingId = $('#advanceOptionsBtn').attr('data-id');
            console.log('bookingId',bookingId);
            Visualforce.remoting.Manager.invokeAction(
            '{!$RemoteAction.AureusCalendarController.getAdvanceDetails}',
            bookingId,
                function(result, event){
                    if (event.status) {
                       if(result){
                           console.log('result', result);
                           
                           $('#packageNameAdvance').html(result.packageName);
                           //$('#subscriptionDateAdvance').html(result.startDate);
                           if(result.startDate){
                               var arr = result.startDate.split('-');
                               $('#subscriptionDateAdvance').html(convertDateToMoment(arr[2]+'-'+arr[1]+'-'+arr[0]));
                           }
                           
                           if(result.isPackagePromotional){
                               $('#downgradeSubscriptionBtn').attr('disabled', 'true');
                               $('#downgradeSubscriptionBtn').attr('title', 'Current Package is Promotional type');
                               $('#downgradeSubscriptionBtn').css('pointer-events', 'none');
                               
                               $('#cancelSubscriptionBtn').attr('disabled', 'true');
                               $('#cancelSubscriptionBtn').attr('title', 'Current Package is Promotional type');
                               $('#cancelSubscriptionBtn').css('pointer-events', 'none');
                           }
                           
                           $('#frequencyAdvance').html(result.frequency);
                           $('#timeslotAdvance').html(result.timeSlot);
                           
                           $('#cancelSubscriptionBtn').attr({'data-id': result.id, 'data-timeslot': result.timeSlot});
                           $('#upgradeSubscriptionBtn').attr('data-id', result.id);
                           $('#downgradeSubscriptionBtn').attr('data-id', result.id);
                           $('#submitUpgradeRequest').attr({'data-id': result.id, 'data-packageId': result.packageId});
                           $('#submitDowngradeRequest').attr({'data-id': result.id, 'data-packageId': result.packageId});
                           $('#advanceOptionPopup').removeClass('slds-hide');
                       }
                    }
                },
                {escape: true}
            );
            
        }
        
        function refreshAdvancePopup(){
            $('#packageNameAdvance').html('');
            $('#subscriptionDateAdvance').html('');
            $('#frequencyAdvance').html('');
            $('#timeslotAdvance').html('');
        }
        
        function upgradeSubscription(){
            $('#selectRequestedPackage').empty();
            $('#effectiveDateInput').val('');
            $('#upgradePackageSelectError').html('');
            $('#effectiveDateError').html('');
            $('#submitUpgradeRequest').css('pointer-events','');
            $('#submitUpgradeRequest').removeAttr('disabled');
            $('#advanceOptionPopup').addClass('slds-hide');
            var bookingId = $('#upgradeSubscriptionBtn').attr('data-id');
            console.log('bookingId', bookingId );
            Visualforce.remoting.Manager.invokeAction(
            '{!$RemoteAction.AureusCalendarController.getUpgradedDetails}',
            bookingId,
                function(result, event){
                    if (event.status) {
                       if(result){
                           console.log('result', result);
                           $('#currentPackageName').html(result.packageName);
                           var str = '<option>Upgrade Subscription</option>';
                           $(result.packages).each(function(index, value){
                               str += '<option value="'+value.id+'">'+value.name+'</option>';
                           });
                           $('#selectRequestedPackage').append(str);
                           
                           $('#gradeSubscriptionPopup').removeClass('slds-hide');
                       }
                    }
                },
                {escape: true}
            );
        }
        
        function downgradeSubscription(){
            $('#selectRequestedPackageDowngrade').empty();
            $('#advanceOptionPopup').addClass('slds-hide');
            $('#effectiveDateInputDowngrade').val('');
            $('#noticePeriodDowngradeStart').html('');
            $('#noticePeriodDowngradeEnd').html('');
            $('#downgradePackageSelectError').html('');
            $('#effectiveDateErrorDowngrade').html('');
            var bookingId = $('#downgradeSubscriptionBtn').attr('data-id');
            
            console.log('bookingId', bookingId);
            Visualforce.remoting.Manager.invokeAction(
            '{!$RemoteAction.AureusCalendarController.getDowngradedDetails}',
            bookingId,
                function(result, event){
                    if (event.status) {
                       if(result){
                           console.log('result', result);
                           $('#currentPackageNameDowngrade').html(result.packageName);
                           var str = '<option>Downgrade Subscription</option>';
                           $(result.packages).each(function(index, value){
                               str += '<option value="'+value.id+'">'+value.name+'</option>';
                           });
                           $('#selectRequestedPackageDowngrade').append(str);
                            $('#downgradePopup').removeClass('slds-hide');
                       }
                    }
                },
                {escape: true}
            );
        }         
        
        function teacherChange(){
            window.setTimeout(function(){
                var calView = $('#calendar').fullCalendar('getView').name;
                if(calView == 'agendaDay'){
                    console.log('calview in teacher change '+calView);
                    //$('[id$=teachers]').children().first().after('<option value="AllRosteredStaff">All rostered staff</option><option value="AllStaff">All staff</option>');
                    //$('[id$=resources]').children().first().after('<option value="AllRosteredResource">All rostered resources</option><option value="AllResource">All Resources</option>');
                    $('[id$=teachers]').val('AllRosteredStaff');
                }else if(calView == 'agendaTwoDay'){
                   $("[id$=teachers] option[value='AllRosteredStaff']").remove();
                   $("[id$=teachers] option[value='AllStaff']").remove();
                   $("[id$=resources] option[value='AllRosteredResource']").remove();
                   $("[id$=resources] option[value='AllResource']").remove();
                } 
               $(".teachers").change();
            },10);
        }
        
        /*
                Commenting the update customer functionality due to change in requirment.
                Add Not operator before remoting.
            */
        /*
            function updateCustomer(){
            
                var student = new Object();
                student.id = $('.editCustomerDetails').attr('data-id');
                student.parentId = $('.editCustomerDetails').attr('data-parentId');
                student.firstName = $('#fname').val();
                student.lastName = $('#lname').val();
                student.telephone = $('#telephone').val();
                student.sms = $('#parentsms').val();
                student.parentEmail = $('#parentEmail').val();
                student.type = $('#studentType').val();
                student.parentFirstName = $('#parentfname').val();
                student.parentLastName = $('#parentlname').val();
                if(student){
                    Visualforce.remoting.Manager.invokeAction(
                    '{$RemoteAction.AureusCalendarController.updateStudent}',
                    student,
                        function(result, event){
                            if (event.status) {
                                console.log('result', result);
                                if(result == false){
                                    var b = $('#calendar').fullCalendar('getDate');
                                   var bookDate = [b.format('YYYY-MM-DD')];
                                   teacher = $(".teachers").val();
                                   var calView = $('#calendar').fullCalendar('getView').name;
                                                  
                                   var calendarDates = isWeekDay();
                                   if(calView == 'agendaTwoDay'){
                                       initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                                   }else{
                                       initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                                   }
                                    $('.editCustomerDetails').addClass('slds-hide');
                                     $('.popupDetails').addClass('slds-hide'); 
                                     $('.editDetails').addClass('slds-hide'); 
                                     
                                }
                            }
                        },
                        {escape: true}
                    );
                }
            }*/
        function getCenter(centerVal){
            filter.center = centerVal;
        }
        function getTeacher(teacherVal){
            filter.instrument = '';
            filter.teacher = teacherVal;
            
            if(filter.teacher){
                teacherResourceToggler('teacher');
            }
        }
        function getResource(resourceVal){
            filter.resource = resourceVal;
            if(filter.resource){
                teacherResourceToggler('resource');
            }
            var b = $('#calendar').fullCalendar('getDate');
            var bookDate = [b.format('YYYY-MM-DD')];
            teacher = $(".teachers").val();
            var calView = $('#calendar').fullCalendar('getView').name;
            
            var calendarDates = isWeekDay();
            if(calView == 'agendaTwoDay'){
                initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
            }else{
                initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
            }
        } 
        
        function getInstrument(ins){
            filter.instrument = ins;
            instruments = ins;
            console.log(filter.instrument);
            $('.confirmModal').addClass('slds-hide');
            var b = $('#calendar').fullCalendar('getDate');
            var bookDate = [b.format('YYYY-MM-DD')];
            teacher = $(".teachers").val();
            var calView = $('#calendar').fullCalendar('getView').name;
            
            var calendarDates = isWeekDay();
            if(calView == 'agendaTwoDay'){
                initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
            }else{
                initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
            }
        }
        
        function teacherResourceToggler(toggle){
            if(toggle == 'teacher'){
                $('[id$=resources]').val('');
            }else if(toggle == 'resource'){
                $('[id$=teachers]').val(''); 
            } 
            filter.teacher = $('[id$=teachers]').val(); 
            filter.resource = $('[id$=resources]').val();
        }
        
        function isWeekDay(datesArray){
            datesArray = new Array();
            var currentDate = $('#calendar').fullCalendar('getDate');
            var bookDate = currentDate.format('YYYY-MM-DD');
            
            var beginOfWeek = currentDate.startOf('week');
            var start = beginOfWeek.format('YYYY-MM-DD');
            
            var endOfWeek = currentDate.endOf('week');
            var end = endOfWeek.format('YYYY-MM-DD');
            
            datesArray.push(start);
            datesArray.push(end);
            return datesArray;
        }
        
        function completedOrNoShow(bookingId, type, status){
            console.log(status, bookingId, type);
            if(status && bookingId && type){
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AureusCalendarController.completedOrNoShow}',
                    bookingId, type, status, 
                    function(result, event){
                        if (event.status) {
                            console.log('result', result);
                            if(result){
                                $('.confirmModal').addClass('slds-hide');
                                var b = $('#calendar').fullCalendar('getDate');
                                var bookDate = [b.format('YYYY-MM-DD')];
                                teacher = $(".teachers").val();
                                var calView = $('#calendar').fullCalendar('getView').name;
                                
                                var calendarDates = isWeekDay();
                                if(calView == 'agendaTwoDay'){
                                    initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                                }else{
                                    initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                                }
                            }
                        }
                    }, 
                    {escape: true}
                );
            }
        }  
        
         //Use to create new bookings
        function createBooking(){
            var dateOfBooking = $('#saveNewBooking').attr('data-date');
            console.log('multiple times...');
            bookingData.Repeat = $('#repeatSelect').val();
            console.log('bookingData',bookingData);
            if(bookingData.Repeat == 'None'){
                bookingData.isRecurring = 'false';
            }else{
                bookingData.isRecurring = 'true';
            }
             
            bookingData.RepeatEvery = $('#repeatWeek').val();
            if($('#afterRadio').prop('checked')){
                bookingData.EndsAfter = $('#recurrenceOccure').val();
            }else if($('#onRadio').prop('checked')){
                bookingData.EndsOn = $('#onSelectedDate').val();
            }
            
            $('#saveNewBooking').css('pointer-events','none');
            bookingData.date = dateOfBooking;
            $(createBookingResult.entities).each(function(index5, value5){
                console.log('----bookingData', value5);
                if(value5.type == 'Centre' && value5.name == $('#centerNameLabel').text()){
                    bookingData.centerId = value5.id;
                }else if(value5.type == 'Teacher' && value5.name){
                    bookingData.teacherId = value5.id;
                }
            });
            console.log('bookingData', bookingData);
            bookingData.availableHours = $('#makeupHoursLabel').text().split(' ')[0];
            if(bookingData.type == 'home-trial'){
            
                validationOnCreationOfHomeTrialBookings(bookingData);
            }else if(bookingData.type == 'Makeup' && bookingData.isRecurring == 'false'){
                if(parseInt(bookingData.duration) > parseInt($('#makeupHoursLabel').text().split(' ')[0])){
                    $('#saveNewBooking').css('pointer-events','');
                    $('#makeupHoursErrorMsg').text('Insufficient Makup minutes');
                }else{
                    createBookingProceed();  
                }
            }else if(bookingData.type == 'Adhoc'){
                console.log('In Adhoc section....');
                $('#newBookingDetails').addClass('slds-hide');
                if(bookingData.isRecurring == 'false'){
                    showAdhocBookings(bookingData.studentId, bookingData.packageId, bookingData.date.split('T')[0], bookingData.date.split('T')[1], 1);
                }else if(bookingData.isRecurring == 'true'){
                    countOfBookings(bookingData);
                }
                
            }else{
                createBookingProceed();
            }
           
        }
        
        function showAdhocBookings(student, package, dateOfAppointment, timeOfAppointment, recurring){
            $('#countOfBookingTableBody').empty();
            console.log('teacher ID', filter.teacher);
             Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AureusCalendarController.getPackageDetail}',
                    student, package, filter.teacher, 
                    function(result, event){
                        if (event.status) {
                            console.log('result', result);
                            var trRow = '';
                            var total = 0;
                            $('#studentNameadhoc').html(result.studentFirstName + ' ' + result.studentLastName);
                            $('#teacherNameAdhoc').html(result.teacherName);
                            $('#centerNameadhoc').html(result.centerName);
                            $('#packageDurationadhoc').html(result.duration + ' min');
                            $('#createAdhocBookingBtn').attr({'data-package': result.packageId, 'data-centerId': filter.center, 'data-teacherId': result.teacherId, 'data-studentId': result.studentId, 'data-count': recurring, 'data-date': dateOfAppointment+'T'+timeOfAppointment});
                            /*if(recurring == false){
                                $('#packageUnitsadhoc').html(result.units);
                            }
                            $('#packageFeesadhoc').html('$'+result.unitFee);
                            $('#bookingDateAdhoc').html(dateOfAppointment);
                            $('#bookingTimeAdhoc').html(timeOfAppointment);*/
                            
                            for(var i=1; i<=recurring; i++){
                                total += result.unitFee;
                                trRow += '<tr class="slds-hint-parent"><td data-label="Sr.No"><div class="slds-truncate" title="Sr.No">'+i+'</div></td><td data-label="Package Name"><div class="slds-truncate" title="Package Name">'+result.packageName+'</div></td><td data-label="Package Time"><div class="slds-truncate" title="Package Time">'+timeOfAppointment+'</div></td><td data-label="Package Price"><div class="slds-truncate" title="Package Price">$'+result.unitFee+'</div></td></tr>';
                            } 
                                                       
                            trRow += '<tr class="slds-hint-parent"><td  colspan="2"></td><td data-label="total"><b>Total</b></td><td>$'+total+'</td></tr>';
                            $('#countOfBookingTableBody').append(trRow);
                           $('#newAdhocDetailPopup').removeClass('slds-hide');
                        }
                    }, 
                    {escape: true}
                );
        }
        
        function createAdhocBookings(){
            var packageId = $('#createAdhocBookingBtn').attr('data-package');
            var teacherId = $('#createAdhocBookingBtn').attr('data-teacherId');
            var studentId = $('#createAdhocBookingBtn').attr('data-studentId');
            var recurring = $('#createAdhocBookingBtn').attr('data-count');
            var bookDate = $('#createAdhocBookingBtn').attr('data-date');
            var center = $('#createAdhocBookingBtn').attr('data-centerId');
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.createAdhocBookings}',
                packageId, center,teacherId, studentId, recurring, bookDate,    
                function(result, event){
                    if (event.status) {
                        console.log('result is ', result);
                        if(result){
                             $('#newAdhocDetailPopup').addClass('slds-hide');
                             $('#toastMsg').html('Ad-hoc Bookings are successfully created...');
                             toastLaunch();
                             var b = $('#calendar').fullCalendar('getDate');
                             var bookDate = [b.format('YYYY-MM-DD')];
                             teacher = $(".teachers").val();
                             var calView = $('#calendar').fullCalendar('getView').name;
                            
                             var calendarDates = isWeekDay();
                             if(calView == 'agendaTwoDay'){
                                 initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                             }else{
                                 initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                             }
                             refreshNewBookingPopup();
                        }else{
                             $('#newAdhocDetailPopup').addClass('slds-hide');
                             $('#toastMsg').html('Cannot create Bookings Payment process unsucceeded..');
                             $('.toastclass').removeClass('slds-theme_success');
                             $('.toastclass').addClass('slds-theme_error');
                             toastLaunch();
                             refreshNewBookingPopup();
                        }
                       
                    }
                }, 
                {escape: true}
            );
            console.log('createAdhocBooking...');
            
        }
        
        function countOfBookings(bookingObj){
            //console.log('bookingObj', bookingObj);
            if(bookingObj.isRecurring == 'false'){
                showAdhocBookings(bookingObj.studentId, bookingObj.packageId, bookingObj.date.split('T')[0], bookingObj.date.split('T')[1]);
            }else if(bookingObj.isRecurring == 'true'){
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AureusCalendarController.getCountOfBookings}',
                    bookingObj,
                    function(result, event){
                        if (event.status) {
                            console.log('result is ', result);
                            showAdhocBookings(bookingData.studentId, bookingData.packageId, bookingData.date.split('T')[0], bookingData.date.split('T')[1], result);
                             //$('#packageUnitsadhoc').html(result);
                        }
                    }, 
                    {escape: true}
                );
            }
        }
        
        function validationOnCreationOfHomeTrialBookings(bookingObj){
            if(bookingObj.duration == 30 && bookingObj.type == 'home-trial'){
                console.log('getEventsRealTime', teacher, filter.resource, center, bookingObj.date.split('T')[0], filter.instrument);
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AureusCalendarController.getEventsRealTime}',
                    teacher, filter.resource, center, bookingObj.date.split('T')[0], filter.instrument,
                    function(result, event){
                        if (event.status) {
                            var canCreate = false;
                            eventsOfCalendar = JSON.parse(result.replace(/(&quot\;)/g,"\""));
                            console.log('eventsOfCalendar ...',eventsOfCalendar);
                            canCreate = checkAnyBusyBookings(bookingObj);
                            if(canCreate == true){
                                createBookingProceed();
                            }else{
                                $('#newBookingDetails').addClass('slds-hide');
                                refreshNewBookingPopup();
                                 $('#toastMsg').html('Cannot create Booking Please Remove Existing Booking..');
                                 $('.toastclass').removeClass('slds-theme_success');
                                 $('.toastclass').addClass('slds-theme_error');
                                 toastLaunch();
                            }
                        }
                    }, 
                    {escape: true}
                );
                               
            }
        }
        
        function checkAnyBusyBookings(bookingObj){
            
            var iscorrect = true;
            var startJsDate = toJSDate(bookingObj.date);
            startJsDate.setMinutes(startJsDate.getMinutes() - 30);
            var jsDate = Date.parse(startJsDate);
            startJsDate.setMinutes(startJsDate.getMinutes() + 60);
            var jsDateEnd = Date.parse(startJsDate);
            
            $(eventsOfCalendar).each(function(i, v){
                var start = Date.parse(toJSDate(v.start));
                var end = Date.parse(toJSDate(v.end));
                console.log(jsDate , jsDateEnd );
                if((start <= jsDate && end >= jsDateEnd) || (jsDate <= start && jsDateEnd >= end) || (jsDate > start && jsDateEnd > end && jsDate < end) || (jsDate < start && jsDateEnd < end && jsDateEnd > start)){
                    console.log('not create booking here....');
                    iscorrect = false;
                    return false;
                }
            });
            return iscorrect;
        }
        
        function createBookingProceed(){
            console.log('@@@@@bookingData', bookingData);   
            var bookingDataStr = JSON.stringify(bookingData);
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.createBooking}',
                bookingDataStr, caseId,
                function(result, event){
                    if (event.status) {
                        console.log('result ',result);
                        if(result.caseId){
                            redirectToCaseRecord(result.caseId);    
                        }else if(result.msg == 'false'){
                            $('#newBookingDetails').addClass('slds-hide');
                            refreshNewBookingPopup();
                            $('.confirmModal').removeClass('slds-hide');
                            $('#confirmBody').html('Do you want to send an email?');
                            $('#confirmHeader').html('Email Confirmation');
                            $('#confirmModalYes').attr('data-origin','email');
                            $('#confirmModalNo').attr('data-origin','email');
                        }else if(result.msg == 'duration'){
                            $('#saveNewBooking').css('pointer-events','');
                            $('#makeupHoursErrorMsg').text('Insufficient Makup minutes');
                        }else if(result.msg == 'existing'){
                            $('#newBookingDetails').addClass('slds-hide');
                            refreshNewBookingPopup();
                             $('#toastMsg').html('Cannot create Booking Please Remove Existing Bookings..');
                             $('.toastclass').removeClass('slds-theme_success');
                             $('.toastclass').addClass('slds-theme_error');
                             toastLaunch();
                        }
                    }
                    
                }
            );
        
        }
        
        function sendEmail(){
            var subject = $('#emailSubject').html();
            var body = $('#templateOutput').html();
            var parentId = $('.sendEmail').attr('data-parentId');
            console.log(subject, body, parentId);
            /*Visualforce.remoting.Manager.invokeAction(
                '{$RemoteAction.AureusCalendarController.sendEmail}',
                subject,body, parentId, 
                function(result, event){
                    if (event.status) {
                        console.log('result', result);
                    } else if (event.type === 'exception') {
                        document.getElementById("responseErrors").innerHTML = 
                            event.message + "<br/>\n<pre>" + event.where + "</pre>";
                    } else {
                        document.getElementById("responseErrors").innerHTML = event.message;
                    }
                }, 
                {escape: true}
            );*/
        }
        
        function resetTabs(){
            bookingReschedule.Id = '';
            bookingReschedule.Type = '';
            bookingReschedule.resource = '';
            bookingReschedule.date = '';
            bookingReschedule.Individual = '';
            bookingReschedule.isRecurrence = '';
            bookingReschedule.scheduleType = '';
            $('.customTabs li').removeClass('slds-active');
            $('.customTabs li').first().addClass('slds-active');
            $('.slds-tabs--default__content').addClass('slds-hide');
            $('.slds-tabs--default__content').first().removeClass('slds-hide');
        }
        
        function showTimeOnResourceColumn(listOfResource, view){
            if(!$("tr .fc-widget-content:nth-child(2)").html()){
                var width = Number($('.fc-day-header').width())+3;
                var width1 = Number($('.fc-day').width())+3;
                
                for(var i = 0; i < listOfResource; i++){
                    var left = $("tr .fc-widget-content:nth-child(2)").parent().parent().find('.fc-time').width() + 10;
                    console.log('left = '+left);
                    if(view == 'week'){
                        $( "tr .fc-widget-content:nth-child(2)").append('<td class="temp-cell" style="border: 0px; width:'+(width)+'px; text-align: right; position: relative; right:0px;"></td>');
                    }else{
                       $( "tr .fc-widget-content:nth-child(2)").append('<td class="temp-cell" style="border: 0px; width:'+(width1)+'px; text-align: right; padding-right: 10px; position: relative; right:0px;height:50x;"></td>');
                    }
                }
                $("tr .fc-widget-content:nth-child(2)").children('.temp-cell').each(function(){
                    if($(this).parent().parent().find('.fc-time span').html()){
                        $(this).html($(this).parent().parent().find('.fc-time span').html());
                    }
                });
                
            }
        }
        function closeUpDownSummary(){
            console.log('close upside dounw called');
            let origin = $('#updownsummaryclose').attr('data-origin');
            console.log('origin',origin);
            if(origin == 'upgrade'){
                $('#summaryPopForUpDown').addClass('slds-hide');
                $('#gradeSubscriptionPopup').removeClass('slds-hide');
            }else if(origin == 'downgrade'){
                
                $('#downgradeDetailsSection').addClass('slds-hide');
                $('#summaryPopForUpDown').addClass('slds-hide');
                $('#downgradePopup').removeClass('slds-hide');
            }
        }
        function upgradeSummary (origin){
            console.log('origin',origin);
            var error = false;
            if(origin == 'upgrade'){
                var bookingId = $('#submitUpgradeRequest').attr('data-id');
                var oldPackageId = $('#submitUpgradeRequest').attr('data-packageid');
                var newPackageId = $('#selectRequestedPackage').val();
                var effectiveDate = $('#effectiveDateInput').val();
                console.log('eff',effectiveDate);
                var today = moment();
                if(bookingId && oldPackageId){
                    if(newPackageId == "Upgrade Subscription"){
                        $('#upgradePackageSelectError').html('Please select the package...');
                        error = true;
                    }else{
                        $('#upgradePackageSelectError').html('');
                    }
                    
                    if(!effectiveDate){
                        $('#effectiveDateError').html('Select the effective date....');
                        error = true;
                    }else{
                        var effectiveDateMoment = moment();
                        effectiveDateMoment.year(effectiveDate.split('/')[2]).month(effectiveDate.split('/')[0] - 1).date(effectiveDate.split('/')[1]);
                        if(today.diff(effectiveDateMoment) > 0){
                            $('#effectiveDateError').html('Select Future effective date....');
                            error = true;
                        }else{
                            $('#effectiveDateError').html('');
                        }
                    }
                }
            }else if(origin == 'downgrade'){
                var bookingId = $('#submitDowngradeRequest').attr('data-id');
                
                var startDate = $('#submitDowngradeRequest').attr('startDate');
                var endDate = $('#submitDowngradeRequest').attr('endDate'); // this is last lesson date
                var newPackageId = $('#selectRequestedPackageDowngrade').val();
                var oldPackageId =  $('#submitDowngradeRequest').attr('data-packageid');
                var requestDate = $('#effectiveDateInputDowngrade').val();
                var effectiveDate = $('#submitDowngradeRequest').attr('effectiveDate');
                
                $('#summaryRequestDate1').html(convertDateToMoment(new Date(requestDate)));
                $('#summaryEffectiveLessonDate').html(convertDateToMoment(new Date(effectiveDate)));
                $('#summaryNoticeStartDate1').html(convertDateToMoment(new Date(startDate)));
                $('#summaryNoticeEndDate1').html(convertDateToMoment(new Date(endDate)));
                                
                if(newPackageId == 'Downgrade Subscription'){
                    $('#downgradePackageSelectError').html('Please select any package!');
                    isError = true;
                }else{
                    $('#downgradePackageSelectError').html('');
                }
            
                if(!requestDate){
                    $('#effectiveDateErrorDowngrade').html('Please select the date!');
                    isError = true;
                }
                if(!startDate || !effectiveDate){
                    $('#effectiveDateErrorDowngrade').html('Please define Notice Period!');
                    isError = true;
                }
            }
            
            if(!error){
               $('#updownsummaryclose').attr('data-origin',origin);
               Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getUpgradeDowngradeSummary}',
                    bookingId,oldPackageId,newPackageId,effectiveDate,
                    function(result, event){
                        console.log('result',result);
                        if(result){
                            $('#oldPackageName').html(result.oldPack.Name);
                            $('#newPackageName').html(result.newPack.Name);
                            $('#lessonWithOldPackage').html(result.noOfBookingWithOldPack);
                            $('#lessonWithNewPackage').html(result.noOfBookingWithNewPack);
                                
                            if(origin == 'upgrade'){
                                $('#summaryPopForUpDown').removeClass('slds-hide');
                                $('#gradeSubscriptionPopup').addClass('slds-hide');
                            }else if(origin == 'downgrade'){
                                $('#downgradeDetailsSection').removeClass('slds-hide');
                                $('#summaryPopForUpDown').removeClass('slds-hide');
                                $('#downgradePopup').addClass('slds-hide');
                            }
                        }
                    });  
            }
            
        }
        function submitUpgradePackageRequest(){
            var error = false;
            var bookingId = $('#submitUpgradeRequest').attr('data-id');
            var oldPackageId = $('#submitUpgradeRequest').attr('data-packageid');
            var newPackageId = $('#selectRequestedPackage').val();
            var effectiveDate = $('#effectiveDateInput').val();
            var today = moment();
            if(bookingId && oldPackageId){
                if(newPackageId == "Upgrade Subscription"){
                    $('#upgradePackageSelectError').html('Please select the package...');
                    error = true;
                }else{
                    $('#upgradePackageSelectError').html('');
                }
                
                if(!effectiveDate){
                    $('#effectiveDateError').html('Select the effective date....');
                    error = true;
                }else{
                    var effectiveDateMoment = moment();
                    effectiveDateMoment.year(effectiveDate.split('/')[2]).month(effectiveDate.split('/')[0] - 1).date(effectiveDate.split('/')[1]);
                    if(today.diff(effectiveDateMoment) > 0){
                        $('#effectiveDateError').html('Select Future effective date....');
                        error = true;
                    }else{
                        $('#effectiveDateError').html('');
                    }
                }
                if(!error){
                    $('#submitUpgradeRequest').css('pointer-events','none');
                    $('#submitUpgradeRequest').attr('disabled','true');
                    Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AureusCalendarController.updatePackageOfCustomer}',
                        bookingId, effectiveDate, newPackageId, oldPackageId,
                        function(result, event){
                        
                            console.log('result... ', result);
                            if(!result){
                                 $('#toastMsg').html('Request failure!<br/>Please try again....');
                                 $('.toastclass').removeClass('slds-theme_success');
                                 $('.toastclass').addClass('slds-theme_error');
                                 toastLaunch();
                            }else if(result){
                                updatePackageCallout(bookingId, effectiveDate, newPackageId, oldPackageId);
                            }
                        }
                    );
                } 
            }
            
            console.log('parameters....');
        }
        
        function updatePackageCallout(bookingId, effectiveDate, newPackageId, oldPackageId){
            /*Visualforce.remoting.Manager.invokeAction(
            '{$RemoteAction.AureusCalendarController.updatePackageRequestCallout}',
                bookingId, effectiveDate, newPackageId, oldPackageId,
                function(result, event){
                    console.log('result... ', result);
                    $('#gradeSubscriptionPopup').addClass('slds-hide');
                    if(result){
                         $('#toastMsg').html('Request saved successfully!<br/>The change will be done from midnight of the request date....');
                         $('.toastclass').addClass('slds-theme_success');
                         $('.toastclass').removeClass('slds-theme_error');
                         toastLaunch();
                    }else if(!result){
                         $('#toastMsg').html('Request failure!<br/>Please try again....');
                         $('.toastclass').removeClass('slds-theme_success');
                         $('.toastclass').addClass('slds-theme_error');
                         toastLaunch();
                    }
                    var b = $('#calendar').fullCalendar('getDate');
                    var bookDate = [b.format('YYYY-MM-DD')];
                    teacher = $(".teachers").val();
                    var calView = $('#calendar').fullCalendar('getView').name;
                    
                    var calendarDates = isWeekDay();
                    if(calView == 'agendaTwoDay'){
                        initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                    }else{
                        initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                    } 
                }
            );*/
        }
        
        function addBusyTimeFunc(){
            $('#descriptionBusyCreate').val('');
            $('#newBookingModal').addClass('slds-hide');
            $('#durationSelectBusyCreate').empty();
            var centerId = $('#addBusyTime').attr('data-centerid');
            var centerName = $('.centerList option:selected').text();
            var teacherId =  $('#addBusyTime').attr('data-teacherid');
            var teacherName = $('.teachers option:selected').text();
            var time = $('#addBusyTime').attr('data-date');
            var selectDuration = '';
            for(var i=30;i<=120;i=i+15){
                selectDuration += '<option value="'+i+'">'+i+' Mins</option>';
            }
            $('#centerNameBusyCreate').html(centerName);
            $('#durationSelectBusyCreate').append(selectDuration);
            $('#staffBusyCreate').html(teacherName);
            $('#timeSlotBusyCreate').html(convertDateToMoment(time.split('T')[0]) + ' '+ convertTimeToMoment(time.split('T')[1].split(':')[0], time.split('T')[1].split(':')[1]));
            
            
            $('#saveBusyBookingCreate').attr({'data-centerId': centerId, 'data-teacherId': teacherId, 'data-date': time});
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getPickListValues}',
                'Booking__c', 'Category__c', 
                function(result, event){
                    console.log('result', result);
                    if(result){
                        
                        $('#categorySelectBusyCreate').empty();
                        var categoryStr = '';
                        $(result).each(function(index, value){
                            categoryStr += '<option value="'+value+'">'+value+'</option>'
                        });                                                                      
                        console.log('result ', result);
                        $('#categorySelectBusyCreate').append(categoryStr);
                        $('#busyBookingCreateModal').removeClass('slds-hide');
                    }
                }, 
                {escape: true}
            );            
        }
        
        
        function getCancelRequestDateFunc(){
            var bookingId = $('#cancelSubscriptionBtn').attr('data-id');
            var effectiveDate = $('#cancelRequestDate').val();
            if($('#cancelByRequestDate').prop('checked') && bookingId && effectiveDate){
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getNoticePeriod}',
                 bookingId, effectiveDate, 
                    function(result, event){
                        if(result){
                            console.log('result',result);
                            if('startDate' in result && 'endDate' in result && 'effectiveDate' in result){
                                var startDate = moment(result.startDate);
                                var endDate = moment(result.endDate);
                                var effectiveDate = moment(result.effectiveDate);
                                $('#noticePeriodStart').html(startDate.format('ddd, MMM DD YYYY'));
                                $('#noticePeriodEnd').html(endDate.format('ddd, MMM DD YYYY'));
                                $('#lastLessonDate').val(endDate.format('MM/DD/YYYY'));
                                $('#submitCancelRequest').attr({'startDate' : startDate.format('YYYY-MM-DD'), 'endDate' : endDate.format('YYYY-MM-DD'), 'effectiveDate': effectiveDate.format('YYYY-MM-DD')});                               
                            }else if('error' in result){
                                //$('#effectiveDateErrorDowngrade').html(result.error);
                                console.log('result error...', result.error);
                            }
                        }
                    }    
                );
                /*console.log('cancel request ', $('#cancelRequestDate').val());
                var noticePeriodStart = $('#cancelRequestDate').val();
                var noticePeriodEnd;
                if(noticePeriodStart){
                    var startDate = moment();
                    var endDate = moment();
                    
                    endDate.year(noticePeriodStart.split('/')[2]).month(noticePeriodStart.split('/')[0] - 1).date(noticePeriodStart.split('/')[1]);
                    startDate.year(noticePeriodStart.split('/')[2]).month(noticePeriodStart.split('/')[0] - 1).date(noticePeriodStart.split('/')[1]);
                    console.log('dt',startDate );
                    startDate.add(1, 'd');
                    endDate.add(1, 'M');
                    noticePeriodStart = startDate.format('DD/MM/YYYY');
                    noticePeriodEnd = endDate.format('DD/MM/YYYY');
                    $('#noticePeriodStart').text(noticePeriodStart);
                    $('#noticePeriodEnd').text(noticePeriodEnd);
                    
                    if(timeslot){
                        timeslot = timeslot.split(' ')[1].slice(0, 3);
                        console.log('timeslot', timeslot);
                        console.log('endDate',endDate);
                        console.log('startDate',startDate);
                        startDate.subtract(1, 'days')
                        for (var m = endDate; m.isAfter(startDate); m.subtract(1, 'days')) {
                            console.log(m.format('ddd'));
                            if(m.format('ddd').toUpperCase() == timeslot){
                                $('#lastLessonDate').val(m.format('MM/DD/YYYY'));
                                return;
                            }
                        }
                    } 
                }*/
            }
        }
        
        function getLastLessonDateFunc(){
            var bookingId = $('#cancelSubscriptionBtn').attr('data-id');
            var effectiveDate = $('#lastLessonDate').val();            
            //TimeSlot Every TUE@11:00AM
            /*var timeslot = $('#cancelSubscriptionBtn').attr('data-timeslot');
            console.log('timeslot', timeslot);
            if($('#cancelByLessonEndDate').prop('checked')){
                console.log('cancel request ', $('#lastLessonDate').val());
                 var noticePeriodStart = $('#lastLessonDate').val();
                    var noticePeriodEnd;
                    if(noticePeriodStart){
                        var startDate = moment();
                        var endDate = moment();
                        endDate.year(noticePeriodStart.split('/')[2]).month(noticePeriodStart.split('/')[0] - 1).date(noticePeriodStart.split('/')[1]);
                        startDate.year(noticePeriodStart.split('/')[2]).month(noticePeriodStart.split('/')[0] - 1).date(noticePeriodStart.split('/')[1]);
                        endDate.subtract(1, 'months');
                        $('#cancelRequestDate').val(endDate.format('MM/DD/YYYY'));
                        $('#noticePeriodStart').text(endDate.add(1, 'days').format('YYYY/MM/DD'));
                        startDate.subtract(1, 'months');
                        $('#noticePeriodEnd').text(startDate.format('YYYY/MM/DD'));
                        
                    }
            }*/
            if($('#cancelByLessonEndDate').prop('checked')){
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getNoticePeriodByEndDate}',
                 bookingId, effectiveDate, 
                    function(result, event){
                        if(result){
                            console.log('result',result);
                            if('startDate' in result && 'endDate' in result && 'requestDate' in result && 'effectiveDate' in result){
                                var startDate = moment(result.startDate);
                                var endDate = moment(result.endDate);
                                var effectivDate = moment(result.effectiveDate);
                                var requestDate = moment(result.requestDate);
                                $('#noticePeriodStart').html(startDate.format('ddd, MMM DD YYYY'));
                                $('#noticePeriodEnd').html(endDate.format('ddd, MMM DD YYYY'));
                                $('#cancelRequestDate').val(requestDate.format('MM/DD/YYYY'));
                                $('#submitCancelRequest').attr({'startDate' : startDate.format('YYYY-MM-DD'), 'endDate' : endDate.format('YYYY-MM-DD'), 'effectivDate' : effectivDate.format('YYYY-MM-DD')});                               
                            }else if('error' in result){
                                //$('#effectiveDateErrorDowngrade').html(result.error);
                                console.log('result error...', result.error);
                            }
                        }
                    }    
                );
            }
        }
        
        function saveBusyBookingFunc(){
            var centerId = $('#saveBusyBookingCreate').attr('data-centerid');
            var teacherId =  $('#saveBusyBookingCreate').attr('data-teacherid');
            var time = $('#saveBusyBookingCreate').attr('data-date');
            var countOfOccurence = 0;
            if($('#repeatSelectBusy').val() == 'None'){
                countOfOccurence = 1;
            }else if($('#repeatSelectBusy').val() == 'Weeks'){
                if($('#afterRadioBusy').prop('checked')){
                    countOfOccurence = $('#recurrenceOccureBusy').val();
                }else if($('#onRadioBusy').prop('checked')){
                    var dt = $('#onSelectedDateBusy').val();
                    var startDate = moment(time.split('T')[0]);
                    var duplicate = moment(time.split('T')[0]);
                    var enddate = moment();
                    if(dt){
                        enddate.year(dt.split('/')[2]).month(dt.split('/')[0] - 1).date(dt.split('/')[1]);
                        while(startDate <= enddate){
                            if(startDate.format('ddd') == duplicate.format('ddd')){
                                countOfOccurence++;
                            }
                            console.log('startDate.format(ddd)',startDate.format('ddd'));
                            startDate.add(1, 'days');
                        }
                    }
                    
                    
                }
            }
            
            
            console.log(centerId, teacherId, time, countOfOccurence);
            
            Visualforce.remoting.Manager.invokeAction(
            '{!$RemoteAction.AureusCalendarController.createBusyAppointments}',
                centerId, teacherId, time, $('#durationSelectBusyCreate').val(), $('#descriptionBusyCreate').val(), $('#categorySelectBusyCreate').val(), countOfOccurence, 
                function(result, event){
                    console.log('result... ', result);
                    if(!result){
                        $('#busyBookingCreateModal').addClass('slds-hide');
                        $('#descriptionBusyCreate').val('');
                        var b = $('#calendar').fullCalendar('getDate');
                        var bookDate = [b.format('YYYY-MM-DD')];
                        teacher = $(".teachers").val();
                        var calView = $('#calendar').fullCalendar('getView').name;
                        
                        var calendarDates = isWeekDay();
                        if(calView == 'agendaTwoDay'){
                            initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                        }else{
                            initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                        } 
                    }
                }
            );
        }
        
        function cancelBy(){
            if($('#cancelByRequestDate').prop('checked')){
                $('#cancelRequestDate').removeAttr('disabled');
                $('#lastLessonDate').attr('disabled',true);
                $('#lastLessonDate').val('');
            }else if($('#cancelByLessonEndDate').prop('checked')){
                $('#cancelRequestDate').attr('disabled',true);
                $('#lastLessonDate').removeAttr('disabled');
                $('#cancelRequestDate').val('');
            }
            if($('#lastLessonDate').val() == '' && $('#cancelRequestDate').val() == ''){
                $('#noticePeriodStart').text('');
                $('#noticePeriodEnd').text('');
            }
        }
        
        function getBusyBookingDetails(bookingId, startTime){
            $('#centerNameBusyView').html('');
            $('#timeSlotBusyView').html('');
            $('#durationBusyView').html('');
            $('#staffBusyView').html('');
            $('#descriptionBusyView').val('');
            $('#categoryBusyView').html('');
            if(bookingId){
                 Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getBusyBookingDetails}',
                 bookingId,
                    function(result, event){
                        if(result){
                            console.log('result... ', result);
                            $('#centerNameBusyView').html(result.center);
                            $('#categoryBusyView').html(result.category);
                            if(result.timeOfBooking){
                                $('#timeSlotBusyView').html(convertDateToMoment(result.timeOfBooking.split(' ')[0])+ ' '+result.timeOfBooking.split(' ')[1]);
                            }
                            
                            $('#durationBusyView').html(result.duration + ' mins');
                            $('#staffBusyView').html(result.teacher);
                            $('#descriptionBusyView').val(result.discription);
                            
                            $('.addNewBookingFromBusy').attr({'data-centerId' : result.centerId, 'data-teacherId' : result.teacherId, 'data-date' : startTime});
                            
                            $('#busyBookingViewModal').removeClass('slds-hide');
                        }
                    }    
                );
            }
        }
        
        function cancelBusyAppointment(){
            $('#busyBookingViewModal').addClass('slds-hide');
            $('#cancelBooking').trigger( "click" );
        }
        
        function getNoticePeriod(){
            $('#noticePeriodDowngradeStart').html('');
            $('#noticePeriodDowngradeEnd').html('');
            $('#effectiveDateErrorDowngrade').html('');
            $('#submitDowngradeRequest').removeAttr('startDate');
            $('#submitDowngradeRequest').removeAttr('endDate');
            $('#submitDowngradeRequest').removeAttr('effectiveDate');
            
            var bookingId = $('#downgradeSubscriptionBtn').attr('data-id');
            var effectiveDate = $('#effectiveDateInputDowngrade').val();
            console.log(bookingId, effectiveDate);
            if(effectiveDate){
                var today = moment();
                var dt = moment();
                dt.year(effectiveDate.split('/')[2]).month(effectiveDate.split('/')[0] - 1).date(effectiveDate.split('/')[1]);
                console.log('dt',dt);
                if(today.diff(dt) > 0){
                    console.log('past');
                }
            }
            if(bookingId && effectiveDate){
                 Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getNoticePeriod}',
                 bookingId, effectiveDate, 
                    function(result, event){
                        if(result){
                            console.log('result',result);
                            if('startDate' in result && 'endDate' in result && 'effectiveDate' in result){
                                var startDate = moment(result.startDate);
                                var endDate = moment(result.endDate);
                                var effectiveDate = moment(result.effectiveDate);
                                $('#noticePeriodDowngradeStart').html(startDate.format('ddd, MMM DD YYYY'));
                                $('#noticePeriodDowngradeEnd').html(endDate.format('ddd, MMM DD YYYY'));
                                $('#submitDowngradeRequest').attr({'startDate' : startDate.format('YYYY-MM-DD'), 'endDate' : endDate.format('YYYY-MM-DD'), 'effectiveDate' : effectiveDate.format('YYYY-MM-DD')});                               
                            }else if('error' in result){
                                $('#effectiveDateErrorDowngrade').html(result.error);
                            }
                        }
                    }    
                );
             }
             
        }
        
        function submitDowngradePackageRequest(){
            var isError = false;
            var bookingId = $('#submitDowngradeRequest').attr('data-id');
            var startDate = $('#submitDowngradeRequest').attr('startDate');
            var endDate = $('#submitDowngradeRequest').attr('endDate');
            var newPackageId = $('#selectRequestedPackageDowngrade').val();
            var effectiveDate = $('#submitDowngradeRequest').attr('effectiveDate');
            var requestDate = $('#effectiveDateInputDowngrade').val();
            if(newPackageId == 'Downgrade Subscription'){
                $('#downgradePackageSelectError').html('Please select any package!');
                isError = true;
            }
            
            if(!requestDate){
                $('#effectiveDateErrorDowngrade').html('Please select the date!');
                isError = true;
            }
            
            if(!effectiveDate){
                isError = true;
            }
            
            if(!startDate || !endDate){
                $('#effectiveDateErrorDowngrade').html('Please define Notice Period!');
                isError = true;
            }
            
            if(!isError){
                 var requestDateMoment = moment();
                 requestDateMoment.year(requestDate.split('/')[2]).month(requestDate.split('/')[0] - 1).date(requestDate.split('/')[1]);
                  Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.downgradeSubscriptionRequest}',
                 bookingId, newPackageId, effectiveDate, requestDateMoment.format('YYYY-MM-DD'), startDate, endDate, 
                    function(result, event){
                        $('#downgradePopup').addClass('slds-hide');
                        if(result){
                             $('#toastMsg').html('Request saved successfully!');
                             $('.toastclass').addClass('slds-theme_success');
                             $('.toastclass').removeClass('slds-theme_error');
                             toastLaunch();
                        }else if(!result){
                             $('#toastMsg').html('Request failure!');
                             $('.toastclass').removeClass('slds-theme_success');
                             $('.toastclass').addClass('slds-theme_error');
                             toastLaunch();
                        }
                        var b = $('#calendar').fullCalendar('getDate');
                        var bookDate = [b.format('YYYY-MM-DD')];
                        teacher = $(".teachers").val();
                        var calView = $('#calendar').fullCalendar('getView').name;
                        
                        var calendarDates = isWeekDay();
                        if(calView == 'agendaTwoDay'){
                            initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                        }else{
                            initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                        } 
                    }    
                );
                 
            }
            
        }
        
        function cancelSubscription(){
            $('#cancelByRequestDate').prop('checked', false);
            $('#cancelByLessonEndDate').prop('checked', false);
            $('#lastLessonDate').attr('disabled',true);
            $('#lastLessonDate').val('');
            $('#cancelRequestDate').attr('disabled',true);
            $('#cancelRequestDate').val('');
            $('#advanceOptionPopup').addClass('slds-hide');
            $('#noticePeriodStart').html('');
            $('#noticePeriodEnd').html('');
            $('#canelSubscriptionPopup').removeClass('slds-hide');
            
        }
        function withdrawSummary(){
            var isError = false;
            var bookingId = $('#cancelSubscriptionBtn').attr('data-id');
            var startDate = $('#submitCancelRequest').attr('startDate');
            var endDate = $('#submitCancelRequest').attr('endDate');
            var requestDate = $('#cancelRequestDate').val();
            var effectiveDate = $('#submitCancelRequest').attr('effectivedate');
            if(!bookingId || !requestDate || !effectiveDate || !startDate || !endDate){
                isError = true;
            }
            if(!isError){
                console.log('show summary popup');
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getCancellationDetails}',
                 bookingId, endDate, 
                    function(result, event){
                        if(result){
                            console.log('total number of lesson'+result);
                            $('#summaryRequestDate').html(convertDateToMoment(new Date(requestDate)));
                            $('#summaryLastLessonDate').html(convertDateToMoment(new Date(endDate)));
                            $('#summaryNoticeStartDate').html(convertDateToMoment(new Date(startDate)));
                            $('#summaryNoticeEndDate').html(convertDateToMoment(new Date(endDate)));
                            $('#summaryNoOfLessonFromDeposit').html(result);
                            $('#summaryPopForAdvanceAction').removeClass('slds-hide');
                            $('#canelSubscriptionPopup').addClass('slds-hide');
                        }else{
                            console.log('event',event);
                        }
                    });
            }
        }
        
        function submitCancelPackageRequest(){
            var isError = false;
            var bookingId = $('#cancelSubscriptionBtn').attr('data-id');
            var startDate = $('#submitCancelRequest').attr('startDate');
            var endDate = $('#submitCancelRequest').attr('endDate');
            var requestDate = $('#cancelRequestDate').val();
            var effectiveDate = $('#submitCancelRequest').attr('effectivedate');
            if(!bookingId){
                isError = true;
            }
            
            if(!requestDate){
                isError = true;
            }
            
            if(!effectiveDate){
                //$('#effectiveDateErrorDowngrade').html('Please select the date!');
                isError = true;
            }
            
            if(!startDate || !endDate){
                //$('#effectiveDateErrorDowngrade').html('Please define Notice Period!');
                isError = true;
            }
            
             if(!isError){
                 var requestDateMoment = moment();
                 requestDateMoment.year(requestDate.split('/')[2]).month(requestDate.split('/')[0] - 1).date(requestDate.split('/')[1]);
                  Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.cancelSubscriptionRequest}',
                 bookingId, effectiveDate, requestDateMoment.format('YYYY-MM-DD'), startDate, endDate, 
                    function(result, event){
                        $('#canelSubscriptionPopup').addClass('slds-hide');
                        if(result){
                             $('#toastMsg').html('Request saved successfully!<br/> Please fill the feedback form');
                             $('.toastclass').addClass('slds-theme_success');
                             $('.toastclass').removeClass('slds-theme_error');
                             toastLaunch();
                        }else if(!result){
                             $('#toastMsg').html('Request failure!');
                             $('.toastclass').removeClass('slds-theme_success');
                             $('.toastclass').addClass('slds-theme_error');
                             toastLaunch();
                        }
                        var b = $('#calendar').fullCalendar('getDate');
                        var bookDate = [b.format('YYYY-MM-DD')];
                        teacher = $(".teachers").val();
                        var calView = $('#calendar').fullCalendar('getView').name;
                        
                        var calendarDates = isWeekDay();
                        if(calView == 'agendaTwoDay'){
                            initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
                        }else{
                            initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
                        } 
                    }
                 );
             }
        }
        // get the string date in yyyy-mm-dd
        
        //Get the date in yyyy-mm-dd format 
        // and return in ddd, MMM DD YYYY
        function convertDateToMoment(date){
            var dd = moment(date);
            console.log('dd', dd.format('ddd, MMM DD YYYY'));
            return dd.format('ddd, MMM DD YYYY');
        }
        
        //Get the time in  hh:mm AM/PM
        function convertTimeToMoment(hour, minute){
            var tt = moment();
            tt.minute(minute).hours(hour);
            return tt.format('hh:mm A');
        }
        
        //Refresh the calendar with existing dates
        function refreshCalendar(){
            var b = $('#calendar').fullCalendar('getDate');
            var bookDate = [b.format('YYYY-MM-DD')];
            teacher = $(".teachers").val();
            var calView = $('#calendar').fullCalendar('getView').name;
            
            var calendarDates = isWeekDay();
            if(calView == 'agendaTwoDay'){
                initResources(center, teacher, filter.resource, calendarDates, calView, filter.instrument);
            }else{
                initResources(center, teacher, filter.resource, bookDate, calView, filter.instrument);
            } 
        }
        // show/Hide menu
        function showHideMenu(){
            console.log($('header'));
            //$('.system-message').hide();
            //console.log($('.oneSystemMessage .level-info').lenght);
            //$('.oneSystemMessage .level-info').css('display','none');  
              console.log(parent);    
              var x = parent.document.getElementsByClassName('oneHeader')[0];
              if (x.style.display === "none") {
                x.style.display = "block";
              } else {
                x.style.display = "none";
              }
        }
        //Show case details on blue bar
        function getCaseDetails(caseid){
            if(caseid){
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getCaseDetails}',
                 caseid,
                    function(result, event){
                        if(result){
                            console.log('Case Id', result);
                            if('Id' in result && 'CaseNumber' in result){
                                $('#caseNo').attr('href', '/'+result.Id);
                                $('#caseNo').text(result.CaseNumber);
                            }
                            if('Type' in result){
                                $('#caseType').text(result.Type);
                            }   
                            if('Contact' in result){
                                if('Name' in result.Contact && 'Id' in result.Contact){
                                    $('#caseParentName').attr('href', '/'+result.Contact.Id);
                                    $('#caseParentName').text(result.Contact.Name);
                                }
                            } 
                            $('#caseContainerMessage').removeClass('slds-hide');
                        }
                    }
                 );
            }
        }
        
        function getUserDetails(){
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AureusCalendarController.getCenterUsers}',
                    function(result, event){
                        if(result){
                            userDetail  = result;
                            
                            if('Designation__c' in result){
                                if(result.Designation__c== 'Center Admin'){
                                    //console.log('inside designation',$('#cancelRequestDate').length);
                                    $('#cancelRequestDate').datepicker({
                                        initDate: moment(), //Today Date
                                        format: 'YYYY-MM-DD', //Date Format Of Datepicker Input Field
                                        minDate: -1,
                                        onChange: function(datepicker) {
                                        $('#cancelRequestDate').html('Selected Date: <strong>'+moment(datepicker.selectedFullDate._d).format('YYYY-MM-DD')+'</strong>');
                                       }
                                    });
                                }else{
                                    //console.log('not a center admin');
                                    $('#cancelRequestDate').datepicker({
                                        initDate: moment(), //Today Date
                                        format: 'YYYY-MM-DD', //Date Format Of Datepicker Input Field
                                        onChange: function(datepicker) {
                                        $('#cancelRequestDate').html('Selected Date: <strong>'+moment(datepicker.selectedFullDate._d).format('YYYY-MM-DD')+'</strong>');
                                       }
                                    });
                                }
                            }
                        }
                    }
                 );
        }
        
        //Close Case container
        function closeCaseContainer(){
            $('#caseContainerMessage').addClass('slds-hide');
            caseId = '';
        }
        function redirectToCaseRecord(caseIdToRedirect){
            console.log('redirectocase ' +caseIdToRedirect);
            window.location.href = "/"+caseIdToRedirect;
        }
        
        function showMessageForCancellation(){
            $('#errorMsgReason').html('');
            $('#errorMsgRemark').html('');
            let reason = $('#cancelReason').val();
            if(reason == 'Student MC'){
                $('#errorMsgReason').html('To avail makeup credits student needs to submit MC with in 7 days.');
            }
        }
        </script>
        
    </html>
</apex:component>