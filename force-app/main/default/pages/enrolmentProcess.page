<apex:page id="pg" Controller="EnrolmentProcessController" showHeader="false" standardStylesheets="true" sidebar="false" docType="html-5.0" applyBodyTag="False" applyHtmlTag="False">
    <head>
        <title>Aureus Academy â€“ New Enrolment</title>
       
        <!--<apex:slds /> -->
         <!-- IntlInputPhone CSS -->
        <apex:stylesheet value="{!URLFOR($Resource.IntlInputPhone, '/css/intlInputPhone.min.css')}"/>
        <apex:stylesheet value="{!URLFOR($Resource.SLDS283, '/styles/salesforce-lightning-design-system.min.css')}"/>
        <!-- Updated by Rajesh, 31st July 2019: To Solve increase field length when click in inputfield in mobile devices-->
        <!--<meta name="viewport" content="width=device-width, initial-scale=1.0"/>-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0"/>
        <apex:stylesheet value="{!URLFOR($Resource.Jquery_plugin, '/Jquery_plugin/jquery-ui.css')}"/>
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous" />
        <apex:includeScript value="{!URLFOR($Resource.Jquery_plugin, '/Jquery_plugin/jquery/jquery.js')}"/>
        <apex:includeScript value="{!URLFOR($Resource.Jquery_plugin, '/Jquery_plugin/jquery-ui.js')}"/>
        <!-- IntlInputPhone JS -->
        <apex:includeScript value="{!URLFOR($Resource.IntlInputPhone, '/js/intlInputPhone.min.js')}"/>
        
        <!--<script src="https://checkout.stripe.com/checkout.js"></script>-->
        <script src="https://js.stripe.com/v3/"></script>
        
        <link rel="stylesheet" href="{!URLFOR($Resource.Signature,'Signature/signature-pad.css')}"/>  
        <script src="{!URLFOR($Resource.Signature,'Signature/signature_pad.js')}"></script>
         
        <script>
       
        $(document).ready(function() {        
            var slcdDat = '{!lessonWrap.lessonSlcdDate}';
            var slcdSlot = '{!lessonWrap.lessonSlctSlot}';
            
            if(slcdDat.length > 0 && slcdSlot.length > 0){
                loadCalendarOnTchrSelect();
            }else{
                $( "#datepicker" ).datepicker({
                    inline: true,
                    minDate:0,
                    dateFormat: 'dd/mm/yy',
                    beforeShowDay: disableDayOnIntial
                });
            }
            
            //Increase years in date picker
            var select = document.getElementById('calYearPicker');
            if (select){
                select.innerHTML = '';
                var startYear = new Date().getFullYear() - 118;
                for (var year = startYear; year < startYear + 118; year++) {
                    select.options[select.options.length] = new Option(year, year);
                }
            }
            var cntryCode = '{!countryCode}';
            $('[id$=inputMobileId]').intlInputPhone({preferred_country: [cntryCode]}); 
            var mobNumber = '{!PersonMobilePhoneCustom}';
            $('[id$=phoneNumber]').val(mobNumber.replace(/^\+[0-9]{2}/,'')); 
        });
        
        function disableDayOnIntial(date) {
            return [true, 'ui-datepicker-unselectable ui-state-disabled'];
        }
        
        function onCompleteShowThirdStep(){
            var concatePhoneNoNew = '+' + $('[class$=btn-cc]').html().match(/\d+/);
            concatePhoneNoNew += $('[id$=phoneNumber]').val();
            console.log('%%%%%concatePhoneNoNew-----> '+concatePhoneNoNew);
            document.getElementById('mobId').innerHTML = concatePhoneNoNew;
        }
        function showSecondStep(){
            var firstCheck = true;
            var secondCheck = true;
            
            $('.inputtxt').each(function(){
                if(!$(this).val()){
                    $(this).parent().parent().addClass('slds-has-error');
                    $(this).parent().next().removeClass('slds-hide');
                    firstCheck = false;
                }else{
                    $(this).parent().parent().removeClass('slds-has-error');
                    $(this).parent().next().addClass('slds-hide');
                }
            });                
            
            $('.inputsel').each(function(){
                if(!$(this).val()){
                    $(this).parent().parent().parent().parent().addClass('slds-has-error');
                    $(this).parent().parent().next().removeClass('slds-hide');
                    secondCheck = false;
                }else{
                    $(this).parent().parent().parent().parent().removeClass('slds-has-error');
                    $(this).parent().parent().next().addClass('slds-hide');
                }
            });
            
            if(!(firstCheck || secondCheck))
                return;
            
            
            //Validating mobile number
            /*var mobileNumber = $('[id$=mobilePhn]').val();
            if(!mobileNumber.match(/^\d+/)){
                $('.firstCmpErrDiv').removeClass('slds-hide');
                $('.contentDivFirst').html('Mobile Phone should be in numbers.');
                return;
            }else{
                $('.firstCmpErrDiv').addClass('slds-hide');
            }*/
            
            //Validating Email address
            var emailVal = $('[id$=emailtxt]').val();
            var reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
            if (reg.test(emailVal) == false){
                $('.firstCmpErrDiv').removeClass('slds-hide');
                $('.contentDivFirst').html('Invalid email address.');
                return;
            }else{
                $('.firstCmpErrDiv').addClass('slds-hide');
            }
            
            if(firstCheck && secondCheck){
                if($('[id$=studentAsCstmr]').prop('checked')){
                    $('[id$=stuFstNameId]').val($('[id$=parFstNameId]').val());
                    $('[id$=stuLstNameId]').val($('[id$=parLstNameId]').val());
                    $('[id$=stuGendrId]').val($('[id$=parGendrId]').val());
                    $('[id$=stuNationalityId]').val($('[id$=parNationalityId]').val());
                }
                fillStuWhenParentAsCstmr();
                
                nextOnSecondPage();
                
                document.getElementById('secondCmpId').style.display = 'block';
                document.getElementById('firstCmpId').style.display = 'none';
                /*
                var slcdDat = '{!lessonWrap.lessonSlcdDate}';
                var slcdSlot = '{!lessonWrap.lessonSlctSlot}';
                
                if(slcdDat.length > 0 && slcdSlot.length > 0){
                    secondScreenForTrail();
                }*/
            }else{
                return;
            }
            // document.getElementById('secondCmpId').style.display = 'block';
            // document.getElementById('firstCmpId').style.display = 'none';
        }
        
        function fillStuWhenParentAsCstmr(){
            var stuAsCstmr = $('[id$=studentAsCstmr]').prop('checked');
           
            $('[id$=stuFstNameId]').prop('disabled', stuAsCstmr);
            $('[id$=stuLstNameId]').prop('disabled', stuAsCstmr);
            $('[id$=stuGendrId]').prop('disabled', stuAsCstmr);
            $('[id$=stuNationalityId]').prop('disabled', stuAsCstmr);
        }
        
        function editLson(stuIndx, lessIndx){
            editLsonStu(stuIndx, lessIndx);
    
            if(stuIndx == 0){
                setTimeout(function(){ fillStuWhenParentAsCstmr(); }, 1000);
            }
        }

        function addLessonsOnPage(){
             $('.thirdCmpErrDiv').addClass('slds-hide');
        
            var firstCheck = false;
            var secondCheck = false;
            
            $('.stuDetClass').each(function(){
                var isDisabled = $(this).prop('disabled');
                if(!isDisabled && !$(this).val()){
                    $(this).parent().parent().addClass('slds-has-error');
                    $(this).parent().next().removeClass('slds-hide');
                    firstCheck = true;
                }else{
                    $(this).parent().parent().removeClass('slds-has-error');
                    $(this).parent().next().addClass('slds-hide');
                }
            });
            
            $('.lessDetClass').each(function(){
                var isDisabled = $(this).prop('disabled');
                if(!isDisabled && !$(this).val()){
                    $(this).parent().parent().addClass('slds-has-error');
                    $(this).parent().next().removeClass('slds-hide');
                    secondCheck = true;
                }else{
                    $(this).parent().parent().removeClass('slds-has-error');
                    $(this).parent().next().addClass('slds-hide');
                }
            });
            
            var today = new Date();
            var birthDate = $('[id$=birthdate]').val();
            var temoBirthDay = birthDate.split('/');
            var birthDay = new Date(temoBirthDay[2], temoBirthDay[1]-1, temoBirthDay[0])
            
            if(birthDay>today){
                $('.thirdCmpErrDiv').removeClass('slds-hide');
                $('.contentDivThird').html('Birthdate should not be in future.');
                return;
            }else{
                $('.thirdCmpErrDiv').addClass('slds-hide');
            }
             
            if(!firstCheck && !secondCheck){            
                var isDisabledStuInput  = $('.stuDetClass').prop('disabled');
                var isDisabledLessInput = $('.lessDetClass').prop('disabled');
                
                if(isDisabledStuInput && isDisabledLessInput){
                     $('.thirdCmpErrDiv').removeClass('slds-hide');
                     $('.contentDivThird').html('Please add more student first.');
                     return false;
                }
                 
                 var slcdTSlot = $("input[name='radio']:checked").val();
                 
                 if(!slcdTSlot){
                     //alert('');
                     $('.thirdCmpErrDiv').removeClass('slds-hide');
                     $('.contentDivThird').html('Please select a time slot.');
                     return;
                 }
                
                addLessons(slcdTSlot);
            }
            //addLessons(slcdTSlot);  
        }
        
        function saveStudentOrLesson(){
            //Check validation 
            
            var firstCheck = false;
            var secondCheck = false;
            
            $('.stuDetClass').each(function(){
                var isDisabled = $(this).prop('disabled');
                if(!isDisabled && !$(this).val()){
                    $(this).parent().parent().addClass('slds-has-error');
                    $(this).parent().next().removeClass('slds-hide');
                    firstCheck = true;
                }else{
                    $(this).parent().parent().removeClass('slds-has-error');
                    $(this).parent().next().addClass('slds-hide');
                }
            });
            
            $('.lessDetClass').each(function(){
                var isDisabled = $(this).prop('disabled');
                if(!isDisabled && !$(this).val()){
                    $(this).parent().parent().addClass('slds-has-error');
                    $(this).parent().next().removeClass('slds-hide');
                    secondCheck = true;
                }else{
                    $(this).parent().parent().removeClass('slds-has-error');
                    $(this).parent().next().addClass('slds-hide');
                }
            });
            
            var today = new Date();
            var birthDate = $('[id$=birthdate]').val();
            var temoBirthDay = birthDate.split('/');
            var birthDay = new Date(temoBirthDay[2], temoBirthDay[1]-1, temoBirthDay[0])
            
            if(birthDay>today){
                $('.thirdCmpErrDiv').removeClass('slds-hide');
                $('.contentDivThird').html('Birthdate should not be in future.');
                return;
            }else{
                $('.thirdCmpErrDiv').addClass('slds-hide');
            }
            
            if(!firstCheck && !secondCheck){        
                 var slcdTSlot = $("input[name='radio']:checked").val();
                 
                 if(!slcdTSlot){
                     //alert('');
                     $('.thirdCmpErrDiv').removeClass('slds-hide');
                     $('.contentDivThird').html('Please select a time slot.');
                     return;
                 }
                    
                saveStuLsonGrid(slcdTSlot);
            }
        }
        
        function closeErrorDiv(){
            $('.thirdCmpErrDiv').addClass('slds-hide');
        }
        
        /*function clearStudentSection(){
            $(".stuDetClass").prop('disabled', true);
            $(".lessDetClass").prop('disabled', true);
            
            loadCalendarOnTchrSelect();
        }*/
        
        function addStudentsAndLess(){            
            var isDisabledStuInput  = $('.stuDetClass').prop('disabled');
            var isDisabledLessInput = $('.lessDetClass').prop('disabled');
            
            if(isDisabledStuInput && isDisabledLessInput){
                addStudentsAndLessons();
            }else{
                //alert('Please save the current record first.');    
                $('.thirdCmpErrDiv').removeClass('slds-hide');
                $('.contentDivThird').html('Please save the current record first.');
                return;
            }
        }
        
        //---------------------------Third page functions-----------------------------------------
        function showThirdStep(){
            var isDisabledStuInput  = $('.stuDetClass').prop('disabled');
            var isDisabledLessInput = $('.lessDetClass').prop('disabled');
            
            if(isDisabledStuInput && isDisabledLessInput){
                document.getElementById('thirdCmpId').style.display = 'block';
                document.getElementById('secondCmpId').style.display = 'none'; 
                
                thirdScreenFeeCal();
            }else{
                //alert('Please save the current record first.');    
                $('.thirdCmpErrDiv').removeClass('slds-hide');
                $('.contentDivThird').html('Please save the current record first.');
                return;
            }
        }
        
        
        /*   function completeEnr(){
              $('.inputchk').each(function(){
            
                if(!$(this).prop('checked')){
                    $(this).parent().parent().parent().addClass('slds-has-error');
                    $(this).parent().parent().next().removeClass('slds-hide');
                    
                }else{
                    $(this).parent().parent().parent().removeClass('slds-has-error');
                    $(this).parent().parent().next().addClass('slds-hide');
                    
                    completeEnrolment();
                }
            });
        }*/
    </script>
        
    </head>
    
    <body class="slds-scope ">
            <!--
            <apex:actionFunction name="save" action="{!save}" reRender="frm">
                <apex:param name="arg" value="" assignTo="{!base64Img}"/>
            </apex:actionFunction>-->
            
            <div class="main-content">
                <div class="slds-grid slds-wrap slds-grid--pull-padded0 slds-grid--align-center container">
                    
                </div>
                <div class="slds-grid slds-wrap slds-grid--align-center">
                    <div class="slds-col content-box">
                        <div class="header slds-col">
                            <div class="slds-col">
                                <a href="#" class="logo"><img src="https://aureusacademy.com/wp-content/uploads/2017/03/cropped-Aureus-Logo-Small.png"/></a>
                            </div>
                        </div>
                            <apex:form id="frm">
                                <apex:actionStatus id="spinner">
                                    <apex:facet name="start"> 
                                        <apex:outputPanel id="backdrop" styleClass="popupBackground">
                                            <div role="status" class="slds-spinner slds-spinner_brand slds-spinner_large"> 
                                                <div class="slds-spinner__dot-a"></div>
                                                <div class="slds-spinner__dot-b"></div>
                                            </div>
                                        </apex:outputPanel>
                                    </apex:facet>
                                </apex:actionStatus>
                                
                                <apex:outputPanel id="loadCalendarPanel">
                                    <script>      
                                        var slot;
                                        
                                        function loadCalendar(){ 
                                             
                                             $( "#datepicker" ).datepicker({
                                                inline: true,
                                                minDate:0,
                                                dateFormat: 'd/m/yy',
                                                beforeShowDay: disableDayOnIntial
                                            });  
                                        }
                                        
                                        function loadCalendarOnTchrSelect(){    
                                            
                                            var tSl = '{!lessonWrap.lessonSlctSlot}';
                                            
                                            if(tSl){
                                                $("input[name='radio'][value='"+tSl+"']").attr('checked', 'checked');
                                            }
                                           
                                            var slfet = '{!tSlotStr}' ;
                                           
                                            if(slfet)                                     
                                                slot = JSON.parse(slfet);                   
                                            else
                                                slot = '';
                                            
                                             $( "#datepicker" ).datepicker({
                                                inline: true,
                                                minDate:0,
                                                dateFormat: 'd/m/yy',
                                                beforeShowDay: highlightDays,
                                                defaultDate : '{!lessonWrap.lessonSlcdDate}',
                                                onSelect: function(dateText, inst) {
                                                    refreshSlot(dateText);
                                                }
                                            });  
                                        }
                                        
                                        
                                        function highlightDays(date) {
                                            
                                            var st = date.getDate()+'/'+(date.getMonth()+1)+'/'+date.getFullYear();
                                            //alert( st);
                                            //alert( slot[st]);
                                            
                                            if(slot[st]){
                                                var isMrgAvl = slot[st].isAvlMrgSlot;
                                                var isAfternoonAvl = slot[st].isAvlAfternoonSlot;  
                                            
                                                if(isMrgAvl && isAfternoonAvl){
                                                     return [true, 'day-availability--morning day-availability--afternoon'];
                                                }else if(isMrgAvl){
                                                    return [true, 'day-availability--morning'];
                                                }else if(isAfternoonAvl){
                                                    return [true, 'day-availability--afternoon'];
                                                }
                                            }
                                            
                                            return [true, 'ui-datepicker-unselectable ui-state-disabled'];
                                        }
                                        
                                        function addLessLoadCalendar(){
                                            $(".stuDetClass").prop('disabled', true);
                                            loadCalendar();
                                        }
                                    
                                    </script>
                                      
                                </apex:outputPanel>
                                <apex:outputPanel id="disablePannel">
                                    <script>
                                        function clearStudentSection(){
                                            var isWithFreeTrial    = '{!isFreeTrialOpp}';
                                            var manageFreeTrialList = {!manageFreeTrialList};
                                            // alert(manageFreeTrialList);
                                            if(isWithFreeTrial == 'false' || manageFreeTrialList < 0){
                                                $(".stuDetClass").prop('disabled', true);
                                                $(".lessDetClass").prop('disabled', true);
                                            }
                                            
                                            loadCalendarOnTchrSelect();
                                        }
                                    </script>
                                </apex:outputPanel>
                                
                                <apex:actionFunction name="nextOnSecondPage" action="{!nextSecondPage}" status="spinner" reRender="emailtxt" />
                                
                                <apex:actionFunction name="getPlans" action="{!fetchPlans}" reRender="lessonPanal,loadCalendarPanel" oncomplete="loadCalendar();" status="spinner">
                                    <!--<apex:param name="indexVal" value="" assignTo="{!selectedIndex}"/>-->
                                </apex:actionFunction>
                                
                                <apex:actionFunction name="getTeachers" action="{!fetchTeachers}" reRender="lessonPanal,loadCalendarPanel" oncomplete="loadCalendar();" status="spinner">
                                    <!--<apex:param name="indexVal" value="" assignTo="{!selectedIndex}"/>-->
                                </apex:actionFunction>
                                
                                <apex:actionFunction name="getTimeSlot" action="{!fetchTimeSlot}" reRender="lessonPanal,loadCalendarPanel" oncomplete="loadCalendarOnTchrSelect();" status="spinner">
                                    <!--<apex:param name="indexVal" value="" assignTo="{!selectedIndex}"/>-->
                                </apex:actionFunction>
                                
                                <apex:actionFunction name="refreshSlot" action="{!refreshSlots}" reRender="refreshSlotPanel" status="spinner">
                                    <apex:param name="slcdDt" value="xy" assignTo="{!lessonWrap.lessonSlcdDate}"/> 
                                </apex:actionFunction>
                                
                                <apex:actionFunction name="addStudentsAndLessons" action="{!addMoreStudentsAndLessons}" oncomplete="loadCalendar();" reRender="studentListPnl" status="spinner"/>
                                <apex:actionFunction name="addLessons" action="{!addMoreLessons}" oncomplete="addLessLoadCalendar();" reRender="studentListPnl" status="spinner">
                                    <apex:param name="slcdDt" value="xy" assignTo="{!lessonWrap.lessonSlctSlot}"/> 
                                </apex:actionFunction>
                                
                                <apex:actionFunction name="deleteLson" action="{!deleteLesson}" oncomplete="loadCalendar();" reRender="studentListPnl,loadCalendarPanel" status="spinner">
                                    <apex:param name="slcdStu" value="0" assignTo="{!selectedStudentIndex}"/> 
                                    <apex:param name="slcdLess" value="0" assignTo="{!selectedLessonIndex}"/> 
                                    <apex:param name="isDel" value="delRowBtn" assignTo="{!buttonType}"/> 
                                </apex:actionFunction>
                                <apex:actionFunction name="editLsonStu" action="{!editLesson}" oncomplete="loadCalendarOnTchrSelect();" reRender="studentListPnl,loadCalendarPanel" status="spinner">
                                    <apex:param name="slcdStu" value="0" assignTo="{!selectedStudentIndex}"/> 
                                    <apex:param name="slcdLess" value="0" assignTo="{!selectedLessonIndex}"/> 
                                    <apex:param name="isEdit" value="EditRowBtn" assignTo="{!buttonType}"/> 
                                </apex:actionFunction>
                                <apex:actionFunction name="saveStuLsonGrid" action="{!saveStuAndLessonOnGrid}" oncomplete="checkFreeTrilsIsAvl();" reRender="studentListPnl,loadCalendarPanel" status="spinner">
                                    <apex:param name="slcdDt" value="xy" assignTo="{!lessonWrap.lessonSlctSlot}"/> 
                                </apex:actionFunction>   
                                <apex:actionFunction name="checkFreeTrilsIsAvl" action="{!checkTrialAvl}" oncomplete="clearStudentSection();" reRender="disablePannel" status="spinner"/>
                                        
                                
                                <!--<apex:actionFunction name="secondScreenForTrail" reRender="loadCalendarPanel"  oncomplete="loadCalendarOnTchrSelect();" status="spinner"/>-->
                                <apex:actionFunction name="thirdScreenFeeCal" action="{!thirdScreenFeeCalculation}"  reRender="ThirdScreenPanel" status="spinner" oncomplete="onCompleteShowThirdStep();return false;"/>
                                <apex:actionFunction name="completeEnrolment" action="{!completeEnrolment}" oncomplete="checkError();return false;"  reRender="ThirdScreenPanel" status="spinner">
                                    <apex:param name="arg" value="" assignTo="{!base64SignImg}"/>
                                    <apex:param name="arg1" value="" assignTo="{!stripeToken}"/>
                                    <apex:param name="arg2" value="" assignTo="{!PersonMobilePhoneCustom}"/>
                                </apex:actionFunction>      
                        
                            
                                <!-------  First block  Start ------------------->
                                <div class="firstCmpcls" id="firstCmpId">
                                    <div class="slds-col "><span class="main-title">NEW ENROLMENT</span></div>
                                    <div class="content-body slds-col">
                                        <div class="slds-form-element">
                                            <div class="slds-notify_container slds-is-relative slds-hide firstCmpErrDiv">
                                                <div class="slds-notify slds-notify_toast slds-theme_error slds-m-left_none slds-m-right_medium" role="status">
                                                    <div class="slds-notify__content">
                                                        <h2 class="slds-text-heading_small contentDivFirst"></h2>
                                                    </div>
                                                    <div class="slds-notify__close">
                                                        <button class="slds-button slds-button_icon slds-button_icon-inverse" onclick=" $('.firstCmpErrDiv').addClass('slds-hide');return false;" title="Close">
                                                           X
                                                          <span class="slds-assistive-text">Close</span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <fieldset class="slds-form-element final-step">
                                                <div class="slds-form-element">
                                                    <div class="slds-grid slds-wrap ">
                                                        <label class="slds-form-element__label field-title slds-col slds-size_1-of-1 slds-p-horizontal_medium">Parent Information</label>
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label f-title">First Name <abbr class="slds-required" title="required">* </abbr></label>
                                                                <div class="slds-form-element__control">
                                                                    <!--<input type="text" class="slds-input inputtxt" required="" />-->
                                                                    <apex:inputText value="{!parentAccWrap.firstName}" id="parFstNameId" styleclass="slds-input inputtxt"/>
                                                                </div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label f-title">Last Name <abbr class="slds-required" title="required">* </abbr></label>
                                                                <div class="slds-form-element__control">
                                                                    <!--<input type="text" class="slds-input inputtxt" required="" />-->
                                                                    <apex:inputText value="{!parentAccWrap.lastName}" id="parLstNameId" styleclass="slds-input inputtxt"/>
                                                                </div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label f-title">Gender <abbr class="slds-required" title="required">* </abbr></label>
                                                                <div class="slds-form-element__control">
                                                                    <div class="slds-select_container">
                                                                        <!--<apex:inputText value="{!parentAccWrap.gender}" id="parGendrId" styleclass="slds-select inputsel"/>-->
                                                                        <apex:selectList id="parGendrId" value="{!parentAccWrap.gender}" size="1" styleclass="slds-select inputsel">
                                                                            <apex:selectOptions value="{!AccoungGenderPicklist}"/>
                                                                        </apex:selectList>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label f-title">Mobile <abbr class="slds-required" title="required">* </abbr></label>
                                                                <!--<div class="slds-form-element__control">
                                                                    <input type="text" class="slds-input inputtxt" required="" />
                                                                    <apex:inputText value="{!parentAccWrap.mobile}" styleclass="slds-input inputtxt" id="mobilePhn"/>
                                                                </div> -->
                                                                <div id="slds-form-element__control inputMobileId"></div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label f-title">Nationality <abbr class="slds-required" title="required">* </abbr></label>
                                                                <div class="slds-form-element__control">
                                                                    <div class="slds-select_container">
                                                                        <!--<apex:inputText value="{!parentAccWrap.Nationality}" id="parNationalityId" styleclass="slds-select inputsel"/>-->
                                                                        <apex:selectList id="parNationalityId" value="{!parentAccWrap.Nationality}" size="1" styleclass="slds-select inputsel">
                                                                            <apex:selectOptions value="{!AccoungNationalityPicklist}"/>
                                                                        </apex:selectList>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        <!--
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label f-title">Phone</label>
                                                                <div class="slds-form-element__control">
                                                                    <apex:inputText value="{!parentAccWrap.Phone}" styleclass="slds-input"/>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label f-title">Occupation</label>
                                                                <div class="slds-form-element__control">
                                                                    <apex:inputText value="{!parentAccWrap.Occupation}" styleclass="slds-input"/>
                                                                </div>
                                                            </div>
                                                        </div>-->
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label f-title">Email <abbr class="slds-required" title="required">* </abbr></label>
                                                                <div class="slds-form-element__control">
                                                                    <!-- <input type="email" class="slds-input inputtxt" required="" />-->
                                                                    <apex:inputText value="{!parentAccWrap.Email}" disabled="{!isFreeTrialOpp}"  styleclass="slds-input inputtxt" id="emailtxt"/>
                                                                </div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label  f-title">Address <abbr class="slds-required" title="required">* </abbr></label>
                                                                <div class="slds-form-element__control">
                                                                    <!--<input type="text" class="slds-input inputtxt" required="" />-->
                                                                    <apex:inputText value="{!parentAccWrap.Address}" styleclass="slds-input inputtxt"/>
                                                                </div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label  f-title">City</label>
                                                                <div class="slds-form-element__control">
                                                                    <!-- <input type="text" class="slds-input" />-->
                                                                    <apex:inputText value="{!parentAccWrap.city}" styleclass="slds-input"/>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label  f-title">Postal Code <abbr class="slds-required" title="required">* </abbr></label>
                                                                <div class="slds-form-element__control">
                                                                    <!--<input type="text" class="slds-input inputtxt" required="" />-->
                                                                    <apex:inputText value="{!parentAccWrap.BillingPostalCode}" styleclass="slds-input inputtxt"/>
                                                                </div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        <!--
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label  f-title">Country <abbr class="slds-required" title="required">* </abbr></label>
                                                                <div class="slds-form-element__control">
                                                                    <apex:inputField value="{!parentAcc.BillingCountry}" styleclass="slds-input inputtxt"/>
                                                                </div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        -->
                                                         <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label f-title">Country <abbr class="slds-required" title="required">* </abbr></label>
                                                                <div class="slds-form-element__control">
                                                                    <div class="slds-select_container">
                                                                        <!--<apex:inputText value="{!parentAccWrap.BillingCountryCode}" styleclass="slds-select inputsel"/>-->
                                                                        <apex:selectList value="{!parentAccWrap.BillingCountryCode}" size="1" styleclass="slds-select inputsel">
                                                                            <apex:selectOptions value="{!AccoungBillCntryPicklist}"/>
                                                                        </apex:selectList>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <div class="slds-checkbox">
                                                                    <apex:inputCheckbox id="studentAsCstmr" value="{!isParAlsoAStudent}" disabled="{!isFreeTrialOpp}" styleClass="slds-checkbox"/>
                                                                    <label class="slds-checkbox__label" for="pg:frm:studentAsCstmr">
                                                                        <span class="slds-checkbox_faux"></span>
                                                                        <span class="slds-form-element__label" style="font-size: 14px !important;">  Also a Student</span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </div> 
                                                    </div>
                                                </div>
                                            </fieldset>
                                            <div class="slds-col slds-size_1-of-1  slds-p-horizontal_medium">
                                                <a class="slds-button custom-btn" onclick="showSecondStep();return false;">Next</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-------  First block  End ------------------->
                                
                                <!-------  Second block  Start ------------------->
                                <div class="secondCmpcls" id="secondCmpId" style="display:none;">
                                    <div class="slds-col "><span class="main-title">NEW ENROLMENT</span></div>
                                    <div class="content-body slds-col">
                                        <div class="slds-form-element">
                                            
                                           <!-- <div class="slds-notify_container slds-is-relative slds-hide thirdCmpErrDiv">
                                                <div class="slds-notify slds-notify_toast slds-theme_error slds-m-left_none slds-m-right_medium" role="status">
                                                    <div class="slds-notify__content">
                                                        <h2 class="slds-text-heading_small contentDivThird"></h2>
                                                    </div>
                                                </div>
                                            </div>-->
                                           
                                              <div class="slds-notify_container slds-is-relative slds-hide thirdCmpErrDiv" style="padding: 0 15px;">
                                                <div class="slds-notify slds-notify_toast slds-theme_error slds-col" role="status" style="width:100%;margin:0 0 10px;">
                                                  <span class="slds-assistive-text">error</span>
                                                  <div class="slds-notify__content">
                                                    <h2 class="slds-text-heading_small contentDivThird"></h2>
                                                  </div>
                                                  <div class="slds-notify__close">
                                                    <button class="slds-button slds-button_icon slds-button_icon-inverse" title="Close" onclick="closeErrorDiv(); return false;">
                                                       X
                                                      <span class="slds-assistive-text" >Close</span>
                                                    </button>
                                                  </div>
                                                </div>
                                              </div>
                                            
                                            
                                            <fieldset class="slds-form-element final-step">
                                                <apex:outputPanel id="studentListPnl">
                                                    <div class=" slds-size_1-of-1 slds-p-horizontal_medium">
                                                        <div class="slds-form-element">
                                                            <label class="slds-form-element__label field-title" for="form-element-help-01">Enrolments Information</label>
                                                            
                                                            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                                <thead>
                                                                    <tr class="slds-line-height_reset student-list">
                                                                        <th class="slds-text-title_caps" scope="col" style="text-align:center;">
                                                                            <div class="slds-truncate" title="Confidence">Edit Details</div>
                                                                        </th>
                                                                        <th class="slds-text-title_caps" scope="col">
                                                                            <div class="slds-truncate" title="Opportunity Name">Student Name</div>
                                                                        </th>
                                                                        <th class="slds-text-title_caps" scope="col">
                                                                            <div class="slds-truncate" title="Account Name">Center/Location</div>
                                                                        </th>
                                                                        <th class="slds-text-title_caps" scope="col">
                                                                            <div class="slds-truncate" title="Close Date">Teacher</div>
                                                                        </th>
                                                                        <th class="slds-text-title_caps" scope="col">
                                                                            <div class="slds-truncate" title="Stage">Lesson Plan</div>
                                                                        </th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <apex:variable value="{!0}" var="stuIndex"/>
                                                                    <apex:repeat value="{!studentWrapList}" var="student">
                                                                        <apex:variable value="{!0}" var="lessIndex"/>
                                                                        <apex:repeat value="{!student.lessonList}" var="lesson">
                                                                            <tr class="slds-hint-parent student-list">
                                                                                <td>
                                                                                    <div class="slds-truncate" style="text-align: center;">
                                                                                        <a href="#" onclick="editLson('{!stuIndex}','{!lessIndex}')" style="margin-right:10px;"><i class="fas fa-pencil-alt"></i></a>
                                                                                        <apex:outputPanel rendered="{!!(isFreeTrialOpp && stuIndex == 0  && lessIndex ==0)}">
                                                                                            <a href="#" onclick="deleteLson('{!stuIndex}','{!lessIndex}')" class="del-btn"><i class="fas fa-times "></i></a>
                                                                                        </apex:outputPanel>
                                                                                    </div>    
                                                                                    <apex:variable value="{!lessIndex+1}" var="lessIndex"/>  
                                                                                </td>
                                                                                <td scope="row">
                                                                                    <div class="slds-truncate">{!student.stuAccWrap.FirstName} {!student.stuAccWrap.LastName}</div>
                                                                                </td>
                                                                                <td>
                                                                                    <div class="slds-truncate">{!lesson.selectedCenterName}</div>
                                                                                </td>
                                                                                <td>
                                                                                    <div class="slds-truncate">{!lesson.selectedTeacherName}</div>
                                                                                </td>
                                                                                <td>
                                                                                    <div class="slds-truncate">{!lesson.selectedPlanName}</div>
                                                                                </td>                                                                                
                                                                            </tr>
                                                                        </apex:repeat>                                                                   
                                                                        <apex:variable value="{!stuIndex+1}" var="stuIndex"/>
                                                                    </apex:repeat>
                                                                      
                                                                </tbody>
                                                            </table>
                                                            
                                                            <div class="slds-col slds-size_1-of-1 add-more ">
                                                                <button onclick="addStudentsAndLess();return false">Add More Students <i class="fas fa-plus"></i></button>
                                                            </div>
                                                            
                                                        </div>
                                                        
                                                        <label class="slds-form-element__label field-title" for="form-element-help-01 slds-size_1-of-1 slds-p-horizontal_medium">Student Information</label>
                                                        <div class="student-box slds-grid slds-wrap">
                                                            <div class="edit-del" style="display:none;">
                                                                <a href="#" class="del-btn"><i class="fas fa-times "></i></a><a href="#"> <i class="fas fa-pencil-alt"></i></a><button class="del-btn" href="#"><i class="fas fa-check"></i></button> 
                                                            </div>
                                                            <label class="slds-form-element__label field-title slds-size_1-of-1 slds-p-horizontal_medium" for="form-element-help-01">New Student</label>
                                                            <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                <div class="slds-form-element">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label f-title">First Name <abbr class="slds-required" title="required">* </abbr></label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputText value="{!studentWrap.stuAccWrap.FirstName}" id="stuFstNameId" styleClass="slds-input stuDetClass"/>
                                                                        </div>
                                                                        <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                <div class="slds-form-element">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label f-title">Last Name <abbr class="slds-required" title="required">* </abbr></label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputText value="{!studentWrap.stuAccWrap.LastName}" id="stuLstNameId" styleClass="slds-input stuDetClass"/>
                                                                        </div>
                                                                        <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                <div class="slds-form-element">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label f-title">Birthdate <abbr class="slds-required" title="required">* </abbr></label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!studentWrap.enrBirthdateField.Trial_Date__c}" id="birthdate" styleClass="slds-input stuDetClass" style="width:100%;"/>
                                                                            <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                                        </div>
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label f-title" for="form-element-help-01">Gender <abbr class="slds-required" title="required">* </abbr></label>
                                                                    <div class="slds-form-element__control">
                                                                        <div class="slds-select_container">
                                                                            <!--
                                                                            <apex:inputField value="{!studentWrap.student.Gender__c}"  styleClass="slds-select stuDetClass"/>
                                                                            -->
                                                                            <apex:selectList value="{!studentWrap.stuAccWrap.gender}" size="1" id="stuGendrId" styleclass="slds-select stuDetClass">
                                                                                <apex:selectOptions value="{!AccoungGenderPicklist}"/>
                                                                            </apex:selectList>
                                                                         </div>
                                                                        <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label f-title" for="form-element-help-01">Nationality <abbr class="slds-required" title="required">* </abbr></label>
                                                                    <div class="slds-form-element__control">
                                                                        <div class="slds-select_container">
                                                                            <!--<apex:inputField value="{!studentWrap.student.Nationality__c}" id="stuNationalityId" styleClass="slds-select stuDetClass"/>-->
                                                                            <apex:selectList value="{!studentWrap.stuAccWrap.Nationality}" size="1" id="stuNationalityId" styleclass="slds-select stuDetClass">
                                                                                <apex:selectOptions value="{!AccoungNationalityPicklist}"/>
                                                                            </apex:selectList>
                                                                        </div>
                                                                        <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                <div class="slds-form-element">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label f-title">School <!--<abbr class="slds-required" title="required">* </abbr>--></label>
                                                                        <apex:selectList value="{!studentWrap.stuAccWrap.school}" size="1" id="stuSchId" styleclass="slds-select stuDetClass">
                                                                            <apex:selectOptions value="{!SchoolPicklist}"/>
                                                                        </apex:selectList>
                                                                        <!--<div class="slds-form-element__control">
                                                                            <apex:inputText value="{!studentWrap.stuAccWrap.school}" styleClass="slds-input stuDetClass"/>
                                                                        </div>
                                                                        <div class="slds-form-element__help slds-hide errortxt">This field is required</div>-->
                                                                    </div>
                                                                </div>
                                                            </div>
                                                          <!-- <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                <div class="slds-form-element">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label f-title">Grade</label>
                                                                        <div class="slds-form-element__control">
                                                                            <div class="slds-select_container">
                                                                                <apex:inputField value="{!studentWrap.student.Level_Grade__c}" styleClass="slds-select stuDetClass"/>
                                                                            </div>
                                                                            <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            -->
                                                            <label class="slds-form-element__label field-title slds-size_1-of-1 slds-p-horizontal_medium" for="form-element-help-01">Lesson Information</label>
                                                            <apex:outputPanel id="lessonPanal">
                                                               <!-- <apex:variable value="{!0}" var="i"/>
                                                                <apex:repeat value="{!studentWrap.lessonList}" var="lesson">-->
                                                                    <div class="another-box ">
                                                                        <div class="slds-col  slds-size_1-of-1 slds-grid slds-wrap">
                                                                            <div class="slds-form-element slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                                <div class="slds-form-element">
                                                                                    <label class="slds-form-element__label f-title">Center/Location <abbr class="slds-required" title="required">* </abbr></label>
                                                                                    <div class="slds-form-element__control">
                                                                                        <div class="slds-select_container">
                                                                                            <apex:selectList styleClass="slds-select lessDetClass" multiselect="false" size="1" value="{!lessonWrap.selectedCenter}" onchange="getTeachers();"> 
                                                                                                <apex:selectOptions value="{!lessonWrap.centerOptions}"/>
                                                                                            </apex:selectList>
                                                                                        </div>
                                                                                        <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            
                                                                           <div class="slds-form-element slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                               <div class="slds-form-element">
                                                                                    <label class="slds-form-element__label f-title">Teacher <abbr class="slds-required" title="required">* </abbr></label>
                                                                                    <div class="slds-form-element__control">
                                                                                        <div class="slds-select_container">
                                                                                            <apex:selectList styleClass="slds-select lessDetClass" multiselect="false" size="1" value="{!lessonWrap.selectedTeacher}" onchange="getPlans();"> 
                                                                                                <apex:selectOptions value="{!lessonWrap.teacherOptions}"/>
                                                                                            </apex:selectList>
                                                                                        </div>
                                                                                        <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="slds-form-element slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                                <div class="slds-form-element">
                                                                                    <label class="slds-form-element__label f-title">Lesson Plan <abbr class="slds-required" title="required">* </abbr></label>
                                                                                    <div class="slds-form-element__control">
                                                                                        <div class="slds-select_container">
                                                                                            <apex:selectList styleClass="slds-select lessDetClass" multiselect="false" size="1" value="{!lessonWrap.selectedPlan}" onchange="getTimeSlot();"> 
                                                                                                <apex:selectOptions value="{!lessonWrap.planOptions}"/>
                                                                                            </apex:selectList>
                                                                                        </div>
                                                                                        <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>                                                                           
                                                                        </div>
                                                                        
                                                                        <div class="custom-calendar slds-col slds-size_1-of-1 slds-grid slds-wrap">
                                                                            <label class="slds-form-element__label slds-size_1-of-1 field-title slds-p-horizontal_medium" for="form-element-help-01">Time Available</label>
                                                                            <div class="slds-form-element slds-dropdown-trigger slds-dropdown-trigger_click slds-is-open  slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                                <apex:outputPanel id="datePickPanel">
                                                                                    <div id="datepicker" class=""></div>
                                                                                </apex:outputPanel> 
                                                                            </div>
                                                                            
                                                                           
                                                                                <div class="slds-grid slds-wrap slds-p-horizontal_medium  slds-size_1-of-1 slds-medium-size_6-of-12">
                                                                                     <apex:outputPanel id="refreshSlotPanel" style="width:100%;">
                                                                                    <div class="calc slds-grid slds-wrap date-list">
                                                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12">
                                                                                            <fieldset class="slds-form-element">
                                                                                              <label class="slds-form-element__label field-title time-title" for="form-element-help-01">Morning</label>
                                                                                              <div class="slds-form-element__control">
                                                                                                <div class="time-list morning">
                                                                                                  <apex:repeat value="{!tSlotMap.morningSlot}" var="ins">
                                                                                                     <span class="slds-button slds-radio_button">
                                                                                                        <input id="{!ins}" name="radio" type="radio" value="{!ins}" />
                                                                                                        <label class="slds-radio_button__label" for="{!ins}">
                                                                                                          <span class="slds-radio_faux">{!ins}</span>
                                                                                                        </label>
                                                                                                     </span>
                                                                                                  </apex:repeat>
                                                                                                </div>
                                                                                              </div>
                                                                                            </fieldset>
                                                                                        </div>
                                                                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12">
                                                                                            <fieldset class="slds-form-element">
                                                                                              
                                                                                              <div class="slds-form-element__control">
                                                                                                <label class="slds-form-element__label field-title time-title" for="form-element-help-01">Afternoon</label>
                                                                                                <div class="time-list afternoon">
                                                                                                  <apex:repeat value="{!tSlotMap.afternoonSlot}" var="ins">
                                                                                                     <span class="slds-button slds-radio_button">
                                                                                                        <input name="radio" type="radio" id="{!ins}" value="{!ins}"/>
                                                                                                        <label class="slds-radio_button__label" for="{!ins}">
                                                                                                            <span class="slds-radio_faux">{!ins}</span>
                                                                                                        </label>
                                                                                                     </span>
                                                                                                  </apex:repeat>  
                                                                                                </div>
                                                                                              </div>
                                                                                            </fieldset>
                                                                                        </div>
                                                                                    </div>
                                                                                    </apex:outputPanel> 
                                                                                </div>
                                                                            <!--<button class="slds-button custom-btn save-btn">Save</button>-->
                                                                        </div>
                                                                        
                                                                        <button class="slds-button custom-btn save-btn" onclick="saveStudentOrLesson();return false;">Save</button>
                                                                    </div>
                                                                  <!--  <apex:variable value="{!i+1}" var="i"/>    
                                                                </apex:repeat>-->
                                                            </apex:outputPanel>
                                                            <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                <a class="slds-button custom-btn more-lesson" onclick="addLessonsOnPage();return false;">Add another lesson</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                <div class="slds-clearfix"></div>
                                            </fieldset>
                                            <div class="slds-col slds-size_1-of-1 slds-p-horizontal_medium">
                                                <a  class="slds-button custom-btn prev-btn" onclick="document.getElementById('firstCmpId').style.display = 'block';document.getElementById('secondCmpId').style.display = 'none';">Previous</a> 
                                                
                                                <a  class="slds-button custom-btn"  onclick="showThirdStep();return false;">Next</a>
                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>                           
                                <!-------  Second block  End ------------------->
                            </apex:form>
                            
                            <!-------  Third block  Start ------------------->
                            <div class="thirdCmpcls" id="thirdCmpId" style="display:none;"> 
                                   <div class="slds-col "><span class="main-title">NEW ENROLMENT</span></div>
                                   <apex:outputPanel id="ThirdScreenPanel">
                                        <div class="content-body slds-col">
                                            
                                            <div class="slds-form-element">
                                                <div class="slds-notify_container slds-is-relative slds-hide paymentCmpErrDiv">
                                                <div class="slds-notify slds-notify_toast slds-theme_error slds-m-left_none slds-m-right_medium" role="status">
                                                    <div class="slds-notify__content">
                                                        <h2 class="slds-text-heading_small contentPaymentCmpErrDiv"></h2>
                                                    </div>
                                                    
                                                    <div class="slds-notify__close">
                                                        <button class="slds-button slds-button_icon slds-button_icon-inverse" onclick=" $('.paymentCmpErrDiv').addClass('slds-hide');return false;" title="Close">
                                                           X
                                                          <span class="slds-assistive-text">Close</span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                                <div class="slds-form-element">
                                                    <label class="slds-form-element__label field-title slds-size_1-of-1 slds-p-horizontal_medium" for="form-element-help-01">Parent Details</label>
                                                    <div class="slds-grid slds-wrap slds-p-horizontal_medium">
                                                        <div class="slds-col dark-bg billig-info slds-grid">
                                                            <ul class="slds-grid slds-wrap slds-size_1-of-1">
                                                                <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                    <div><strong>Parent Name</strong> {!parentAccWrap.firstName} {!parentAccWrap.lastName}</div></li>
                                                                <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                    <div><strong>Address</strong>  {!parentAccWrap.Address}</div></li>
                                                                <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                    <div><strong>Email</strong>  {!parentAccWrap.Email}</div></li>
                                                                <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                    <div><strong>Postal</strong>  {!parentAccWrap.BillingPostalCode}</div></li>
                                                                <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                    <div><strong>Mobile</strong><span id="mobId"></span></div></li>
                                                                <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                    <div style="border:none;"><strong>Country</strong>  {!parentAccWrap.BillingCountryCode}</div></li>
                                                                <!--<li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium"  style="border:none;">
                                                                    <div style="border:none;"><strong>Start Date</strong>  
                                                                        <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                                                                            <apex:param value="{!freeTrailEnr.Lessons_Start_Date__c}" /> 
                                                                        </apex:outputText> 
                                                                    </div>
                                                                </li>-->
                                                            </ul>
                                                            
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="slds-form-element">
                                                    <label class="slds-form-element__label field-title slds-size_1-of-1 slds-p-horizontal_medium" for="form-element-help-01">Enrolment Details</label>
                                                    <apex:repeat value="{!studentWrapList}" var="student">
                                                        <apex:repeat value="{!student.lessonList}" var="lesson">
                                                            <div class="slds-grid slds-wrap slds-p-horizontal_medium" style="margin-top: 5px;">
                                                                <div class="slds-col dark-bg billig-info slds-grid">
                                                                    <ul class="slds-grid slds-wrap slds-size_1-of-1">
                                                                        <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                            <div><strong>Student Name</strong> {!student.stuAccWrap.FirstName} {!student.stuAccWrap.LastName} </div></li>
                                                                        <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                            <div><strong>Teacher Name</strong>  {!lesson.selectedTeacherName}</div></li>
                                                                        <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                            <div><strong>Centre</strong>  {!lesson.selectedCenterName}</div></li>
                                                                        <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                            <div><strong>Package</strong>  {!lesson.selectedPlanName}</div></li>
                                                                        <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                            <div style="border:none;"><strong>Lesson Time</strong> 
                                                                                {!lesson.lessonSlctSlotT}
                                                                            </div> 
                                                                        </li>
                                                                        <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium" >
                                                                            <div style="border:none;"><strong>Start Date</strong>  
                                                                                <apex:outputText value="{0, date,EE,  MMM dd yyyy}">
                                                                                    <apex:param value="{!lesson.lessonSlcdDateD}" /> 
                                                                                </apex:outputText> 
                                                                            </div>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </apex:repeat>
                                                    </apex:repeat>
                                                </div>
                                                
                                                <div class="slds-form-element">
                                                    <div class="slds-grid slds-wrap ">
                                                        <div class="slds-col slds-size_1-of-1 slds-p-horizontal_medium">
                                                            <div class="slds-form-element slds-grid slds-wrap radio-list">
                                                                <label class="slds-form-element__label field-title slds-size_1-of-1  " for="form-element-help-01">Billing Details</label>
                                                                <apex:outputPanel rendered="{!isAmcClubMember}" layout="none">
                                                                    <h4 class="f-title">Please check with the American Club for your invoice after enrolment has been confirmed.</h4>
                                                                    <br/><br/>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel rendered="{!!isAmcClubMember}" layout="none">
                                                                    <table class="slds-table slds-table_cell-buffer grandTot-table">
                                                                        <tr class="slds-line-height_reset slds-border_bottom">
                                                                            <th>Package Name</th>
                                                                            <th>Student</th>
                                                                            <th style="text-align:center;">Qty</th>
                                                                            <th style="text-align:right;">Rate</th>
                                                                            <th style="text-align:right;">Total</th>
                                                                        </tr>
                                                                        <apex:repeat value="{!studentWrapList}" var="student">
                                                                            <apex:repeat value="{!student.lessonList}" var="lesson">
                                                                                 <tr class="slds-hint-parent slds-border_bottom">
                                                                                    <td>Deposit Fee</td>
                                                                                    <td>{!student.stuAccWrap.FirstName} {!student.stuAccWrap.LastName}</td>
                                                                                    <td style="text-align:center;">1</td>
                                                                                    <td style="text-align:right;">${!lesson.depFees}</td>
                                                                                    <td style="text-align:right;">${!lesson.depFees}</td>
                                                                                </tr>
                                                                                <tr class="slds-hint-parent slds-border_bottom">
                                                                                    <td>{!lesson.selectedPlanName}</td>
                                                                                    <td>{!student.stuAccWrap.FirstName} {!student.stuAccWrap.LastName}</td>
                                                                                    <td style="text-align:center;">1</td>
                                                                                    <td style="text-align:right;">${!lesson.prgFees} </td>
                                                                                    <td style="text-align:right;">${!lesson.prgFees} (T)</td>
                                                                                </tr>
                                                                                <tr class="slds-hint-parent slds-border_bottom">
                                                                                    <td>Registration Fee</td>
                                                                                    <td>{!student.stuAccWrap.FirstName} {!student.stuAccWrap.LastName}</td>
                                                                                    <td style="text-align:center;">1</td>
                                                                                    <td style="text-align:right;">${!lesson.regiFees} </td>
                                                                                    <td style="text-align:right;">${!lesson.regiFees} (T)</td>
                                                                                </tr>
                                                                            </apex:repeat>
                                                                        </apex:repeat>    
                                                                        <tr>
                                                                            <td colspan="5">
                                                                                <table style="width:100%;border-collapse:collapse;"  >
                                                                                    <tr class="slds-border_bottom">
                                                                                        <td style="width:60%;"><!--Based on Start Date -       
                                                                                            <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                                                                                                <apex:param value="{!freeTrailEnr.Lessons_Start_Date__c}" /> 
                                                                                            </apex:outputText>-->
                                                                                        </td>
                                                                                        <td>
                                                                                            <table style="width:100%; border: none !important;margin-left: 17px;">
                                                                                               <!-- <tr>
                                                                                                    <td >Total</td>
                                                                                                    <td style="text-align:right;">${!grndTotModel.feesTot}</td>
                                                                                                </tr>
                                                                                                <tr style="{!IF(grndTotModel.disTot > 0,'','display:none;')}">
                                                                                                    <td >Discount</td>
                                                                                                    <td style="text-align:right;"><span style="color:red;">(${!grndTotModel.disTot})</span></td>
                                                                                                </tr>-->
                                                                                                <tr>
                                                                                                    <td >GST</td>
                                                                                                    <td style="text-align:right;">${!grndTotModel.gstTot}</td>
                                                                                                </tr>
                                                                                                <tr style="{!IF(grndTotModel.disTot > 0,'','display:none;')}">
                                                                                                    <td >Discount</td>
                                                                                                    <td style="text-align:right;"><span style="color:red;">(${!grndTotModel.disTot})</span></td>
                                                                                                </tr>
                                                                                                <!-- <tr style="border-top: 1px solid !important; border-bottom: none !important; border-color: #dddbda !important;">
                                                                                                    <td>Total Subscription</td>
                                                                                                    <td style="text-align:right;">${!grndTotModel.subsTot}</td>
                                                                                                </tr>
                                                                                                 <tr>
                                                                                                    <td>Total Deposit</td>
                                                                                                    <td style="text-align:right;">${!grndTotModel.depositTot}</td>
                                                                                                </tr>-->
                                                                                                <tr style="border-top: 1px solid !important; border-bottom: none !important; border-color: #dddbda !important;">
                                                                                                    <td >Grand Total</td>
                                                                                                    <td style="text-align:right;">${!grndTotModel.grandTot}</td>
                                                                                                </tr>
                                                                                            </table>
                                                                                        </td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div><br/><br/>
                                                        <div class="slds-col slds-size_1-of-1  slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <div class="slds-form-element__control">
                                                                    <label class="slds-form-element__label  field-title">Student Policies </label>
                                                                    <div class="slds-checkbox">
                                                                        <input type="checkbox" name="options" id="checkbox-3" value="checkbox-3" class="inputchk"/>
                                                                        <label class="slds-checkbox__label" for="checkbox-3">
                                                                            <span class="slds-checkbox_faux"></span>
                                                                            <span class="slds-form-element__label">By checking this box and enrolling into Aureus Academy you agree to all of our policies and accept that they may be subject to change. To see our full student policies, please <a href="#" style="text-decoration: underline !important;">click here</a></span>
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__help slds-hide errortxt">This field is required</div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-p-horizontal_medium">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label  field-title">Terms and Conditions</label>
                                                                <div class="slds-form-element__control">
                                                                    <div class="terms-info">
                                                                        <h4 class="f-title">1. Tuition fees and frequency of lessons</h4>
                                                                        <p>Tuition fees are charged on a monthly basis at the beginning of each month. Payment will be deducted from your customer account on a monthly basis through Visa, Mastercard, or American Express credit cards. Under normal circumstances, monthly tuition fees would cover your course description whether it be 4 x 30 minute lessons or 4 x 60 minute lessons. Lessons in the fifth week (29th, 30th, and 31st) will be reserved for make ups. In the event there are no outstanding make ups or pre-make ups arranged (within 60-days), the 5th lesson will be billed to your account (once billed, it cannot be considered a pre-make up). </p>                                                                 
                                                                        
                                                                        <h4 class="f-title">2.	Security Deposit: </h4>
                                                                        <p>Aureus Academy requires one-month (4 lessons) advanced notice for termination of lessons. This security deposit will be refunded to you with one-month (4 lessons) notice or will serve in-lieu of any remaining unpaid lessons within the one-month (4 lesson) notice. Should lessons be terminated without a 30 day advanced notice, the security deposit will be forfeited. A non- refundable registration fee of $25 is required for all new students, and is inclusive of an Aureus Academy enrolment kit. </p>                                                                     
                                                                        
                                                                        <h4 class="f-title">3.	Missed Lessons:</h4>
                                                                        <p>For individual lessons there will be no make up for any cancellation of lessons by the student unless given sufficient notice (a minimum of 24 hours) and supporting documents, such as a Medical Certificate. The lesson will be made up at the discretion of management and availability of the teacher. Group lessons require 48Mhour notice in order to be considered for a make up lesson. For Group Lessons, make up lessons have to be completed within the same month of the cancelled lesson or it will be forfeited. Should the instructor need to cancel a lesson, it will be replaced and not prorated. This replacement will be reM scheduled accordingly to accommodate the time schedule of both parties.</p>
                                                                        
                                                                        <h4 class="f-title">4.	Student Absence Policy:</h4>
                                                                        <p>Tuition fees will be due as per normal, regardless of scheduling changes. For extended periods of absence and advanced scheduling changes, Aureus Academy will arrange make up lessons either before or after the period of absence. All efforts will be made to ensure that the student receives their entitled makeup lessons with their respective teacher. Compliance with our Student Absence.</p>
                                                                        <p>Policy allows the student to guarantee their time slot, and their respective teacher during periods of extended absence.</p>
                                                                            
                                                                        <h4 class="f-title">5.	Public Holidays and Annual Leave:</h4>
                                                                        <p>There will be lessons conducted on the following public holidays (Good Friday, Vesak Day, Hari Raya Puasa, Hari Raya Haji, and Deepavali). If the lesson falls on a public holiday that we are closed, it will be replaced on another day. Should the teacher take annual leave, lessons will be made up either before or after the leave period.</p>
                                                                        
                                                                        <h4 class="f-title">6.	Make-Up-Lessons:</h4>
                                                                        <p>In the event that lessons are cancelled in advanced, lessons can be made up on another day and time with the teacher. Make- up lessons need to be completed within 120 days of the cancelled lesson, or they are forfeited. In the unlikely event the instructor is full and cannot make up the lessons, the customer has the option to make up the lessons with another teacher. Should the customer submit withdrawal notice from the school, outstanding make up lessons need to be completed before the 30-day notice period has ended; otherwise, they are forfeited. Make-up lessons do not replace paid lessons and cannot be extended past the withdrawal notice of 30-days.</p>
                                                                        
                                                                        <h4 class="f-title">7.	Punctuality:</h4>
                                                                        <p>Students must make the effort to come on time for their lessons. There will not be any make up for any time lost. Strict punctuality is also expected of the instructor, however, should the instructor be late time will be made up accordingly.</p>
                                                                        
                                                                        <h4 class="f-title">8.	Termination:</h4>
                                                                        <p>Aureus Academy reserves the right to dismiss any student due to frequent absences, disciplinary reasons, overdue tuition payments or parental non-compliance with policies and procedures listed here. Informing an instructor of intent to withdraw, or not attending classes, does not constitute withdrawal from lessons. Should a student wish to terminate his or her lessons, Aureus Academy must be given 30-day notice via email to {Centre Merge Field Email} or the deposit is forfeited.</p>
                                                                        
                                                                        <h4 class="f-title">9.	Personal Property:</h4>
                                                                        <p>Aureus Academy does not assume any responsibility for personal property (including, but not limited to clothing, cameras, cell phones, purses, wallets, vehicles, etc.) lost, damaged or left unattended on school premises and in common areas. Should any of Aureus Academyâ€™s materials or goods be damaged by the student, the student/family is responsible for full replacement. If replacement is not made, then the remaining lessons for the month and deposit are forfeited.</p>
                                                                        
                                                                        <h4 class="f-title">10.	Refund:</h4>
                                                                        <p>Aureus Academy has a strict no refund policy. Should you pay for the lessons and terminate within the same month, you are entitled to the remaining lessons but there will not be any refund.</p>
                                                                        
                                                                        
                                                                        <h4 class="f-title">11.	Official Matters:</h4>
                                                                        <p>All official matters, regarding questions, comments, or concerns are to be communicated directly with the Administrative Office. Should there be any issues, it is best to communicate to your centre through email at {CENTRE EMAIL ADDRESS} or by phone at {PHONE NUMBER}. The Company reserves the right, at its discretion, to change, modify, add, or remove portions of these Terms (of the School Policy) at any time by posting the amended Terms. Please check these Terms periodically for changes. Your continued enrolment constitutes your binding acceptance of such changes.</p>
                                                                        
                                                                        <h4 class="f-title">12.	Liability:</h4>
                                                                        <p>By signing this contract, the signee and all associated parties waives any responsibility for illness, personal injury, or death anywhere in the premises of Aureus Group Pte. Ltd. facilities. Aureus Group Pte. Ltd. any associated parties are not responsible for any of the above mentioned nor damage of personal goods.</p>
                                                                        
                                                                        <h4 class="f-title">13.	Personal Data:</h4>
                                                                        <p>By signing this document, you hereby agree that Aureus Group Pte. Ltd. (or Aureus Academy) may collect, obtain, store and process your personal data that you provide in this form for the purpose of considering your feedback as described in this Form and/or for receiving updates, news, promotional and marketing mails or materials from Aureus Group Pte. Ltd/Aureus Academy.</p>
                                                                        <p>You hereby give your consent to the Aureus Group Pte. Ltd. and/or the Aureus Academy to:</p>
                                                                        <p>I.	Store and process your Personal Data.</p>
                                                                        <p>II. provided Personal Data for the purposes of marketing, promotion, and updates.</p>
                                                                        
                                                                        <p>In addition, your personal data may be transferred to any company within the Aureus Group Pte. Ltd. For the purpose of updating or correcting such data, you may at any time apply to the Aureus Group Pte. Ltd. to have access to your personal data which are stored by the company.</p>
                                                                        
                                                                        <p>Also, Aureus Group Pte. Ltd. may use any photos or videos taken for marketing purposes which include Facebook, Newsletters, Website, brochures, and other mediums of marketing communication.</p>
                                                                        
                                                                        <p>For the avoidance of doubt, Personal Data includes all data defined within the Personal Data Protection Act (2012) including all data you have disclosed to the Company.</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col slds-size_1-of-1 slds-p-horizontal_medium">
                                                             <div class="slds-form-element">
                                                                <label class="slds-form-element__label  field-title">Signature</label>
                                                                <div class="slds-form-element__control">
                                                                    <div id="signature-pad" class="m-signature-pad" >
                                                                        <div class="m-signature-pad--body"> 
                                                                            <canvas></canvas>
                                                                        </div> 
                                                                        <div class="m-signature-pad--footer">
                                                                            <div class="description">Sign above</div>
                                                                            <button type="button" class="button clear" data-action="clear">Clear</button>
                                                                         </div>
                                                                    </div>
                                                                </div>
                                                            </div>                                                            
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <apex:outputPanel rendered="{!isAmcClubMember}">
                                                     <div class="slds-form-element">
                                                       <div class="slds-grid slds-wrap slds-p-horizontal_medium" style="margin-top: 5px;">
                                                            <div class="slds-grid slds-wrap slds-grid--align-spread slds-size_1-of-1">
                                                                <a  class="slds-button custom-btn prev-btn" onclick="document.getElementById('thirdCmpId').style.display = 'none';document.getElementById('secondCmpId').style.display = 'block';">Previous</a> 
                                                                
                                                                <a  class="slds-button custom-btn" id="payNowAlrdyCstmr"  onclick="paymentNow();return false;">Enrol now</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{! (!isAmcClubMember) && isAlreadyStripCstmr}">
                                                    <!-- <apex:outputPanel rendered="{!isAlreadyStripCstmr}"> -->
                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label field-title slds-size_1-of-1 slds-p-horizontal_medium" for="form-element-help-01">Card Details</label>
                                                        <div class="slds-grid slds-wrap slds-p-horizontal_medium" style="margin-top: 5px;">
                                                            <div class="slds-col dark-bg billig-info slds-grid">
                                                                <ul class="slds-grid slds-wrap slds-size_1-of-1">
                                                                    <li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                        <div><strong>Card Info</strong> <apex:outputText value="{!cardImage}" escape="false" /> x {!cardNumber}</div>
                                                                    </li>
                                                                    <!--<li class="slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-horizontal_medium">
                                                                        <div><strong>Card Type</strong> {!cardType} </div>
                                                                    </li>-->
                                                                </ul>
                                                            </div>
                                                            
                                                            <div class="slds-grid slds-wrap slds-grid--align-spread slds-size_1-of-1">
                                                                <a  class="slds-button custom-btn prev-btn" onclick="document.getElementById('thirdCmpId').style.display = 'none';document.getElementById('secondCmpId').style.display = 'block';">Previous</a> 
                                                                
                                                                <a  class="slds-button custom-btn" id="payNowAlrdyCstmr"  onclick="paymentNow();return false;">Pay Now</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                
                                                <apex:outputPanel rendered="{! (!isAmcClubMember) &&  (!isAlreadyStripCstmr)}">
                                                    <!--<apex:outputPanel rendered="{!!isAlreadyStripCstmr}">-->
                                                    <!-- Stripe Form Start     --->
                                                    <form method="post" id="payment-form">
                                                        <div class="slds-p-around_x-small slds-col slds-size_1-of-1 slds-p-horizontal_medium"  style="background-color: #f2f2f2;">
                                                            <p><b>Card Detail</b></p>
                                                            <div id="card-element">
                                                            </div>
                                                            <div id="card-errors" role="alert"></div>
                                                        </div>
                                                        
                                                        <div class="slds-grid slds-wrap slds-grid--align-spread slds-size_1-of-1" >
                                                            <button type="button" class="slds-button custom-btn prev-btn"  onclick="document.getElementById('thirdCmpId').style.display = 'none';document.getElementById('secondCmpId').style.display = 'block';">
                                                                Previous
                                                            </button>
                                                            
                                                            <button id="payBtn" class="slds-button slds-button_neutral custom-btn" >
                                                                Pay Now
                                                                <span class="slds-icon_container slds-icon-utility-announcement" title="Description of icon when needed">
                                                                    <svg class="slds-icon slds-icon_xx-small" aria-hidden="true">
                                                                        <use fill="White" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#chevronright')}" />
                                                                    </svg>
                                                                </span>
                                                            </button>
                                                        </div>
                                                    </form>                                                      
                                                    <!-- Stripe Form End--->
                                                </apex:outputPanel>    
                                        </div>     
                                    </div>      
                                   
                                       
                                    <script>
                                       
                                        var stripe = Stripe('{!apiKey}');
                                    
                                        var elements = stripe.elements();
                                        var style = {
                                          base: {
                                                color: '#32325d',
                                                fontFamily: '"Helvetica Neue", Helvetica, sans-serif',
                                                fontSmoothing: 'antialiased',
                                                fontSize: '16px',
                                                '::placeholder': {
                                                  color: '#aab7c4'
                                                }
                                            },
                                            invalid: {
                                                color: '#fa755a',
                                                iconColor: '#fa755a'
                                            }
                                        };
                                        var card = elements.create('card', {style: style,hidePostalCode:true});
                                        card.mount('#card-element');
                                        card.addEventListener('change', function(event) {
                                            var displayError = document.getElementById('card-errors');
                                          if (event.error) {
                                              console.log(event.error);
                                              displayError.textContent = event.error.message;
                                          } else {
                                              displayError.textContent = '';
                                          }
                                        });
                                        
                                        // Handle form submission.
                                        var form = document.getElementById('payment-form');
                                        form.addEventListener('submit', function(event) {
                                            event.preventDefault();
                                            
                                             //Added by Rajesh 26th June 2019, for disable pay button on submit button
                                            disablePayBtn(true);
                                            
                                            stripe.createToken(card).then(function(result) {
                                                console.log('result token ',result);
                                               
                                                if (result.error) {
                                                    var errorElement = document.getElementById('card-errors');
                                                    errorElement.textContent = result.error.message;
                                                    
                                                    //Added by Rajesh 26th June 2019, for enable pay button if any card error 
                                                    disablePayBtn(false);
                                                } else {
                                                    //document.getElementById('pg:spinner.start').style.display = 'block';
                                                    stripeTokenHandler(result.token);
                                                }
                                            });
                                          
                                        });
                                        function stripeTokenHandler(token){
                                            var form = document.getElementById('payment-form');
                                            var hiddenInput = document.createElement('input');
                                            hiddenInput.setAttribute('type', 'hidden');
                                            hiddenInput.setAttribute('name', 'stripeToken');
                                            hiddenInput.setAttribute('value', token.id);
                                            form.appendChild(hiddenInput);
                                            console.log(token.card.id); 
                                            
                                            var checkErr = checkErrorOnSummaryPage();
                                           
                                            if(!checkErr){
                                                //Added by Rajesh 26th June 2019, for disable pay button if no error on page validation 
                                                disablePayBtn(true);
                                                
                                                var concatePhoneNo = '+' + $('[class$=btn-cc]').html().match(/\d+/);
                                                concatePhoneNo += $('[id$=phoneNumber]').val();
                                                console.log('concatePhoneNo------> '+concatePhoneNo);
                                                completeEnrolment(signaturePad.toDataURL(), token.id,concatePhoneNo);
                                            }else{
                                                //Added by Rajesh 26th June 2019, for enable pay button if any error 
                                                disablePayBtn(false);
                                            }                                              
                                        }
                                        
                                        function paymentNow(){
                                            $('#payNowAlrdyCstmr').css('pointer-events', 'none');
                                            
                                            var checkErr = checkErrorOnSummaryPage();
                                            
                                            if(!checkErr){
                                                var concatePhoneNo = '+' + $('[class$=btn-cc]').html().match(/\d+/);
                                                concatePhoneNo += $('[id$=phoneNumber]').val();
                                                
                                                completeEnrolment(signaturePad.toDataURL(), '',concatePhoneNo);
                                            }else{
                                                $('#payNowAlrdyCstmr').css('pointer-events', '');
                                            }
                                        }
                                       
                                        function checkErrorOnSummaryPage(){
                                            var isErr = false;
                                            
                                            if (signaturePad.isEmpty()) {
                                                alert("Please provide signature first.");
                                                isErr = true;
                                            } else {                                            
                                                $('.inputchk').each(function(){
                                                    
                                                    if(!$(this).prop('checked')){
                                                        $(this).parent().parent().parent().addClass('slds-has-error');
                                                        $(this).parent().parent().next().removeClass('slds-hide');
                                                        isErr = true;        
                                                    }else{
                                                        $(this).parent().parent().parent().removeClass('slds-has-error');
                                                        $(this).parent().parent().next().addClass('slds-hide');
                                                    }
                                                });
                                            }
                                            return isErr;
                                        }
                                       
                                       //Added by Rajesh 26th June 2019, for enable/disable pay button for stop double click
                                        function disablePayBtn(isDisable){
                                            if(isDisable)
                                                $('#payBtn').css('pointer-events', 'none');
                                            else
                                                $('#payBtn').css('pointer-events', '');
                                        }
                                    </script>    
                                       
                                    <script>
                                         //----------------------Signature script
                                       var wrapper = document.getElementById("signature-pad"),
                                           clearButton = wrapper.querySelector("[data-action=clear]"),
                                           saveButton = wrapper.querySelector("[data-action=completeEnrl]"),
                                           canvas = wrapper.querySelector("canvas"),
                                           signaturePad;
                                       
                                       function resizeCanvas() {
                                           // When zoomed out to less than 100%, for some very strange reason,
                                           // some browsers report devicePixelRatio as less than 1
                                           // and only part of the canvas is cleared then.
                                           var ratio =  Math.max(window.devicePixelRatio || 1, 1);
                                           canvas.width = canvas.offsetWidth * ratio;
                                           canvas.height = canvas.offsetHeight * ratio;
                                           //canvas.width = 615;
                                           //canvas.height = 300;
                                           canvas.getContext("2d").scale(ratio, ratio);
                                       }
                                       
                                       window.onresize = resizeCanvas;
                                       resizeCanvas();
                                       
                                       signaturePad = new SignaturePad(canvas);
                                            
                                       clearButton.addEventListener("click", function (event) {
                                           signaturePad.clear();
                                       });
                                            
                                       /*function completeEnr(amt){
                                           if (signaturePad.isEmpty()) {
                                               alert("Please provide signature first.");
                                           } else {
                                               $('.inputchk').each(function(){
                                                   
                                                   if(!$(this).prop('checked')){
                                                       $(this).parent().parent().parent().addClass('slds-has-error');
                                                       $(this).parent().parent().next().removeClass('slds-hide');
                                                       
                                                   }else{
                                                       $(this).parent().parent().parent().removeClass('slds-has-error');
                                                       $(this).parent().parent().next().addClass('slds-hide');
                                                       
                                                       handler.open({
                                                           name: 'Aureus Academy',
                                                           description: 'Enrolment Fee',
                                                           amount: amt
                                                       });
                                                       //completeEnrolment(signaturePad.toDataURL());
                                                       return false;
                                                   }
                                               });
                                           }
                                       }*/
                                       
                                     function checkError(){
                                        var isErrOnSave = '{!isError}';
                                        
                                        if(isErrOnSave == 'true'){
                                            //Added by Rajesh 26th June 2019, for enable pay button if any error
                                            disablePayBtn(false);
                                            $('#payNowAlrdyCstmr').css('pointer-events', '');
                                            
                                            $('.paymentCmpErrDiv').removeClass('slds-hide');
                                            $('.contentPaymentCmpErrDiv').html('{!errorMsg}');
                                        }else{
                                            $('.paymentCmpErrDiv').addClass('slds-hide');
                                        }
                                     }
                                    </script>
                                 </apex:outputPanel> 
                            </div>
                            <!-------  Third block  End -------------------> 
                            
                    </div>
                </div>
            </div>
        
    </body>
    <style>
        .input-group-btn:first-child>.btn, .input-group-btn:first-child>.btn-group{
           height: 31px !important;
           width: 51px !important;
        }
        .caret{
            position: relative !important;
            top: 7px !important;
            left: 2px !important;
        }
        .input-group .form-control:not(:first-child):not(:last-child), .input-group-addon:not(:first-child):not(:last-child), .input-group-btn:not(:first-child):not(:last-child){
            border-radius: 4px !important;
            height: 32px !important;
            position: relative !important;
            top: 1px !important;
        }
        .dateFormat{
        display: none;
        }
        body{
        background-image: url("{!$Resource.music}") !important;
        background-size:100% 100% !important;
        background-repeat:no-repeat !important;
        background-position:left !important;
        background-color: #f3613c !important;
        
        /*Added for background image set 9th Aug 2019 */
        background-position: center !important;
        background-size: cover !important;
        
        }
        .main-content {
        min-height: 100vh;
        background-image:none !important;
        background-size: contain !important;
        background-repeat: no-repeat !important;
        background-color: transparent !important;
        }
         /*Added by Rajesh*/
        @media(max-width:992px){
        	.main-content {
            	min-height: auto;
			}
        }
        .container {
        max-width:650px;
        }
        span.main-title {
        color: #200a28;
        font-size: 24px;
        border-radius: 0;
        font-weight: bold;
        margin-bottom: 10px;
        display: block;
        line-height: 30px;
        padding-bottom:10px;
        text-align:center;
        }
        .content-box {
        margin: 50px 0 ;
        width: 90%;
        max-width: 700px;
        background: rgba(255, 255, 255, 1);
        border-radius: 10px;
        }
        .locations-list {
        text-align:left;
        }
        form legend {
        font-size: 16px !important;
        }
        .header {
        background: #fff;
        border-radius: 10px 10px 0 0px;
        padding: 10px 10px 0;
        text-align: center;
        }
        form {
        padding: 0 10px;
        }
        .field-title {
        font-size: 20px !important;
        font-weight: bold;
        }
        .info-box {
        border: 1px solid #eee;
        color: #333;
        font-size: 13px;
        padding: 10px 10px !important;
        border-radius: 5px;
        margin: 10px 0;
        background: #f7f7f7;
        }
        .content-body span.slds-form-element__label {
        display: block;
        font-size: 14px !important;
        }
        
        .content-body span.slds-radio {
        margin: 10px 0;
        }
        .custom-btn {
        padding: 5px 10px 3px !important;
        color: #fff !important;
        background: #f79c1a !important;
        font-size: 16px !important;
        text-transform: uppercase;
        line-height: 20px !important;
        margin: 15px 0 20px;
        float:right;
        }
        .slds-form-element {
        margin-bottom: 5px;
        }
        .user-img {
        width: 80px;
        border: 1px solid #eee;
        border-radius: 50%;
        height: 80px;
        min-width:80px;
        margin-right:10px;
        overflow:hidden;
        }
        .teacher-details {
        display: flex;
        }
        
        .teacher-details div {
        display: inline-block;
        float: left;
        }
        .info-box h2 {
        font-size: 16px;
        font-weight: bold;
        }
        .custom-calendar .calc {
        border: 1px solid rgb(221, 219, 218);
        border-radius: .25rem;
        padding: .25rem 0;
        background: rgb(255, 255, 255);
        box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.16);
        width: 100%;
        }
        .custom-btn.prev-btn {
        float: none;
        background: #fbbf0d !important;
        float: left;
        }
        .f-title {
        font-size: 14px !important;
        }
        .student-box {
        border: 1px solid #f79c1a;
        padding-top: 10px;
        padding-bottom: 10px;
        background: #fed217;
        border-radius: 5px;
        position: relative;
        margin: 0 0 20px;
        }
        @font-face {
        font-family: "Font Awesome 5 Pro";
        src: url(https://use.fontawesome.com/releases/v5.5.0/css/all.css);
        }
        .edit-del {
        position: absolute;
        right: 15px;
        top: 15px;
        }
        .edit-del i {
        padding: 5px;
        }
        .edit-del a {
        margin: 0 5px;
        display: inline-block;
        color: #4d4d4d;
        font-size: 16px;
        }
        .content-body {
        overflow-y: auto;
        }
        fieldset{
        overflow-y: auto;
        }
        .terms-info p {
        margin-bottom: 10px;
        }
        
        .terms-info h4.f-title {
        font-weight: bold;
        font-size: 14px !important;
        }
        .terms-info {
        border: 15px solid #f2f2f2;
        background: #f2f2f2;
        height: 145px;
        overflow-y: scroll;
        outline: 1px solid #eee;
        }
        
        .field-title + .student-box .del-btn {
        display: none;
        }
        input.slds-input {
        }
        
        input.slds-input,select {
        border-color: #f79c1a !important;
        }
        
        .content-box {
        box-shadow: 1px 2px 10px #f79c1a;
        }
        .content-body{
        overflow-x:hidden;
        }
        .add-more button {
        background: #f79c1a;
        border: 1px solid #f79c1a;
        padding: 5px 20px 5px 20px;
        float: right;
        color: #fff;
        text-transform: uppercase;
        font-size: 16px;
        font-weight: bold;
        border-radius: 5px;
        margin:20px 0 10px;
        }
        .add-more {
        float: left;
        }
        .add-more button  i {
        position: relative;
        margin-left: 10px;
        }
        .student-list th, .student-list td {
        width: 20% !important;
        white-space: unset !important;
        padding: 10px 5px!important;
        text-transform: none !important;
        letter-spacing: 0.2px !important;
        }
        .edit-del button {
        background: transparent;
        border: none;
        color: #4d4d4d;
        font-size: 16px;
        }
        .custom-calendar td {
        padding: 0 !important;
        }
         .billig-info {
        background: #f2f2f2;
        float: left;
        width: 100%;
        padding: 10px 0;
        font-size: 14px;
        margin: 0 0 10px;
        }
        .billig-info li {
        margin:0;
        }
        .billig-info li > div {
        padding-top: 5px;
        padding-bottom: 5px;
        line-height: 26px;
        display: block;
        border-bottom: 1px solid #ccc;
        margin-left:0;
        width:100%;
        }
        
        .billig-info:last-child {
        margin-bottom: 0;
        }
        
        .billig-info li strong {
        /*width: 120px;
        display: inline-block;*/
        width:100%;
        display:block; 
        }
        .after-noon {
        padding-bottom: 50px;
        }
        
        button.save-btn {
        position: absolute !important;
        bottom: 0 !important;
        right: 1rem;
        }
        .more-lesson {
        width: 100%;
        }
        .available i {
        display: inline-block;
        background: #eee;
        height: 100%;
        float: left;
        width: 20px;
        margin: 0 2px;
        }
        .available {
        position: absolute;
        left: 0;
        width: 100%;
        bottom: 0px;
        height: 5px;
        text-align: center;
        justify-content: center;
        display: flex;
        }
        
        form .custom-btn.more-lesson {
        margin-bottom: 10px;
        }
        .another-box {
        background: rgba(255, 255, 255, 0.5);
        width: calc(100% - 30px);
        margin: 0 15px 15px;
        padding: 10px 0 20px;
        }
        .time-list span.slds-button.slds-radio_button {
        width: 100%;
        margin-bottom: 5px;
        border: 1px solid #eee;
        }
        
        .time-list label.slds-radio_button__label {
        width: 100%;
        text-align: center;
        }
        
        .time-list {
        background: #f7f7f7;
        padding: 15px 15px 5px;
        border: 1px solid #eee;
        width: calc(100% - 15px);
        margin: 0 auto 10px;
        }
        
        .afternoon .time-list {
        float: right;
        }
        
        span.slds-radio label {
        padding: 10px;
        border: 1px solid #eee;
        background: #f7f7f7;
        border-radius: 5px;
        display: block;
        }
        
        span.slds-radio input:checked + label {
        background: #1b5297;
        }
        
        span.slds-radio input:checked + label span.slds-form-element__label {
        color: #fff;
        }
        .slds-scope .slds-datepicker td {
        border: 1px solid #eee;
        }
        td.slds-is-today {
        background: #ecebea;
        }
        .date-list {
        padding: 0 10px !important;
        }
        
        .date-list label {
        padding: 0 5px;
        }
        i.morning-availablity, i.afternoon-availablity{
        background:#61c461
        }
        .content-body > div > fieldset {
        max-height: 450px;
        overflow-y: auto;
        overflow-x: hidden;
        padding: 0 15px;
        }
        .calc > div fieldset {
        overflow: hidden;
        }
        .slds-scope .slds-datepicker th {
        padding: 0;
        }
        
        .popupBackground{ 
            background-color: lightgrey;
            opacity: 0.80;
            
            position:fixed;
            padding:0;
            margin:0;
            
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 9998;
            border-radius: 5px; 
        }
        
        /*  Date picker css   */
        .ui-datepicker {
        width: 17em;
        padding: 0;
        display: none;
        background:#846733;  
        }
        .ui-datepicker .ui-datepicker-title {
        margin: 0;
        line-height: 36px;
        text-align: center;
        }
        .ui-datepicker table {
        background:#fff;    
        }
        .ui-datepicker td {
        padding: 0px;
        border: 1px solid #eee;
        font-size: .75rem;
        position: relative;
        width: 2rem;
        min-height: 2rem;
        line-height: 2.5rem;
        
        }
        .ui-datepicker td span,
        .ui-datepicker td a {
        display: block;
        padding: 0em;
        text-align: center;
        text-decoration: none;
        }
        #datepicker,
        .ui-datepicker,
        .ui-datepicker-header,
        .ui-datepicker-calendar {
        width: 100%;
        }
        .loc-maps span {
        width: 100%;
        }
        .ui-datepicker td span, .ui-datepicker td a {
        
        background: #fff !important;
        border:2px solid #fff !important;
        }
        .ui-state-highlight, .ui-widget-content .ui-state-highlight, .ui-widget-header .ui-state-highlight {
        background: rgb(236, 235, 234) !important;
        border-color: rgb(236, 235, 234) !important;
        border-width: 2px !important;
        border-style: solid !important
        }
        .ui-datepicker table{
        margin:0 !important;
        }
        .ui-widget.ui-widget-content {
        border: none;
        }
        
        table.ui-datepicker-calendar thead {
        border: 1px solid #eee;
        }
        .ui-datepicker .ui-datepicker-header{
        border-radius:0;
        }
        .ui-datepicker td a.ui-state-active {
        background: #fff!important;
        border: 2px solid #f6911d !important;
        color: #f6911d !important;
        }
        .ui-datepicker td a:before, .ui-datepicker td span:before {
        content: "";
        position: absolute;
        max-width: 12px;
        height: 5px;
        background: #eee;
        bottom: 5px;
        left: 4px;
        width: 100%;
        }
        .ui-datepicker td a:after, .ui-datepicker td span:after {
        content: "";
        position: absolute;
        max-width: 12px;
        height: 5px;
        background: #eee;
        bottom: 5px;
        right: 4px;
        width: 100%;
        }
        .ui-datepicker .ui-datepicker-prev span, .ui-datepicker .ui-datepicker-next span {
        display: block;
        position: absolute;
        left: 50%;
        margin-left: -8px;
        top: 15%;
        margin-top: 0;
        transform: translateY(50%);
        }
        
        .day-availability--morning .ui-state-default:before, .ui-widget-content .day-availability--morning .ui-state-default:before, .ui-widget-header .day-availability--morning .ui-state-default:before {
            background: #61c461;
        }
        .day-availability--afternoon .ui-state-default:after, .ui-widget-content .day-availability--afternoon .ui-state-default:after, .ui-widget-header .day-availability--afternoon .ui-state-default:after {
            background: #61c461;
        } 
        .ui-datepicker .ui-datepicker-next, .ui-datepicker .ui-datepicker-prev{
        height: 100%;
        }   
        .time-list:empty {
            display: none;
        }
        div#signature-pad {
            position: relative;
            top: 0;
            margin: auto;
            left: 0;
            width: 100%;
            margin-top: 10px;
            box-shadow: none;
            background: #f2f2f2;
            border-radius: 0;
        }
        .m-signature-pad--body canvas {
            border: 1px solid #ccc;
            background: #fff;
        }
        .dark-bg {
            background: #f2f2f2;
            width: 100%;
        }
        .m-signature-pad--footer .button.clear {
            background: #f79c1a;
            border: 0 !important;
            padding: 5px 15px;
            color: #fff;
            text-transform: uppercase;
            left: auto;
            right: 0; 
        } 
        .grand-total-section li {
            margin-left:1rem;
            margin-right:1rem;
            width:calc(50% - 2rem);
        }
        .slds-checkbox__label span.slds-form-element__label {
            display: inherit;
        }
        .slds-table td, .slds-table th {
            padding: .25rem .5rem !important;
        }
        .grandTot-table tr th{
            border-top: 1px solid #f79c1a !important;
            border-bottom: 1px solid #f79c1a !important;
        }
        
        #card-errors{
            color:red;
        }
        .StripeElement {
            box-sizing: border-box;
            
            height: 40px;
            
            padding: 10px 12px;
            
            border: 1px solid transparent;
            border-radius: 4px;
            background-color: white;
            
            box-shadow: 0 1px 3px 0 #e6ebf1;
            -webkit-transition: box-shadow 150ms ease;
            transition: box-shadow 150ms ease;
        }
        
        .StripeElement--focus {
            box-shadow: 0 1px 3px 0 #cfd7df;
        }
        
        .StripeElement--invalid {
            border-color: #fa755a;
        }
        
        .StripeElement--webkit-autofill {
            background-color: #fefde5 !important;
        }
        label {
            font-weight: 100 !important;
        }
        /* added by reena on 24/jul/2019 */
        @media(max-width:991px){
            body{
                background-image:none !important;
        		background-color:#fff !important;
            }
            form{
                padding: 0;
            }
            .content-box{
                width:100%;
                max-width:100%;
                margin: auto 0px;
                border-radius: 0px;
            }
        }
    </style>
</apex:page>